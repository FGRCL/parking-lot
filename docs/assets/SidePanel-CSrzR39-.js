(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();const Nh=!1,zh=(t,e)=>t===e,Vh=Symbol("solid-track"),Or={equals:zh};let Wh=Ac;const Xt=1,Rr=2,mc={owned:null,cleanups:null,context:null,owner:null};var Ce=null;let Js=null,qh=null,Se=null,Ue=null,qt=null,Gr=0;function Ar(t,e){const n=Se,r=Ce,i=t.length===0,o=e===void 0?r:e,c=i?mc:{owned:null,cleanups:null,context:o?o.context:null,owner:o},u=i?t:()=>t(()=>Jr(()=>Fn(c)));Ce=c,Se=null;try{return Kn(u,!0)}finally{Se=n,Ce=r}}function bc(t,e){e=e?Object.assign({},Or,e):Or;const n={value:t,observers:null,observerSlots:null,comparator:e.equals||void 0},r=i=>(typeof i=="function"&&(i=i(n.value)),vc(n,i));return[wc.bind(n),r]}function Mr(t,e,n){const r=Sc(t,e,!1,Xt);Kr(r)}function Gh(t,e,n){n=n?Object.assign({},Or,n):Or;const r=Sc(t,e,!0,0);return r.observers=null,r.observerSlots=null,r.comparator=n.equals||void 0,Kr(r),wc.bind(r)}function Jr(t){if(Se===null)return t();const e=Se;Se=null;try{return t()}finally{Se=e}}function Jh(t){return Ce===null||(Ce.cleanups===null?Ce.cleanups=[t]:Ce.cleanups.push(t)),t}function wc(){if(this.sources&&this.state)if(this.state===Xt)Kr(this);else{const t=Ue;Ue=null,Kn(()=>jr(this),!1),Ue=t}if(Se){const t=this.observers?this.observers.length:0;Se.sources?(Se.sources.push(this),Se.sourceSlots.push(t)):(Se.sources=[this],Se.sourceSlots=[t]),this.observers?(this.observers.push(Se),this.observerSlots.push(Se.sources.length-1)):(this.observers=[Se],this.observerSlots=[Se.sources.length-1])}return this.value}function vc(t,e,n){let r=t.value;return(!t.comparator||!t.comparator(r,e))&&(t.value=e,t.observers&&t.observers.length&&Kn(()=>{for(let i=0;i<t.observers.length;i+=1){const o=t.observers[i],c=Js&&Js.running;c&&Js.disposed.has(o),(c?!o.tState:!o.state)&&(o.pure?Ue.push(o):qt.push(o),o.observers&&Ic(o)),c||(o.state=Xt)}if(Ue.length>1e6)throw Ue=[],new Error},!1)),e}function Kr(t){if(!t.fn)return;Fn(t);const e=Gr;Kh(t,t.value,e)}function Kh(t,e,n){let r;const i=Ce,o=Se;Se=Ce=t;try{r=t.fn(e)}catch(c){return t.pure&&(t.state=Xt,t.owned&&t.owned.forEach(Fn),t.owned=null),t.updatedAt=n+1,Ec(c)}finally{Se=o,Ce=i}(!t.updatedAt||t.updatedAt<=n)&&(t.updatedAt!=null&&"observers"in t?vc(t,r):t.value=r,t.updatedAt=n)}function Sc(t,e,n,r=Xt,i){const o={fn:t,state:r,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:e,owner:Ce,context:Ce?Ce.context:null,pure:n};return Ce===null||Ce!==mc&&(Ce.owned?Ce.owned.push(o):Ce.owned=[o]),o}function xc(t){if(t.state===0)return;if(t.state===Rr)return jr(t);if(t.suspense&&Jr(t.suspense.inFallback))return t.suspense.effects.push(t);const e=[t];for(;(t=t.owner)&&(!t.updatedAt||t.updatedAt<Gr);)t.state&&e.push(t);for(let n=e.length-1;n>=0;n--)if(t=e[n],t.state===Xt)Kr(t);else if(t.state===Rr){const r=Ue;Ue=null,Kn(()=>jr(t,e[0]),!1),Ue=r}}function Kn(t,e){if(Ue)return t();let n=!1;e||(Ue=[]),qt?n=!0:qt=[],Gr++;try{const r=t();return Yh(n),r}catch(r){n||(qt=null),Ue=null,Ec(r)}}function Yh(t){if(Ue&&(Ac(Ue),Ue=null),t)return;const e=qt;qt=null,e.length&&Kn(()=>Wh(e),!1)}function Ac(t){for(let e=0;e<t.length;e++)xc(t[e])}function jr(t,e){t.state=0;for(let n=0;n<t.sources.length;n+=1){const r=t.sources[n];if(r.sources){const i=r.state;i===Xt?r!==e&&(!r.updatedAt||r.updatedAt<Gr)&&xc(r):i===Rr&&jr(r,e)}}}function Ic(t){for(let e=0;e<t.observers.length;e+=1){const n=t.observers[e];n.state||(n.state=Rr,n.pure?Ue.push(n):qt.push(n),n.observers&&Ic(n))}}function Fn(t){let e;if(t.sources)for(;t.sources.length;){const n=t.sources.pop(),r=t.sourceSlots.pop(),i=n.observers;if(i&&i.length){const o=i.pop(),c=n.observerSlots.pop();r<i.length&&(o.sourceSlots[c]=r,i[r]=o,n.observerSlots[r]=c)}}if(t.tOwned){for(e=t.tOwned.length-1;e>=0;e--)Fn(t.tOwned[e]);delete t.tOwned}if(t.owned){for(e=t.owned.length-1;e>=0;e--)Fn(t.owned[e]);t.owned=null}if(t.cleanups){for(e=t.cleanups.length-1;e>=0;e--)t.cleanups[e]();t.cleanups=null}t.state=0}function Xh(t){return t instanceof Error?t:new Error(typeof t=="string"?t:"Unknown error",{cause:t})}function Ec(t,e=Ce){throw Xh(t)}const Zh=Symbol("fallback");function ma(t){for(let e=0;e<t.length;e++)t[e]()}function Qh(t,e,n={}){let r=[],i=[],o=[],c=0,u=e.length>1?[]:null;return Jh(()=>ma(o)),()=>{let f=t()||[],d=f.length,_,h;return f[Vh],Jr(()=>{let p,m,v,I,$,D,k,Y,z;if(d===0)c!==0&&(ma(o),o=[],r=[],i=[],c=0,u&&(u=[])),n.fallback&&(r=[Zh],i[0]=Ar(J=>(o[0]=J,n.fallback())),c=1);else if(c===0){for(i=new Array(d),h=0;h<d;h++)r[h]=f[h],i[h]=Ar(g);c=d}else{for(v=new Array(d),I=new Array(d),u&&($=new Array(d)),D=0,k=Math.min(c,d);D<k&&r[D]===f[D];D++);for(k=c-1,Y=d-1;k>=D&&Y>=D&&r[k]===f[Y];k--,Y--)v[Y]=i[k],I[Y]=o[k],u&&($[Y]=u[k]);for(p=new Map,m=new Array(Y+1),h=Y;h>=D;h--)z=f[h],_=p.get(z),m[h]=_===void 0?-1:_,p.set(z,h);for(_=D;_<=k;_++)z=r[_],h=p.get(z),h!==void 0&&h!==-1?(v[h]=i[_],I[h]=o[_],u&&($[h]=u[_]),h=m[h],p.set(z,h)):o[_]();for(h=D;h<d;h++)h in v?(i[h]=v[h],o[h]=I[h],u&&(u[h]=$[h],u[h](h))):i[h]=Ar(g);i=i.slice(0,c=d),r=f.slice(0)}return i});function g(p){if(o[h]=p,u){const[m,v]=bc(h);return u[h]=v,e(f[h],m)}return e(f[h])}}}function kc(t,e){return Jr(()=>t(e||{}))}function eg(t){const e="fallback"in t&&{fallback:()=>t.fallback};return Gh(Qh(()=>t.each,t.children,e||void 0))}function tg(t,e,n){let r=n.length,i=e.length,o=r,c=0,u=0,f=e[i-1].nextSibling,d=null;for(;c<i||u<o;){if(e[c]===n[u]){c++,u++;continue}for(;e[i-1]===n[o-1];)i--,o--;if(i===c){const _=o<r?u?n[u-1].nextSibling:n[o-u]:f;for(;u<o;)t.insertBefore(n[u++],_)}else if(o===u)for(;c<i;)(!d||!d.has(e[c]))&&e[c].remove(),c++;else if(e[c]===n[o-1]&&n[u]===e[i-1]){const _=e[--i].nextSibling;t.insertBefore(n[u++],e[c++].nextSibling),t.insertBefore(n[--o],_),e[i]=n[o]}else{if(!d){d=new Map;let h=u;for(;h<o;)d.set(n[h],h++)}const _=d.get(e[c]);if(_!=null)if(u<_&&_<o){let h=c,g=1,p;for(;++h<i&&h<o&&!((p=d.get(e[h]))==null||p!==_+g);)g++;if(g>_-u){const m=e[c];for(;u<_;)t.insertBefore(n[u++],m)}else t.replaceChild(n[u++],e[c++])}else c++;else e[c++].remove()}}}const ba="_$DX_DELEGATE";function ng(t,e,n,r={}){let i;return Ar(o=>{i=o,e===document?t():_i(e,t(),e.firstChild?null:void 0,n)},r.owner),()=>{i(),e.textContent=""}}function Cc(t,e,n,r){let i;const o=()=>{const u=document.createElement("template");return u.innerHTML=t,u.content.firstChild},c=()=>(i||(i=o())).cloneNode(!0);return c.cloneNode=c,c}function rg(t,e=window.document){const n=e[ba]||(e[ba]=new Set);for(let r=0,i=t.length;r<i;r++){const o=t[r];n.has(o)||(n.add(o),e.addEventListener(o,ig))}}function sg(t,e){t.className=e}function _i(t,e,n,r){if(n!==void 0&&!r&&(r=[]),typeof e!="function")return Dr(t,e,r,n);Mr(i=>Dr(t,e(),i,n),r)}function ig(t){let e=t.target;const n=`$$${t.type}`,r=t.target,i=t.currentTarget,o=f=>Object.defineProperty(t,"target",{configurable:!0,value:f}),c=()=>{const f=e[n];if(f&&!e.disabled){const d=e[`${n}Data`];if(d!==void 0?f.call(e,d,t):f.call(e,t),t.cancelBubble)return}return e.host&&typeof e.host!="string"&&!e.host._$host&&e.contains(t.target)&&o(e.host),!0},u=()=>{for(;c()&&(e=e._$host||e.parentNode||e.host););};if(Object.defineProperty(t,"currentTarget",{configurable:!0,get(){return e||document}}),t.composedPath){const f=t.composedPath();o(f[0]);for(let d=0;d<f.length-2&&(e=f[d],!!c());d++){if(e._$host){e=e._$host,u();break}if(e.parentNode===i)break}}else u();o(r)}function Dr(t,e,n,r,i){for(;typeof n=="function";)n=n();if(e===n)return n;const o=typeof e,c=r!==void 0;if(t=c&&n[0]&&n[0].parentNode||t,o==="string"||o==="number"){if(o==="number"&&(e=e.toString(),e===n))return n;if(c){let u=n[0];u&&u.nodeType===3?u.data!==e&&(u.data=e):u=document.createTextNode(e),n=gn(t,n,r,u)}else n!==""&&typeof n=="string"?n=t.firstChild.data=e:n=t.textContent=e}else if(e==null||o==="boolean")n=gn(t,n,r);else{if(o==="function")return Mr(()=>{let u=e();for(;typeof u=="function";)u=u();n=Dr(t,u,n,r)}),()=>n;if(Array.isArray(e)){const u=[],f=n&&Array.isArray(n);if(pi(u,e,n,i))return Mr(()=>n=Dr(t,u,n,r,!0)),()=>n;if(u.length===0){if(n=gn(t,n,r),c)return n}else f?n.length===0?wa(t,u,r):tg(t,n,u):(n&&gn(t),wa(t,u));n=u}else if(e.nodeType){if(Array.isArray(n)){if(c)return n=gn(t,n,r,e);gn(t,n,null,e)}else n==null||n===""||!t.firstChild?t.appendChild(e):t.replaceChild(e,t.firstChild);n=e}}return n}function pi(t,e,n,r){let i=!1;for(let o=0,c=e.length;o<c;o++){let u=e[o],f=n&&n[t.length],d;if(!(u==null||u===!0||u===!1))if((d=typeof u)=="object"&&u.nodeType)t.push(u);else if(Array.isArray(u))i=pi(t,u,f)||i;else if(d==="function")if(r){for(;typeof u=="function";)u=u();i=pi(t,Array.isArray(u)?u:[u],Array.isArray(f)?f:[f])||i}else t.push(u),i=!0;else{const _=String(u);f&&f.nodeType===3&&f.data===_?t.push(f):t.push(document.createTextNode(_))}}return i}function wa(t,e,n=null){for(let r=0,i=e.length;r<i;r++)t.insertBefore(e[r],n)}function gn(t,e,n,r){if(n===void 0)return t.textContent="";const i=r||document.createTextNode("");if(e.length){let o=!1;for(let c=e.length-1;c>=0;c--){const u=e[c];if(i!==u){const f=u.parentNode===t;!o&&!c?f?t.replaceChild(i,u):t.insertBefore(i,n):f&&u.remove()}else o=!0}}else t.insertBefore(i,n);return[i]}const Rt=Symbol.for("_am_meta"),xn=Symbol.for("_am_trace"),An=Symbol.for("_am_objectId"),Yr=Symbol.for("_am_isProxy"),Tc=Symbol.for("_am_clearCache"),og=Symbol.for("_am_uint"),ag=Symbol.for("_am_int"),cg=Symbol.for("_am_f64"),Oc=Symbol.for("_am_counter"),yi=Symbol.for("_am_text"),Rc=Symbol.for("_am_rawString");var va;class Gt{constructor(e){if(this[va]=!0,typeof e=="string")this.elems=[...e];else if(Array.isArray(e))this.elems=e;else if(e===void 0)this.elems=[];else throw new TypeError(`Unsupported initial value for Text: ${e}`);Reflect.defineProperty(this,yi,{value:!0})}get length(){return this.elems.length}get(e){return this.elems[e]}[(va=yi,Symbol.iterator)](){const e=this.elems;let n=-1;return{next(){return n+=1,n<e.length?{done:!1,value:e[n]}:{done:!0}}}}toString(){if(!this.str){this.str="";for(const e of this.elems)typeof e=="string"?this.str+=e:this.str+="￼"}return this.str}toSpans(){if(!this.spans){this.spans=[];let e="";for(const n of this.elems)typeof n=="string"?e+=n:(e.length>0&&(this.spans.push(e),e=""),this.spans.push(n));e.length>0&&this.spans.push(e)}return this.spans}toJSON(){return this.toString()}set(e,n){if(this[Rt])throw new RangeError("object cannot be modified outside of a change block");this.elems[e]=n}insertAt(e,...n){if(this[Rt])throw new RangeError("object cannot be modified outside of a change block");n.every(r=>typeof r=="string")?this.elems.splice(e,0,...n.join("")):this.elems.splice(e,0,...n)}deleteAt(e,n=1){if(this[Rt])throw new RangeError("object cannot be modified outside of a change block");this.elems.splice(e,n)}map(e){this.elems.map(e)}lastIndexOf(e,n){this.elems.lastIndexOf(e,n)}concat(e){return new Gt(this.elems.concat(e.elems))}every(e){return this.elems.every(e)}filter(e){return new Gt(this.elems.filter(e))}find(e){return this.elems.find(e)}findIndex(e){return this.elems.findIndex(e)}forEach(e){this.elems.forEach(e)}includes(e){return this.elems.includes(e)}indexOf(e){return this.elems.indexOf(e)}join(e){return this.elems.join(e)}reduce(e){this.elems.reduce(e)}reduceRight(e){this.elems.reduceRight(e)}slice(e,n){return new Gt(this.elems.slice(e,n))}some(e){return this.elems.some(e)}toLocaleString(){this.toString()}}class mi{constructor(e){this.value=e||0,Reflect.defineProperty(this,Oc,{value:!0})}valueOf(){return this.value}toString(){return this.valueOf().toString()}toJSON(){return this.value}increment(e){throw new Error("Counters should not be incremented outside of a change callback")}decrement(e){throw new Error("Counters should not be decremented outside of a change callback")}}class ug extends mi{constructor(e,n,r,i,o){super(e),this.context=n,this.path=r,this.objectId=i,this.key=o}increment(e){return e=typeof e=="number"?e:1,this.context.increment(this.objectId,this.key,e),this.value+=e,this.value}decrement(e){return this.increment(typeof e=="number"?-e:-1)}}function fg(t,e,n,r,i){return new ug(t,e,n,r,i)}var Mc;class jc{constructor(e){this[Mc]=!0,this.val=e}toString(){return this.val}toJSON(){return this.val}}Mc=Rc;function lt(t){if(typeof t=="string"&&/^[0-9]+$/.test(t)&&(t=parseInt(t,10)),typeof t!="number")return t;if(t<0||isNaN(t)||t===1/0||t===-1/0)throw new RangeError("A list index must be positive, but you passed "+t);return t}function We(t,e){const{context:n,objectId:r,path:i,textV2:o}=t,c=n.getWithType(r,e);if(c===null)return;const u=c[0],f=c[1];switch(u){case void 0:return;case"map":return Yn(n,f,o,[...i,e]);case"list":return Zr(n,f,o,[...i,e]);case"text":return o?n.text(f):Nn(n,f,[...i,e]);case"str":return o?new jc(f):f;case"uint":return f;case"int":return f;case"f64":return f;case"boolean":return f;case"null":return null;case"bytes":return f;case"timestamp":return f;case"counter":return fg(f,n,i,r,e);default:throw RangeError(`datatype ${u} unimplemented`)}}function Ur(t,e,n,r){const i=typeof t;switch(i){case"object":if(t==null)return[null,"null"];if(t[og])return[t.value,"uint"];if(t[ag])return[t.value,"int"];if(t[cg])return[t.value,"f64"];if(t[Oc])return[t.value,"counter"];if(t instanceof Date)return[t.getTime(),"timestamp"];if(Uc(t))return[t.toString(),"str"];if(Pc(t))return[t,"text"];if(t instanceof Uint8Array)return[t,"bytes"];if(t instanceof Array)return[t,"list"];if(Object.prototype.toString.call(t)==="[object Object]")return[t,"map"];throw Xr(t,r)?new RangeError("Cannot create a reference to an existing document object"):new RangeError(`Cannot assign unknown object: ${t}`);case"boolean":return[t,"boolean"];case"number":return Number.isInteger(t)?[t,"int"]:[t,"f64"];case"string":return e?[t,"text"]:[t,"str"];case"undefined":throw new RangeError([`Cannot assign undefined value at ${Sa(n)}, `,"because `undefined` is not a valid JSON data type. ","You might consider setting the property's value to `null`, ","or using `delete` to remove it altogether."].join(""));default:throw new RangeError([`Cannot assign ${i} value at ${Sa(n)}. `,"All JSON primitive datatypes (object, array, string, number, boolean, null) ",`are supported in an Automerge document; ${i} values are not. `].join(""))}}function Xr(t,e){var n,r;return t instanceof Date?!1:!!(t&&((r=(n=t[Rt])===null||n===void 0?void 0:n.handle)===null||r===void 0?void 0:r.__wbg_ptr)===e.__wbg_ptr)}const lg={get(t,e){const{context:n,objectId:r,cache:i}=t;return e===Symbol.toStringTag?t[Symbol.toStringTag]:e===An?r:e===Yr?!0:e===xn?t.trace:e===Rt?{handle:n,textV2:t.textV2}:(i[e]||(i[e]=We(t,e)),i[e])},set(t,e,n){const{context:r,objectId:i,path:o,textV2:c}=t;if(t.cache={},Xr(n,r))throw new RangeError("Cannot create a reference to an existing document object");if(e===xn)return t.trace=n,!0;if(e===Tc)return!0;const[u,f]=Ur(n,c,[...o,e],r);switch(f){case"list":{const d=r.putObject(i,e,[]),_=Zr(r,d,c,[...o,e]);for(let h=0;h<u.length;h++)_[h]=u[h];break}case"text":{if(c)Pr(u),r.putObject(i,e,u);else{Hi(u);const d=r.putObject(i,e,"");Nn(r,d,[...o,e]).splice(0,0,...u)}break}case"map":{const d=r.putObject(i,e,{}),_=Yn(r,d,c,[...o,e]);for(const h in u)_[h]=u[h];break}default:r.put(i,e,u,f)}return!0},deleteProperty(t,e){const{context:n,objectId:r}=t;return t.cache={},n.delete(r,e),!0},has(t,e){return this.get(t,e)!==void 0},getOwnPropertyDescriptor(t,e){const n=this.get(t,e);if(typeof n<"u")return{configurable:!0,enumerable:!0,value:n}},ownKeys(t){const{context:e,objectId:n}=t,r=e.keys(n);return[...new Set(r)]}},Dc={get(t,e){const{context:n,objectId:r}=t;return e=lt(e),e===Symbol.hasInstance?i=>Array.isArray(i):e===Symbol.toStringTag?t[Symbol.toStringTag]:e===An?r:e===Yr?!0:e===xn?t.trace:e===Rt?{handle:n}:e==="length"?n.length(r):typeof e=="number"?We(t,e):Pi(t)[e]},set(t,e,n){const{context:r,objectId:i,path:o,textV2:c}=t;if(e=lt(e),Xr(n,r))throw new RangeError("Cannot create a reference to an existing document object");if(e===Tc)return!0;if(e===xn)return t.trace=n,!0;if(typeof e=="string")throw new RangeError("list index must be a number");const[u,f]=Ur(n,c,[...o,e],r);switch(f){case"list":{let d;e>=r.length(i)?d=r.insertObject(i,e,[]):d=r.putObject(i,e,[]),Zr(r,d,c,[...o,e]).splice(0,0,...u);break}case"text":{if(c)Pr(u),e>=r.length(i)?r.insertObject(i,e,u):r.putObject(i,e,u);else{let d;Hi(u),e>=r.length(i)?d=r.insertObject(i,e,""):d=r.putObject(i,e,""),Nn(r,d,[...o,e]).splice(0,0,...u)}break}case"map":{let d;e>=r.length(i)?d=r.insertObject(i,e,{}):d=r.putObject(i,e,{});const _=Yn(r,d,c,[...o,e]);for(const h in u)_[h]=u[h];break}default:e>=r.length(i)?r.insert(i,e,u,f):r.put(i,e,u,f)}return!0},deleteProperty(t,e){const{context:n,objectId:r}=t;e=lt(e);const i=n.get(r,e);if(i!=null&&i[0]=="counter")throw new TypeError("Unsupported operation: deleting a counter from a list");return n.delete(r,e),!0},has(t,e){const{context:n,objectId:r}=t;return e=lt(e),typeof e=="number"?e<n.length(r):e==="length"},getOwnPropertyDescriptor(t,e){const{context:n,objectId:r}=t;return e==="length"?{writable:!0,value:n.length(r)}:e===An?{configurable:!1,enumerable:!1,value:r}:(e=lt(e),{configurable:!0,enumerable:!0,value:We(t,e)})},getPrototypeOf(t){return Object.getPrototypeOf(t)},ownKeys(){const t=[];return t.push("length"),t}},dg=Object.assign({},Dc,{get(t,e){const{context:n,objectId:r}=t;return e=lt(e),e===Symbol.hasInstance?i=>Array.isArray(i):e===Symbol.toStringTag?t[Symbol.toStringTag]:e===An?r:e===Yr?!0:e===xn?t.trace:e===Rt?{handle:n}:e==="length"?n.length(r):typeof e=="number"?We(t,e):gg(t)[e]||Pi(t)[e]},getPrototypeOf(){return Object.getPrototypeOf(new Gt)}});function Yn(t,e,n,r){const i={context:t,objectId:e,path:r||[],cache:{},textV2:n},o={};return Object.assign(o,i),new Proxy(o,lg)}function Zr(t,e,n,r){const i={context:t,objectId:e,path:r||[],cache:{},textV2:n},o=[];return Object.assign(o,i),new Proxy(o,Dc)}function Nn(t,e,n){const r={context:t,objectId:e,path:n||[],cache:{},textV2:!1},i={};return Object.assign(i,r),new Proxy(i,dg)}function hg(t,e){return Yn(t,"_root",e,[])}function Pi(t){const{context:e,objectId:n,path:r,textV2:i}=t;return{at(c){return We(t,c)},deleteAt(c,u){return typeof u=="number"?e.splice(n,c,u):e.delete(n,c),this},fill(c,u,f){const[d,_]=Ur(c,i,[...r,u],e),h=e.length(n);u=lt(u||0),f=lt(f||h);for(let g=u;g<Math.min(f,h);g++)if(_==="list"||_==="map")e.putObject(n,g,d);else if(_==="text")if(i)Pr(d),e.putObject(n,g,d);else{Hi(d);const p=e.putObject(n,g,""),m=Nn(e,p,[...r,g]);for(let v=0;v<d.length;v++)m[v]=d.get(v)}else e.put(n,g,d,_);return this},indexOf(c,u=0){const f=e.length(n);for(let d=u;d<f;d++){const _=e.getWithType(n,d);if(_&&(_[1]===c[An]||_[1]===c))return d}return-1},insertAt(c,...u){return this.splice(c,0,...u),this},pop(){const c=e.length(n);if(c==0)return;const u=We(t,c-1);return e.delete(n,c-1),u},push(...c){const u=e.length(n);return this.splice(u,0,...c),e.length(n)},shift(){if(e.length(n)==0)return;const c=We(t,0);return e.delete(n,0),c},splice(c,u,...f){c=lt(c),typeof u!="number"&&(u=e.length(n)-c),u=lt(u);for(const h of f)if(Xr(h,e))throw new RangeError("Cannot create a reference to an existing document object");const d=[];for(let h=0;h<u;h++){const g=We(t,c);g!==void 0&&d.push(g),e.delete(n,c)}const _=f.map((h,g)=>{try{return Ur(h,i,[...r],e)}catch(p){throw p instanceof RangeError?new RangeError(`${p.message} (at index ${g} in the input)`):p}});for(const[h,g]of _){switch(g){case"list":{const p=e.insertObject(n,c,[]);Zr(e,p,i,[...r,c]).splice(0,0,...h);break}case"text":{if(i)Pr(h),e.insertObject(n,c,h);else{const p=e.insertObject(n,c,"");Nn(e,p,[...r,c]).splice(0,0,...h)}break}case"map":{const p=e.insertObject(n,c,{}),m=Yn(e,p,i,[...r,c]);for(const v in h)m[v]=h[v];break}default:e.insert(n,c,h,g)}c+=1}return d},unshift(...c){return this.splice(0,0,...c),e.length(n)},entries(){let c=0;return{next:()=>{const f=We(t,c);return f===void 0?{value:void 0,done:!0}:{value:[c++,f],done:!1}},[Symbol.iterator](){return this}}},keys(){let c=0;const u=e.length(n);return{next:()=>c<u?{value:c++,done:!1}:{value:void 0,done:!0},[Symbol.iterator](){return this}}},values(){let c=0;return{next:()=>{const f=We(t,c++);return f===void 0?{value:void 0,done:!0}:{value:f,done:!1}},[Symbol.iterator](){return this}}},toArray(){const c=[];let u;do u=We(t,c.length),u!==void 0&&c.push(u);while(u!==void 0);return c},map(c){return this.toArray().map(c)},toString(){return this.toArray().toString()},toLocaleString(){return this.toArray().toLocaleString()},forEach(c){return this.toArray().forEach(c)},concat(c){return this.toArray().concat(c)},every(c){return this.toArray().every(c)},filter(c){return this.toArray().filter(c)},find(c){let u=0;for(const f of this){if(c(f,u))return f;u+=1}},findIndex(c){let u=0;for(const f of this){if(c(f,u))return u;u+=1}return-1},includes(c){return this.find(u=>u===c)!==void 0},join(c){return this.toArray().join(c)},reduce(c,u){return this.toArray().reduce(c,u)},reduceRight(c,u){return this.toArray().reduceRight(c,u)},lastIndexOf(c,u=1/0){return this.toArray().lastIndexOf(c,u)},slice(c,u){return this.toArray().slice(c,u)},some(c){let u=0;for(const f of this){if(c(f,u))return!0;u+=1}return!1},[Symbol.iterator]:function*(){let c=0,u=We(t,c);for(;u!==void 0;)yield u,c+=1,u=We(t,c)}}}function gg(t){const{context:e,objectId:n}=t;return{set(i,o){return this[i]=o},get(i){return this[i]},toString(){return e.text(n).replace(/￼/g,"")},toSpans(){const i=[];let o="";const c=e.length(n);for(let u=0;u<c;u++){const f=this[u];typeof f=="string"?o+=f:(o.length>0&&(i.push(o),o=""),i.push(f))}return o.length>0&&i.push(o),i},toJSON(){return this.toString()},indexOf(i,o=0){return e.text(n).indexOf(i,o)},insertAt(i,...o){o.every(c=>typeof c=="string")?e.splice(n,i,0,o.join("")):Pi(t).insertAt(i,...o)}}}function Hi(t){if(!Pc(t))throw new Error("value was not a Text instance")}function Pr(t){if(typeof t!="string")throw new Error("value was not a string")}function Sa(t){const e=t.map(n=>{if(typeof n=="number")return n.toString();if(typeof n=="string")return n.replace(/~/g,"~0").replace(/\//g,"~1")});return t.length===0?"":"/"+e.join("/")}function Uc(t){return typeof t=="object"&&t!==null&&Object.prototype.hasOwnProperty.call(t,Rc)}function Pc(t){return typeof t=="object"&&t!==null&&Object.prototype.hasOwnProperty.call(t,yi)}let Hc;const $c=new Array(128).fill(void 0);$c.push(void 0,null,!0,!1);const Ks=typeof TextEncoder<"u"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}};Ks.encodeInto;$c.length;const _g=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&_g.decode();typeof FinalizationRegistry>"u"||new FinalizationRegistry(t=>Hc.__wbg_automerge_free(t>>>0,1));typeof FinalizationRegistry>"u"||new FinalizationRegistry(t=>Hc.__wbg_syncstate_free(t>>>0,1));let pg=[];function yg(t){for(const e in t)Fe[e]=t[e];for(const e of pg)e()}const Fe={create(t){throw new RangeError("Automerge.use() not called")},load(t,e){throw new RangeError("Automerge.use() not called (load)")},encodeChange(t){throw new RangeError("Automerge.use() not called (encodeChange)")},decodeChange(t){throw new RangeError("Automerge.use() not called (decodeChange)")},initSyncState(){throw new RangeError("Automerge.use() not called (initSyncState)")},encodeSyncMessage(t){throw new RangeError("Automerge.use() not called (encodeSyncMessage)")},decodeSyncMessage(t){throw new RangeError("Automerge.use() not called (decodeSyncMessage)")},encodeSyncState(t){throw new RangeError("Automerge.use() not called (encodeSyncState)")},decodeSyncState(t){throw new RangeError("Automerge.use() not called (decodeSyncState)")},exportSyncState(t){throw new RangeError("Automerge.use() not called (exportSyncState)")},importSyncState(t){throw new RangeError("Automerge.use() not called (importSyncState)")}};function Oe(t,e=!0){if(typeof t!="object")throw new RangeError("must be the document root");const n=Reflect.get(t,Rt);if(n===void 0||n==null||e&&mg(t)!=="_root")throw new RangeError("must be the document root");return n}function Bc(t){return Reflect.get(t,xn)}function mg(t){return typeof t!="object"||t===null?null:Reflect.get(t,An)}function Qr(t){return!!Reflect.get(t,Yr)}var bg=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function $i(t){return typeof t=="object"?t:{actor:t}}function Bi(t){const e=$i(t),n=!!e.freeze,r=e.patchCallback,i=!e.enableTextV2,o=e.actor,c=Fe.create({actor:o,text_v1:i});c.enableFreeze(!!e.freeze);const u=e.enableTextV2||!1;return Vc(c,u),c.materialize("/",void 0,{handle:c,heads:void 0,freeze:n,patchCallback:r,textV2:u})}function wg(t,e){const n=Oe(t),r=n.handle;return n.handle.materialize("/",e,Object.assign(Object.assign({},n),{handle:r,heads:e}))}function vg(t,e){const n=Oe(t),r=n.heads,i=$i(e),o=n.handle.fork(i.actor,r);o.updateDiffCursor();const{heads:c}=n,u=bg(n,["heads"]);return u.patchCallback=i.patchCallback,o.applyPatches(t,Object.assign(Object.assign({},u),{handle:o}))}function Sg(t,e){return zn(Bi(e),"from",{},n=>Object.assign(n,t)).newDoc}function xg(t,e,n){if(typeof e=="function")return zn(t,"change",{},e).newDoc;if(typeof n=="function")return typeof e=="string"&&(e={message:e}),zn(t,"change",e,n).newDoc;throw RangeError("Invalid args for change")}function Ag(t,e,n,r){if(typeof n=="function")return zn(t,"changeAt",{},n,e);if(typeof r=="function")return typeof n=="string"&&(n={message:n}),zn(t,"changeAt",n,r,e);throw RangeError("Invalid args for changeAt")}function Xn(t,e,n,r){if(n==null)return t;const i=Oe(t),o=Object.assign(Object.assign({},i),{heads:void 0}),{value:c,patches:u}=i.handle.applyAndReturnPatches(t,o);if(u.length>0){r?.(u,{before:t,after:c,source:e});const f=Oe(c);f.mostRecentPatch={before:Oe(t).heads,after:f.handle.getHeads(),patches:u}}return i.heads=n,c}function zn(t,e,n,r,i){if(typeof r!="function")throw new RangeError("invalid change function");const o=Oe(t);if(t===void 0||o===void 0)throw new RangeError("must be the document root");if(o.heads)throw new RangeError("Attempting to change an outdated document.  Use Automerge.clone() if you wish to make a writable copy.");if(Qr(t))throw new RangeError("Calls to Automerge.change cannot be nested");let c=o.handle.getHeads();i&&kg(i,c)&&(i=void 0),i&&(o.handle.isolate(i),c=i),"time"in n||(n.time=Math.floor(Date.now()/1e3));try{o.heads=c;const u=hg(o.handle,o.textV2);if(r(u),o.handle.pendingOps()===0)return o.heads=void 0,i&&o.handle.integrate(),{newDoc:t,newHeads:null};{const f=o.handle.commit(n.message,n.time);return o.handle.integrate(),{newDoc:Xn(t,e,c,n.patchCallback||o.patchCallback),newHeads:f!=null?[f]:null}}}catch(u){throw o.heads=void 0,o.handle.rollback(),u}}function Ig(t,e){e===void 0&&(e={}),typeof e=="string"&&(e={message:e}),"time"in e||(e.time=Math.floor(Date.now()/1e3));const n=Oe(t);if(n.heads)throw new RangeError("Attempting to change an outdated document.  Use Automerge.clone() if you wish to make a writable copy.");if(Qr(t))throw new RangeError("Calls to Automerge.change cannot be nested");const r=n.handle.getHeads();return n.handle.emptyChange(e.message,e.time),Xn(t,"emptyChange",r)}function Eg(t,e){const n=$i(e),r=n.actor,i=n.patchCallback,o=!n.enableTextV2,c=n.unchecked||!1,u=n.allowMissingChanges||!1,f=n.convertRawStringsToText||!1,d=Fe.load(t,{text_v1:o,actor:r,unchecked:c,allowMissingDeps:u,convertRawStringsToText:f});d.enableFreeze(!!n.freeze);const _=n.enableTextV2||!1;return Vc(d,_),d.materialize("/",void 0,{handle:d,heads:void 0,patchCallback:i,textV2:_})}function Lc(t,e,n){n||(n={});const r=Oe(t);if(r.heads)throw new RangeError("Attempting to change an out of date document - set at: "+Bc(t));if(Qr(t))throw new RangeError("Calls to Automerge.change cannot be nested");const i=r.handle.getHeads();return r.handle.loadIncremental(e),Xn(t,"loadIncremental",i,n.patchCallback||r.patchCallback)}function Fc(t){return Oe(t).handle.save()}function xa(t,e){const n=Oe(t);if(n.heads)throw new RangeError("Attempting to change an out of date document - set at: "+Bc(t));const r=n.handle.getHeads(),i=Oe(e),o=n.handle.getChangesAdded(i.handle);return n.handle.applyChanges(o),Xn(t,"merge",r,n.patchCallback)}function Ys(t,e,n){Aa(e,"before"),Aa(n,"after");const r=Oe(t);return r.mostRecentPatch&&bi(r.mostRecentPatch.before,e)&&bi(r.mostRecentPatch.after,n)?r.mostRecentPatch.patches:r.handle.diff(e,n)}function kg(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function Aa(t,e){if(!Array.isArray(t))throw new Error(`${e} must be an array`)}function bi(t,e){if(!Ia(t)||!Ia(e))return t===e;const n=Object.keys(t).sort(),r=Object.keys(e).sort();if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i]!==r[i]||!bi(t[n[i]],e[r[i]]))return!1;return!0}function Nc(t){const e=Fe.importSyncState(t),n=Fe.encodeSyncState(e);return e.free(),n}function zc(t){const e=Fe.decodeSyncState(t),n=Fe.exportSyncState(e);return e.free(),n}function Cg(t,e){const n=Oe(t),r=Fe.importSyncState(e),i=n.handle.generateSyncMessage(r);return[Fe.exportSyncState(r),i]}function Tg(t,e,n,r){const i=Fe.importSyncState(e);r||(r={});const o=Oe(t);if(o.heads)throw new RangeError("Attempting to change an outdated document.  Use Automerge.clone() if you wish to make a writable copy.");if(Qr(t))throw new RangeError("Calls to Automerge.change cannot be nested");const c=o.handle.getHeads();o.handle.receiveSyncMessage(i,n);const u=Fe.exportSyncState(i);return[Xn(t,"receiveSyncMessage",c,r.patchCallback||o.patchCallback),u,null]}function Og(){return Fe.exportSyncState(Fe.initSyncState())}function Rg(t){return Fe.decodeSyncMessage(t)}function wt(t){const e=Oe(t);return e.heads||e.handle.getHeads()}function Ia(t){return typeof t=="object"&&t!==null}function Mg(t,e){return Oe(t).handle.saveSince(e)}function Vc(t,e){t.registerDatatype("counter",n=>new mi(n),n=>{if(n instanceof mi)return n.value}),e?t.registerDatatype("str",n=>new jc(n),n=>{if(Uc(n))return n.val}):t.registerDatatype("text",n=>new Gt(n),n=>{if(n instanceof Gt)return n.join("")})}function jg(t){return Oe(t).handle.topoHistoryTraversal()}function Dg(t,e){return Oe(t).handle.getDecodedChangeByHash(e)}function Li(t){return Oe(t).handle.stats()}function vt(t){const e=es(t);return e.enableTextV2=!0,Bi(e)}function Hr(t,e){const n=es(e);return n.enableTextV2=!0,vg(t,n)}function Ug(t,e){const n=es(e);return n.enableTextV2=!0,Sg(t,n)}function Pg(t,e){const n=es(e);return n.enableTextV2=!0,n.patchCallback?Lc(Bi(n),t):Eg(t,n)}function es(t){return{actor:t}}function Fi(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var _r={exports:{}},Xs,Ea;function Hg(){if(Ea)return Xs;Ea=1;var t=1e3,e=t*60,n=e*60,r=n*24,i=r*7,o=r*365.25;Xs=function(_,h){h=h||{};var g=typeof _;if(g==="string"&&_.length>0)return c(_);if(g==="number"&&isFinite(_))return h.long?f(_):u(_);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(_))};function c(_){if(_=String(_),!(_.length>100)){var h=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(_);if(h){var g=parseFloat(h[1]),p=(h[2]||"ms").toLowerCase();switch(p){case"years":case"year":case"yrs":case"yr":case"y":return g*o;case"weeks":case"week":case"w":return g*i;case"days":case"day":case"d":return g*r;case"hours":case"hour":case"hrs":case"hr":case"h":return g*n;case"minutes":case"minute":case"mins":case"min":case"m":return g*e;case"seconds":case"second":case"secs":case"sec":case"s":return g*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return g;default:return}}}}function u(_){var h=Math.abs(_);return h>=r?Math.round(_/r)+"d":h>=n?Math.round(_/n)+"h":h>=e?Math.round(_/e)+"m":h>=t?Math.round(_/t)+"s":_+"ms"}function f(_){var h=Math.abs(_);return h>=r?d(_,h,r,"day"):h>=n?d(_,h,n,"hour"):h>=e?d(_,h,e,"minute"):h>=t?d(_,h,t,"second"):_+" ms"}function d(_,h,g,p){var m=h>=g*1.5;return Math.round(_/g)+" "+p+(m?"s":"")}return Xs}var Zs,ka;function $g(){if(ka)return Zs;ka=1;function t(e){r.debug=r,r.default=r,r.coerce=d,r.disable=u,r.enable=o,r.enabled=f,r.humanize=Hg(),r.destroy=_,Object.keys(e).forEach(h=>{r[h]=e[h]}),r.names=[],r.skips=[],r.formatters={};function n(h){let g=0;for(let p=0;p<h.length;p++)g=(g<<5)-g+h.charCodeAt(p),g|=0;return r.colors[Math.abs(g)%r.colors.length]}r.selectColor=n;function r(h){let g,p=null,m,v;function I(...$){if(!I.enabled)return;const D=I,k=Number(new Date),Y=k-(g||k);D.diff=Y,D.prev=g,D.curr=k,g=k,$[0]=r.coerce($[0]),typeof $[0]!="string"&&$.unshift("%O");let z=0;$[0]=$[0].replace(/%([a-zA-Z%])/g,(te,Z)=>{if(te==="%%")return"%";z++;const F=r.formatters[Z];if(typeof F=="function"){const V=$[z];te=F.call(D,V),$.splice(z,1),z--}return te}),r.formatArgs.call(D,$),(D.log||r.log).apply(D,$)}return I.namespace=h,I.useColors=r.useColors(),I.color=r.selectColor(h),I.extend=i,I.destroy=r.destroy,Object.defineProperty(I,"enabled",{enumerable:!0,configurable:!1,get:()=>p!==null?p:(m!==r.namespaces&&(m=r.namespaces,v=r.enabled(h)),v),set:$=>{p=$}}),typeof r.init=="function"&&r.init(I),I}function i(h,g){const p=r(this.namespace+(typeof g>"u"?":":g)+h);return p.log=this.log,p}function o(h){r.save(h),r.namespaces=h,r.names=[],r.skips=[];const g=(typeof h=="string"?h:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(const p of g)p[0]==="-"?r.skips.push(p.slice(1)):r.names.push(p)}function c(h,g){let p=0,m=0,v=-1,I=0;for(;p<h.length;)if(m<g.length&&(g[m]===h[p]||g[m]==="*"))g[m]==="*"?(v=m,I=p,m++):(p++,m++);else if(v!==-1)m=v+1,I++,p=I;else return!1;for(;m<g.length&&g[m]==="*";)m++;return m===g.length}function u(){const h=[...r.names,...r.skips.map(g=>"-"+g)].join(",");return r.enable(""),h}function f(h){for(const g of r.skips)if(c(h,g))return!1;for(const g of r.names)if(c(h,g))return!0;return!1}function d(h){return h instanceof Error?h.stack||h.message:h}function _(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}return Zs=t,Zs}var Ca;function Bg(){return Ca||(Ca=1,function(t,e){var n={};e.formatArgs=i,e.save=o,e.load=c,e.useColors=r,e.storage=u(),e.destroy=(()=>{let d=!1;return()=>{d||(d=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function r(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let d;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(d=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(d[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function i(d){if(d[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+d[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const _="color: "+this.color;d.splice(1,0,_,"color: inherit");let h=0,g=0;d[0].replace(/%[a-zA-Z%]/g,p=>{p!=="%%"&&(h++,p==="%c"&&(g=h))}),d.splice(g,0,_)}e.log=console.debug||console.log||(()=>{});function o(d){try{d?e.storage.setItem("debug",d):e.storage.removeItem("debug")}catch{}}function c(){let d;try{d=e.storage.getItem("debug")||e.storage.getItem("DEBUG")}catch{}return!d&&typeof process<"u"&&"env"in process&&(d=n.DEBUG),d}function u(){try{return localStorage}catch{}}t.exports=$g()(e);const{formatters:f}=t.exports;f.j=function(d){try{return JSON.stringify(d)}catch(_){return"[UnexpectedJSONParseError]: "+_.message}}}(_r,_r.exports)),_r.exports}var Lg=Bg();const gt=Fi(Lg);var Qs={exports:{}},Ta;function Fg(){return Ta||(Ta=1,function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function i(f,d,_){this.fn=f,this.context=d,this.once=_||!1}function o(f,d,_,h,g){if(typeof _!="function")throw new TypeError("The listener must be a function");var p=new i(_,h||f,g),m=n?n+d:d;return f._events[m]?f._events[m].fn?f._events[m]=[f._events[m],p]:f._events[m].push(p):(f._events[m]=p,f._eventsCount++),f}function c(f,d){--f._eventsCount===0?f._events=new r:delete f._events[d]}function u(){this._events=new r,this._eventsCount=0}u.prototype.eventNames=function(){var d=[],_,h;if(this._eventsCount===0)return d;for(h in _=this._events)e.call(_,h)&&d.push(n?h.slice(1):h);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(_)):d},u.prototype.listeners=function(d){var _=n?n+d:d,h=this._events[_];if(!h)return[];if(h.fn)return[h.fn];for(var g=0,p=h.length,m=new Array(p);g<p;g++)m[g]=h[g].fn;return m},u.prototype.listenerCount=function(d){var _=n?n+d:d,h=this._events[_];return h?h.fn?1:h.length:0},u.prototype.emit=function(d,_,h,g,p,m){var v=n?n+d:d;if(!this._events[v])return!1;var I=this._events[v],$=arguments.length,D,k;if(I.fn){switch(I.once&&this.removeListener(d,I.fn,void 0,!0),$){case 1:return I.fn.call(I.context),!0;case 2:return I.fn.call(I.context,_),!0;case 3:return I.fn.call(I.context,_,h),!0;case 4:return I.fn.call(I.context,_,h,g),!0;case 5:return I.fn.call(I.context,_,h,g,p),!0;case 6:return I.fn.call(I.context,_,h,g,p,m),!0}for(k=1,D=new Array($-1);k<$;k++)D[k-1]=arguments[k];I.fn.apply(I.context,D)}else{var Y=I.length,z;for(k=0;k<Y;k++)switch(I[k].once&&this.removeListener(d,I[k].fn,void 0,!0),$){case 1:I[k].fn.call(I[k].context);break;case 2:I[k].fn.call(I[k].context,_);break;case 3:I[k].fn.call(I[k].context,_,h);break;case 4:I[k].fn.call(I[k].context,_,h,g);break;default:if(!D)for(z=1,D=new Array($-1);z<$;z++)D[z-1]=arguments[z];I[k].fn.apply(I[k].context,D)}}return!0},u.prototype.on=function(d,_,h){return o(this,d,_,h,!1)},u.prototype.once=function(d,_,h){return o(this,d,_,h,!0)},u.prototype.removeListener=function(d,_,h,g){var p=n?n+d:d;if(!this._events[p])return this;if(!_)return c(this,p),this;var m=this._events[p];if(m.fn)m.fn===_&&(!g||m.once)&&(!h||m.context===h)&&c(this,p);else{for(var v=0,I=[],$=m.length;v<$;v++)(m[v].fn!==_||g&&!m[v].once||h&&m[v].context!==h)&&I.push(m[v]);I.length?this._events[p]=I.length===1?I[0]:I:c(this,p)}return this},u.prototype.removeAllListeners=function(d){var _;return d?(_=n?n+d:d,this._events[_]&&c(this,_)):(this._events=new r,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=n,u.EventEmitter=u,t.exports=u}(Qs)),Qs.exports}var Ng=Fg();const Zt=Fi(Ng);function zg(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global}function Vg(){const t=zg();if(t.__xstate__)return t.__xstate__}const Wg=t=>{if(typeof window>"u")return;const e=Vg();e&&e.register(t)};class Oa{constructor(e){this._process=e,this._active=!1,this._current=null,this._last=null}start(){this._active=!0,this.flush()}clear(){this._current&&(this._current.next=null,this._last=this._current)}enqueue(e){const n={value:e,next:null};if(this._current){this._last.next=n,this._last=n;return}this._current=n,this._last=n,this._active&&this.flush()}flush(){for(;this._current;){const e=this._current;this._process(e.value),this._current=e.next}this._last=null}}const Wc=".",qg="",qc="",Gg="#",Jg="*",Gc="xstate.init",wi="xstate.stop";function Kg(t,e){return{type:`xstate.after.${t}.${e}`}}function vi(t,e){return{type:`xstate.done.state.${t}`,output:e}}function Yg(t,e){return{type:`xstate.done.actor.${t}`,output:e,actorId:t}}function Xg(t,e){return{type:`xstate.error.actor.${t}`,error:e,actorId:t}}function Jc(t){return{type:Gc,input:t}}function ot(t){setTimeout(()=>{throw t})}const Zg=typeof Symbol=="function"&&Symbol.observable||"@@observable";function Kc(t,e){const n=Ra(t),r=Ra(e);return typeof r=="string"?typeof n=="string"?r===n:!1:typeof n=="string"?n in r:Object.keys(n).every(i=>i in r?Kc(n[i],r[i]):!1)}function Ni(t){if(Xc(t))return t;const e=[];let n="";for(let r=0;r<t.length;r++){switch(t.charCodeAt(r)){case 92:n+=t[r+1],r++;continue;case 46:e.push(n),n="";continue}n+=t[r]}return e.push(n),e}function Ra(t){if(M_(t))return t.value;if(typeof t!="string")return t;const e=Ni(t);return Qg(e)}function Qg(t){if(t.length===1)return t[0];const e={};let n=e;for(let r=0;r<t.length-1;r++)if(r===t.length-2)n[t[r]]=t[r+1];else{const i=n;n={},i[t[r]]=n}return e}function Ma(t,e){const n={},r=Object.keys(t);for(let i=0;i<r.length;i++){const o=r[i];n[o]=e(t[o],o,t,i)}return n}function Yc(t){return Xc(t)?t:[t]}function xt(t){return t===void 0?[]:Yc(t)}function Si(t,e,n,r){return typeof t=="function"?t({context:e,event:n,self:r}):t}function Xc(t){return Array.isArray(t)}function e_(t){return t.type.startsWith("xstate.error.actor")}function bn(t){return Yc(t).map(e=>typeof e>"u"||typeof e=="string"?{target:e}:e)}function Zc(t){if(!(t===void 0||t===qg))return xt(t)}function xi(t,e,n){const r=typeof t=="object",i=r?t:void 0;return{next:(r?t.next:t)?.bind(i),error:(r?t.error:e)?.bind(i),complete:(r?t.complete:n)?.bind(i)}}function ja(t,e){return`${e}.${t}`}function zi(t,e){const n=e.match(/^xstate\.invoke\.(\d+)\.(.*)/);if(!n)return t.implementations.actors[e];const[,r,i]=n,c=t.getStateNodeById(i).config.invoke;return(Array.isArray(c)?c[r]:c).src}function Da(t,e){return`${t.sessionId}.${e}`}let t_=0;function n_(t,e){const n=new Map,r=new Map,i=new WeakMap,o=new Set,c={},{clock:u,logger:f}=e,d={schedule:(g,p,m,v,I=Math.random().toString(36).slice(2))=>{const $={source:g,target:p,event:m,delay:v,id:I,startedAt:Date.now()},D=Da(g,I);h._snapshot._scheduledEvents[D]=$;const k=u.setTimeout(()=>{delete c[D],delete h._snapshot._scheduledEvents[D],h._relay(g,p,m)},v);c[D]=k},cancel:(g,p)=>{const m=Da(g,p),v=c[m];delete c[m],delete h._snapshot._scheduledEvents[m],v!==void 0&&u.clearTimeout(v)},cancelAll:g=>{for(const p in h._snapshot._scheduledEvents){const m=h._snapshot._scheduledEvents[p];m.source===g&&d.cancel(g,m.id)}}},_=g=>{if(!o.size)return;const p={...g,rootId:t.sessionId};o.forEach(m=>m.next?.(p))},h={_snapshot:{_scheduledEvents:(e?.snapshot&&e.snapshot.scheduler)??{}},_bookId:()=>`x:${t_++}`,_register:(g,p)=>(n.set(g,p),g),_unregister:g=>{n.delete(g.sessionId);const p=i.get(g);p!==void 0&&(r.delete(p),i.delete(g))},get:g=>r.get(g),_set:(g,p)=>{const m=r.get(g);if(m&&m!==p)throw new Error(`Actor with system ID '${g}' already exists.`);r.set(g,p),i.set(p,g)},inspect:g=>{const p=xi(g);return o.add(p),{unsubscribe(){o.delete(p)}}},_sendInspectionEvent:_,_relay:(g,p,m)=>{h._sendInspectionEvent({type:"@xstate.event",sourceRef:g,actorRef:p,event:m}),p._send(m)},scheduler:d,getSnapshot:()=>({_scheduledEvents:{...h._snapshot._scheduledEvents}}),start:()=>{const g=h._snapshot._scheduledEvents;h._snapshot._scheduledEvents={};for(const p in g){const{source:m,target:v,event:I,delay:$,id:D}=g[p];d.schedule(m,v,I,$,D)}},_clock:u,_logger:f};return h}let ei=!1;const Vi=1;let Be=function(t){return t[t.NotStarted=0]="NotStarted",t[t.Running=1]="Running",t[t.Stopped=2]="Stopped",t}({});const r_={clock:{setTimeout:(t,e)=>setTimeout(t,e),clearTimeout:t=>clearTimeout(t)},logger:console.log.bind(console),devTools:!1};class s_{constructor(e,n){this.logic=e,this._snapshot=void 0,this.clock=void 0,this.options=void 0,this.id=void 0,this.mailbox=new Oa(this._process.bind(this)),this.observers=new Set,this.eventListeners=new Map,this.logger=void 0,this._processingStatus=Be.NotStarted,this._parent=void 0,this._syncSnapshot=void 0,this.ref=void 0,this._actorScope=void 0,this._systemId=void 0,this.sessionId=void 0,this.system=void 0,this._doneEvent=void 0,this.src=void 0,this._deferred=[];const r={...r_,...n},{clock:i,logger:o,parent:c,syncSnapshot:u,id:f,systemId:d,inspect:_}=r;this.system=c?c.system:n_(this,{clock:i,logger:o}),_&&!c&&this.system.inspect(xi(_)),this.sessionId=this.system._bookId(),this.id=f??this.sessionId,this.logger=n?.logger??this.system._logger,this.clock=n?.clock??this.system._clock,this._parent=c,this._syncSnapshot=u,this.options=r,this.src=r.src??e,this.ref=this,this._actorScope={self:this,id:this.id,sessionId:this.sessionId,logger:this.logger,defer:h=>{this._deferred.push(h)},system:this.system,stopChild:h=>{if(h._parent!==this)throw new Error(`Cannot stop child actor ${h.id} of ${this.id} because it is not a child`);h._stop()},emit:h=>{const g=this.eventListeners.get(h.type),p=this.eventListeners.get("*");if(!g&&!p)return;const m=[...g?g.values():[],...p?p.values():[]];for(const v of m)try{v(h)}catch(I){ot(I)}},actionExecutor:h=>{const g=()=>{if(this._actorScope.system._sendInspectionEvent({type:"@xstate.action",actorRef:this,action:{type:h.type,params:h.params}}),!h.exec)return;const p=ei;try{ei=!0,h.exec(h.info,h.params)}finally{ei=p}};this._processingStatus===Be.Running?g():this._deferred.push(g)}},this.send=this.send.bind(this),this.system._sendInspectionEvent({type:"@xstate.actor",actorRef:this}),d&&(this._systemId=d,this.system._set(d,this)),this._initState(n?.snapshot??n?.state),d&&this._snapshot.status!=="active"&&this.system._unregister(this)}_initState(e){try{this._snapshot=e?this.logic.restoreSnapshot?this.logic.restoreSnapshot(e,this._actorScope):e:this.logic.getInitialSnapshot(this._actorScope,this.options?.input)}catch(n){this._snapshot={status:"error",output:void 0,error:n}}}update(e,n){this._snapshot=e;let r;for(;r=this._deferred.shift();)try{r()}catch(i){this._deferred.length=0,this._snapshot={...e,status:"error",error:i}}switch(this._snapshot.status){case"active":for(const i of this.observers)try{i.next?.(e)}catch(o){ot(o)}break;case"done":for(const i of this.observers)try{i.next?.(e)}catch(o){ot(o)}this._stopProcedure(),this._complete(),this._doneEvent=Yg(this.id,this._snapshot.output),this._parent&&this.system._relay(this,this._parent,this._doneEvent);break;case"error":this._error(this._snapshot.error);break}this.system._sendInspectionEvent({type:"@xstate.snapshot",actorRef:this,event:n,snapshot:e})}subscribe(e,n,r){const i=xi(e,n,r);if(this._processingStatus!==Be.Stopped)this.observers.add(i);else switch(this._snapshot.status){case"done":try{i.complete?.()}catch(o){ot(o)}break;case"error":{const o=this._snapshot.error;if(!i.error)ot(o);else try{i.error(o)}catch(c){ot(c)}break}}return{unsubscribe:()=>{this.observers.delete(i)}}}on(e,n){let r=this.eventListeners.get(e);r||(r=new Set,this.eventListeners.set(e,r));const i=n.bind(void 0);return r.add(i),{unsubscribe:()=>{r.delete(i)}}}start(){if(this._processingStatus===Be.Running)return this;this._syncSnapshot&&this.subscribe({next:r=>{r.status==="active"&&this.system._relay(this,this._parent,{type:`xstate.snapshot.${this.id}`,snapshot:r})},error:()=>{}}),this.system._register(this.sessionId,this),this._systemId&&this.system._set(this._systemId,this),this._processingStatus=Be.Running;const e=Jc(this.options.input);switch(this.system._sendInspectionEvent({type:"@xstate.event",sourceRef:this._parent,actorRef:this,event:e}),this._snapshot.status){case"done":return this.update(this._snapshot,e),this;case"error":return this._error(this._snapshot.error),this}if(this._parent||this.system.start(),this.logic.start)try{this.logic.start(this._snapshot,this._actorScope)}catch(r){return this._snapshot={...this._snapshot,status:"error",error:r},this._error(r),this}return this.update(this._snapshot,e),this.options.devTools&&this.attachDevTools(),this.mailbox.start(),this}_process(e){let n,r;try{n=this.logic.transition(this._snapshot,e,this._actorScope)}catch(i){r={err:i}}if(r){const{err:i}=r;this._snapshot={...this._snapshot,status:"error",error:i},this._error(i);return}this.update(n,e),e.type===wi&&(this._stopProcedure(),this._complete())}_stop(){return this._processingStatus===Be.Stopped?this:(this.mailbox.clear(),this._processingStatus===Be.NotStarted?(this._processingStatus=Be.Stopped,this):(this.mailbox.enqueue({type:wi}),this))}stop(){if(this._parent)throw new Error("A non-root actor cannot be stopped directly.");return this._stop()}_complete(){for(const e of this.observers)try{e.complete?.()}catch(n){ot(n)}this.observers.clear()}_reportError(e){if(!this.observers.size){this._parent||ot(e);return}let n=!1;for(const r of this.observers){const i=r.error;n||=!i;try{i?.(e)}catch(o){ot(o)}}this.observers.clear(),n&&ot(e)}_error(e){this._stopProcedure(),this._reportError(e),this._parent&&this.system._relay(this,this._parent,Xg(this.id,e))}_stopProcedure(){return this._processingStatus!==Be.Running?this:(this.system.scheduler.cancelAll(this),this.mailbox.clear(),this.mailbox=new Oa(this._process.bind(this)),this._processingStatus=Be.Stopped,this.system._unregister(this),this)}_send(e){this._processingStatus!==Be.Stopped&&this.mailbox.enqueue(e)}send(e){this.system._relay(void 0,this,e)}attachDevTools(){const{devTools:e}=this.options;e&&(typeof e=="function"?e:Wg)(this)}toJSON(){return{xstate$$type:Vi,id:this.id}}getPersistedSnapshot(e){return this.logic.getPersistedSnapshot(this._snapshot,e)}[Zg](){return this}getSnapshot(){return this._snapshot}}function Vn(t,...[e]){return new s_(t,e)}function i_(t,e,n,r,{sendId:i}){const o=typeof i=="function"?i(n,r):i;return[e,{sendId:o},void 0]}function o_(t,e){t.defer(()=>{t.system.scheduler.cancel(t.self,e.sendId)})}function a_(t){function e(n,r){}return e.type="xstate.cancel",e.sendId=t,e.resolve=i_,e.execute=o_,e}function c_(t,e,n,r,{id:i,systemId:o,src:c,input:u,syncSnapshot:f}){const d=typeof c=="string"?zi(e.machine,c):c,_=typeof i=="function"?i(n):i;let h,g;return d&&(g=typeof u=="function"?u({context:e.context,event:n.event,self:t.self}):u,h=Vn(d,{id:_,src:c,parent:t.self,syncSnapshot:f,systemId:o,input:g})),[Kt(e,{children:{...e.children,[_]:h}}),{id:i,systemId:o,actorRef:h,src:c,input:g},void 0]}function u_(t,{actorRef:e}){e&&t.defer(()=>{e._processingStatus!==Be.Stopped&&e.start()})}function f_(...[t,{id:e,systemId:n,input:r,syncSnapshot:i=!1}={}]){function o(c,u){}return o.type="xstate.spawnChild",o.id=e,o.systemId=n,o.src=t,o.input=r,o.syncSnapshot=i,o.resolve=c_,o.execute=u_,o}function l_(t,e,n,r,{actorRef:i}){const o=typeof i=="function"?i(n,r):i,c=typeof o=="string"?e.children[o]:o;let u=e.children;return c&&(u={...u},delete u[c.id]),[Kt(e,{children:u}),c,void 0]}function d_(t,e){if(e){if(t.system._unregister(e),e._processingStatus!==Be.Running){t.stopChild(e);return}t.defer(()=>{t.stopChild(e)})}}function Qc(t){function e(n,r){}return e.type="xstate.stopChild",e.actorRef=t,e.resolve=l_,e.execute=d_,e}function Wi(t,e,n,r){const{machine:i}=r,o=typeof t=="function",c=o?t:i.implementations.guards[typeof t=="string"?t:t.type];if(!o&&!c)throw new Error(`Guard '${typeof t=="string"?t:t.type}' is not implemented.'.`);if(typeof c!="function")return Wi(c,e,n,r);const u={context:e,event:n},f=o||typeof t=="string"?void 0:"params"in t?typeof t.params=="function"?t.params({context:e,event:n}):t.params:void 0;return"check"in c?c.check(r,u,c):c(u,f)}const qi=t=>t.type==="atomic"||t.type==="final";function In(t){return Object.values(t.states).filter(e=>e.type!=="history")}function Zn(t,e){const n=[];if(e===t)return n;let r=t.parent;for(;r&&r!==e;)n.push(r),r=r.parent;return n}function $r(t){const e=new Set(t),n=tu(e);for(const r of e)if(r.type==="compound"&&(!n.get(r)||!n.get(r).length))Ua(r).forEach(i=>e.add(i));else if(r.type==="parallel"){for(const i of In(r))if(i.type!=="history"&&!e.has(i)){const o=Ua(i);for(const c of o)e.add(c)}}for(const r of e){let i=r.parent;for(;i;)e.add(i),i=i.parent}return e}function eu(t,e){const n=e.get(t);if(!n)return{};if(t.type==="compound"){const i=n[0];if(i){if(qi(i))return i.key}else return{}}const r={};for(const i of n)r[i.key]=eu(i,e);return r}function tu(t){const e=new Map;for(const n of t)e.has(n)||e.set(n,[]),n.parent&&(e.has(n.parent)||e.set(n.parent,[]),e.get(n.parent).push(n));return e}function nu(t,e){const n=$r(e);return eu(t,tu(n))}function Gi(t,e){return e.type==="compound"?In(e).some(n=>n.type==="final"&&t.has(n)):e.type==="parallel"?In(e).every(n=>Gi(t,n)):e.type==="final"}const ts=t=>t[0]===Gg;function h_(t,e){return t.transitions.get(e)||[...t.transitions.keys()].filter(r=>{if(r===Jg)return!0;if(!r.endsWith(".*"))return!1;const i=r.split("."),o=e.split(".");for(let c=0;c<i.length;c++){const u=i[c],f=o[c];if(u==="*")return c===i.length-1;if(u!==f)return!1}return!0}).sort((r,i)=>i.length-r.length).flatMap(r=>t.transitions.get(r))}function g_(t){const e=t.config.after;if(!e)return[];const n=i=>{const o=Kg(i,t.id),c=o.type;return t.entry.push(N_(o,{id:c,delay:i})),t.exit.push(a_(c)),c};return Object.keys(e).flatMap(i=>{const o=e[i],c=typeof o=="string"?{target:o}:o,u=Number.isNaN(+i)?i:+i,f=n(u);return xt(c).map(d=>({...d,event:f,delay:u}))}).map(i=>{const{delay:o}=i;return{...zt(t,i.event,i),delay:o}})}function zt(t,e,n){const r=Zc(n.target),i=n.reenter??!1,o=y_(t,r),c={...n,actions:xt(n.actions),guard:n.guard,target:o,source:t,reenter:i,eventType:e,toJSON:()=>({...c,source:`#${t.id}`,target:o?o.map(u=>`#${u.id}`):void 0})};return c}function __(t){const e=new Map;if(t.config.on)for(const n of Object.keys(t.config.on)){if(n===qc)throw new Error('Null events ("") cannot be specified as a transition key. Use `always: { ... }` instead.');const r=t.config.on[n];e.set(n,bn(r).map(i=>zt(t,n,i)))}if(t.config.onDone){const n=`xstate.done.state.${t.id}`;e.set(n,bn(t.config.onDone).map(r=>zt(t,n,r)))}for(const n of t.invoke){if(n.onDone){const r=`xstate.done.actor.${n.id}`;e.set(r,bn(n.onDone).map(i=>zt(t,r,i)))}if(n.onError){const r=`xstate.error.actor.${n.id}`;e.set(r,bn(n.onError).map(i=>zt(t,r,i)))}if(n.onSnapshot){const r=`xstate.snapshot.${n.id}`;e.set(r,bn(n.onSnapshot).map(i=>zt(t,r,i)))}}for(const n of t.after){let r=e.get(n.eventType);r||(r=[],e.set(n.eventType,r)),r.push(n)}return e}function p_(t,e){const n=typeof e=="string"?t.states[e]:e?t.states[e.target]:void 0;if(!n&&e)throw new Error(`Initial state node "${e}" not found on parent state node #${t.id}`);const r={source:t,actions:!e||typeof e=="string"?[]:xt(e.actions),eventType:null,reenter:!1,target:n?[n]:[],toJSON:()=>({...r,source:`#${t.id}`,target:n?[`#${n.id}`]:[]})};return r}function y_(t,e){if(e!==void 0)return e.map(n=>{if(typeof n!="string")return n;if(ts(n))return t.machine.getStateNodeById(n);const r=n[0]===Wc;if(r&&!t.parent)return Br(t,n.slice(1));const i=r?t.key+n:n;if(t.parent)try{return Br(t.parent,i)}catch(o){throw new Error(`Invalid transition definition for state node '${t.id}':
${o.message}`)}else throw new Error(`Invalid target: "${n}" is not a valid target from the root node. Did you mean ".${n}"?`)})}function ru(t){const e=Zc(t.config.target);return e?{target:e.map(n=>typeof n=="string"?Br(t.parent,n):n)}:t.parent.initial}function Wt(t){return t.type==="history"}function Ua(t){const e=su(t);for(const n of e)for(const r of Zn(n,t))e.add(r);return e}function su(t){const e=new Set;function n(r){if(!e.has(r)){if(e.add(r),r.type==="compound")n(r.initial.target[0]);else if(r.type==="parallel")for(const i of In(r))n(i)}}return n(t),e}function En(t,e){if(ts(e))return t.machine.getStateNodeById(e);if(!t.states)throw new Error(`Unable to retrieve child state '${e}' from '${t.id}'; no child states exist.`);const n=t.states[e];if(!n)throw new Error(`Child state '${e}' does not exist on '${t.id}'`);return n}function Br(t,e){if(typeof e=="string"&&ts(e))try{return t.machine.getStateNodeById(e)}catch{}const n=Ni(e).slice();let r=t;for(;n.length;){const i=n.shift();if(!i.length)break;r=En(r,i)}return r}function Lr(t,e){if(typeof e=="string"){const i=t.states[e];if(!i)throw new Error(`State '${e}' does not exist on '${t.id}'`);return[t,i]}const n=Object.keys(e),r=n.map(i=>En(t,i)).filter(Boolean);return[t.machine.root,t].concat(r,n.reduce((i,o)=>{const c=En(t,o);if(!c)return i;const u=Lr(c,e[o]);return i.concat(u)},[]))}function m_(t,e,n,r){const o=En(t,e).next(n,r);return!o||!o.length?t.next(n,r):o}function b_(t,e,n,r){const i=Object.keys(e),o=En(t,i[0]),c=Ji(o,e[i[0]],n,r);return!c||!c.length?t.next(n,r):c}function w_(t,e,n,r){const i=[];for(const o of Object.keys(e)){const c=e[o];if(!c)continue;const u=En(t,o),f=Ji(u,c,n,r);f&&i.push(...f)}return i.length?i:t.next(n,r)}function Ji(t,e,n,r){return typeof e=="string"?m_(t,e,n,r):Object.keys(e).length===1?b_(t,e,n,r):w_(t,e,n,r)}function v_(t){return Object.keys(t.states).map(e=>t.states[e]).filter(e=>e.type==="history")}function Mt(t,e){let n=t;for(;n.parent&&n.parent!==e;)n=n.parent;return n.parent===e}function S_(t,e){const n=new Set(t),r=new Set(e);for(const i of n)if(r.has(i))return!0;for(const i of r)if(n.has(i))return!0;return!1}function iu(t,e,n){const r=new Set;for(const i of t){let o=!1;const c=new Set;for(const u of r)if(S_(Ai([i],e,n),Ai([u],e,n)))if(Mt(i.source,u.source))c.add(u);else{o=!0;break}if(!o){for(const u of c)r.delete(u);r.add(i)}}return Array.from(r)}function x_(t){const[e,...n]=t;for(const r of Zn(e,void 0))if(n.every(i=>Mt(i,r)))return r}function Ki(t,e){if(!t.target)return[];const n=new Set;for(const r of t.target)if(Wt(r))if(e[r.id])for(const i of e[r.id])n.add(i);else for(const i of Ki(ru(r),e))n.add(i);else n.add(r);return[...n]}function ou(t,e){const n=Ki(t,e);if(!n)return;if(!t.reenter&&n.every(i=>i===t.source||Mt(i,t.source)))return t.source;const r=x_(n.concat(t.source));if(r)return r;if(!t.reenter)return t.source.machine.root}function Ai(t,e,n){const r=new Set;for(const i of t)if(i.target?.length){const o=ou(i,n);i.reenter&&i.source===o&&r.add(o);for(const c of e)Mt(c,o)&&r.add(c)}return[...r]}function A_(t,e){if(t.length!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0}function Ii(t,e,n,r,i,o){if(!t.length)return e;const c=new Set(e._nodes);let u=e.historyValue;const f=iu(t,c,u);let d=e;i||([d,u]=C_(d,r,n,f,c,u,o,n.actionExecutor)),d=kn(d,r,n,f.flatMap(h=>h.actions),o,void 0),d=E_(d,r,n,f,c,o,u,i);const _=[...c];d.status==="done"&&(d=kn(d,r,n,_.sort((h,g)=>g.order-h.order).flatMap(h=>h.exit),o,void 0));try{return u===e.historyValue&&A_(e._nodes,c)?d:Kt(d,{_nodes:_,historyValue:u})}catch(h){throw h}}function I_(t,e,n,r,i){if(r.output===void 0)return;const o=vi(i.id,i.output!==void 0&&i.parent?Si(i.output,t.context,e,n.self):void 0);return Si(r.output,t.context,o,n.self)}function E_(t,e,n,r,i,o,c,u){let f=t;const d=new Set,_=new Set;k_(r,c,_,d),u&&_.add(t.machine.root);const h=new Set;for(const g of[...d].sort((p,m)=>p.order-m.order)){i.add(g);const p=[];p.push(...g.entry);for(const m of g.invoke)p.push(f_(m.src,{...m,syncSnapshot:!!m.onSnapshot}));if(_.has(g)){const m=g.initial.actions;p.push(...m)}if(f=kn(f,e,n,p,o,g.invoke.map(m=>m.id)),g.type==="final"){const m=g.parent;let v=m?.type==="parallel"?m:m?.parent,I=v||g;for(m?.type==="compound"&&o.push(vi(m.id,g.output!==void 0?Si(g.output,f.context,e,n.self):void 0));v?.type==="parallel"&&!h.has(v)&&Gi(i,v);)h.add(v),o.push(vi(v.id)),I=v,v=v.parent;if(v)continue;f=Kt(f,{status:"done",output:I_(f,e,n,f.machine.root,I)})}}return f}function k_(t,e,n,r){for(const i of t){const o=ou(i,e);for(const u of i.target||[])!Wt(u)&&(i.source!==u||i.source!==o||i.reenter)&&(r.add(u),n.add(u)),vn(u,e,n,r);const c=Ki(i,e);for(const u of c){const f=Zn(u,o);o?.type==="parallel"&&f.push(o),au(r,e,n,f,!i.source.parent&&i.reenter?void 0:o)}}}function vn(t,e,n,r){if(Wt(t))if(e[t.id]){const i=e[t.id];for(const o of i)r.add(o),vn(o,e,n,r);for(const o of i)ti(o,t.parent,r,e,n)}else{const i=ru(t);for(const o of i.target)r.add(o),i===t.parent?.initial&&n.add(t.parent),vn(o,e,n,r);for(const o of i.target)ti(o,t.parent,r,e,n)}else if(t.type==="compound"){const[i]=t.initial.target;Wt(i)||(r.add(i),n.add(i)),vn(i,e,n,r),ti(i,t,r,e,n)}else if(t.type==="parallel")for(const i of In(t).filter(o=>!Wt(o)))[...r].some(o=>Mt(o,i))||(Wt(i)||(r.add(i),n.add(i)),vn(i,e,n,r))}function au(t,e,n,r,i){for(const o of r)if((!i||Mt(o,i))&&t.add(o),o.type==="parallel")for(const c of In(o).filter(u=>!Wt(u)))[...t].some(u=>Mt(u,c))||(t.add(c),vn(c,e,n,t))}function ti(t,e,n,r,i){au(n,r,i,Zn(t,e))}function C_(t,e,n,r,i,o,c,u){let f=t;const d=Ai(r,i,o);d.sort((h,g)=>g.order-h.order);let _;for(const h of d)for(const g of v_(h)){let p;g.history==="deep"?p=m=>qi(m)&&Mt(m,h):p=m=>m.parent===h,_??={...o},_[g.id]=Array.from(i).filter(p)}for(const h of d)f=kn(f,e,n,[...h.exit,...h.invoke.map(g=>Qc(g.id))],c,void 0),i.delete(h);return[f,_||o]}function T_(t,e){return t.implementations.actions[e]}function cu(t,e,n,r,i,o){const{machine:c}=t;let u=t;for(const f of r){const d=typeof f=="function",_=d?f:T_(c,typeof f=="string"?f:f.type),h={context:u.context,event:e,self:n.self,system:n.system},g=d||typeof f=="string"?void 0:"params"in f?typeof f.params=="function"?f.params({context:u.context,event:e}):f.params:void 0;if(!_||!("resolve"in _)){n.actionExecutor({type:typeof f=="string"?f:typeof f=="object"?f.type:f.name||"(anonymous)",info:h,params:g,exec:_});continue}const p=_,[m,v,I]=p.resolve(n,u,h,g,_,i);u=m,"retryResolve"in p&&o?.push([p,v]),"execute"in p&&n.actionExecutor({type:p.type,info:h,params:v,exec:p.execute.bind(null,n,v)}),I&&(u=cu(u,e,n,I,i,o))}return u}function kn(t,e,n,r,i,o){const c=o?[]:void 0,u=cu(t,e,n,r,{internalQueue:i,deferredActorIds:o},c);return c?.forEach(([f,d])=>{f.retryResolve(n,u,d)}),u}function ni(t,e,n,r){let i=t;const o=[];function c(d,_,h){n.system._sendInspectionEvent({type:"@xstate.microstep",actorRef:n.self,event:_,snapshot:d,_transitions:h}),o.push(d)}if(e.type===wi)return i=Kt(Pa(i,e,n),{status:"stopped"}),c(i,e,[]),{snapshot:i,microstates:o};let u=e;if(u.type!==Gc){const d=u,_=e_(d),h=Ha(d,i);if(_&&!h.length)return i=Kt(t,{status:"error",error:d.error}),c(i,d,[]),{snapshot:i,microstates:o};i=Ii(h,t,n,u,!1,r),c(i,d,h)}let f=!0;for(;i.status==="active";){let d=f?O_(i,u):[];const _=d.length?i:void 0;if(!d.length){if(!r.length)break;u=r.shift(),d=Ha(u,i)}i=Ii(d,i,n,u,!1,r),f=i!==_,c(i,u,d)}return i.status!=="active"&&Pa(i,u,n),{snapshot:i,microstates:o}}function Pa(t,e,n){return kn(t,e,n,Object.values(t.children).map(r=>Qc(r)),[],void 0)}function Ha(t,e){return e.machine.getTransitionData(e,t)}function O_(t,e){const n=new Set,r=t._nodes.filter(qi);for(const i of r)e:for(const o of[i].concat(Zn(i,void 0)))if(o.always){for(const c of o.always)if(c.guard===void 0||Wi(c.guard,t.context,e,t)){n.add(c);break e}}return iu(Array.from(n),new Set(t._nodes),t.historyValue)}function R_(t,e){const n=$r(Lr(t,e));return nu(t,[...n])}function M_(t){return!!t&&typeof t=="object"&&"machine"in t&&"value"in t}const j_=function(e){return Kc(e,this.value)},D_=function(e){return this.tags.has(e)},U_=function(e){const n=this.machine.getTransitionData(this,e);return!!n?.length&&n.some(r=>r.target!==void 0||r.actions.length)},P_=function(){const{_nodes:e,tags:n,machine:r,getMeta:i,toJSON:o,can:c,hasTag:u,matches:f,...d}=this;return{...d,tags:Array.from(n)}},H_=function(){return this._nodes.reduce((e,n)=>(n.meta!==void 0&&(e[n.id]=n.meta),e),{})};function Ir(t,e){return{status:t.status,output:t.output,error:t.error,machine:e,context:t.context,_nodes:t._nodes,value:nu(e.root,t._nodes),tags:new Set(t._nodes.flatMap(n=>n.tags)),children:t.children,historyValue:t.historyValue||{},matches:j_,hasTag:D_,can:U_,getMeta:H_,toJSON:P_}}function Kt(t,e={}){return Ir({...t,...e},t.machine)}function $_(t){if(typeof t!="object"||t===null)return{};const e={};for(const n in t){const r=t[n];Array.isArray(r)&&(e[n]=r.map(i=>({id:i.id})))}return e}function B_(t,e){const{_nodes:n,tags:r,machine:i,children:o,context:c,can:u,hasTag:f,matches:d,getMeta:_,toJSON:h,...g}=t,p={};for(const v in o){const I=o[v];p[v]={snapshot:I.getPersistedSnapshot(e),src:I.src,systemId:I._systemId,syncSnapshot:I._syncSnapshot}}return{...g,context:uu(c),children:p,historyValue:$_(g.historyValue)}}function uu(t){let e;for(const n in t){const r=t[n];if(r&&typeof r=="object")if("sessionId"in r&&"send"in r&&"ref"in r)e??=Array.isArray(t)?t.slice():{...t},e[n]={xstate$$type:Vi,id:r.id};else{const i=uu(r);i!==r&&(e??=Array.isArray(t)?t.slice():{...t},e[n]=i)}}return e??t}function L_(t,e,n,r,{event:i,id:o,delay:c},{internalQueue:u}){const f=e.machine.implementations.delays;if(typeof i=="string")throw new Error(`Only event objects may be used with raise; use raise({ type: "${i}" }) instead`);const d=typeof i=="function"?i(n,r):i;let _;if(typeof c=="string"){const h=f&&f[c];_=typeof h=="function"?h(n,r):h}else _=typeof c=="function"?c(n,r):c;return typeof _!="number"&&u.push(d),[e,{event:d,id:o,delay:_},void 0]}function F_(t,e){const{event:n,delay:r,id:i}=e;if(typeof r=="number"){t.defer(()=>{const o=t.self;t.system.scheduler.schedule(o,o,n,r,i)});return}}function N_(t,e){function n(r,i){}return n.type="xstate.raise",n.event=t,n.id=e?.id,n.delay=e?.delay,n.resolve=L_,n.execute=F_,n}function z_(t,{machine:e,context:n},r,i){const o=(c,u)=>{if(typeof c=="string"){const f=zi(e,c);if(!f)throw new Error(`Actor logic '${c}' not implemented in machine '${e.id}'`);const d=Vn(f,{id:u?.id,parent:t.self,syncSnapshot:u?.syncSnapshot,input:typeof u?.input=="function"?u.input({context:n,event:r,self:t.self}):u?.input,src:c,systemId:u?.systemId});return i[d.id]=d,d}else return Vn(c,{id:u?.id,parent:t.self,syncSnapshot:u?.syncSnapshot,input:u?.input,src:c,systemId:u?.systemId})};return(c,u)=>{const f=o(c,u);return i[f.id]=f,t.defer(()=>{f._processingStatus!==Be.Stopped&&f.start()}),f}}function V_(t,e,n,r,{assignment:i}){if(!e.context)throw new Error("Cannot assign to undefined `context`. Ensure that `context` is defined in the machine config.");const o={},c={context:e.context,event:n.event,spawn:z_(t,e,n.event,o),self:t.self,system:t.system};let u={};if(typeof i=="function")u=i(c,r);else for(const d of Object.keys(i)){const _=i[d];u[d]=typeof _=="function"?_(c,r):_}const f=Object.assign({},e.context,u);return[Kt(e,{context:f,children:Object.keys(o).length?{...e.children,...o}:e.children}),void 0,void 0]}function Hn(t){function e(n,r){}return e.type="xstate.assign",e.assignment=t,e.resolve=V_,e}const $a=new WeakMap;function _n(t,e,n){let r=$a.get(t);return r?e in r||(r[e]=n()):(r={[e]:n()},$a.set(t,r)),r[e]}const W_={},Dn=t=>typeof t=="string"?{type:t}:typeof t=="function"?"resolve"in t?{type:t.type}:{type:t.name}:t;class Fr{constructor(e,n){if(this.config=e,this.key=void 0,this.id=void 0,this.type=void 0,this.path=void 0,this.states=void 0,this.history=void 0,this.entry=void 0,this.exit=void 0,this.parent=void 0,this.machine=void 0,this.meta=void 0,this.output=void 0,this.order=-1,this.description=void 0,this.tags=[],this.transitions=void 0,this.always=void 0,this.parent=n._parent,this.key=n._key,this.machine=n._machine,this.path=this.parent?this.parent.path.concat(this.key):[],this.id=this.config.id||[this.machine.id,...this.path].join(Wc),this.type=this.config.type||(this.config.states&&Object.keys(this.config.states).length?"compound":this.config.history?"history":"atomic"),this.description=this.config.description,this.order=this.machine.idMap.size,this.machine.idMap.set(this.id,this),this.states=this.config.states?Ma(this.config.states,(r,i)=>new Fr(r,{_parent:this,_key:i,_machine:this.machine})):W_,this.type==="compound"&&!this.config.initial)throw new Error(`No initial state specified for compound state node "#${this.id}". Try adding { initial: "${Object.keys(this.states)[0]}" } to the state config.`);this.history=this.config.history===!0?"shallow":this.config.history||!1,this.entry=xt(this.config.entry).slice(),this.exit=xt(this.config.exit).slice(),this.meta=this.config.meta,this.output=this.type==="final"||!this.parent?this.config.output:void 0,this.tags=xt(e.tags).slice()}_initialize(){this.transitions=__(this),this.config.always&&(this.always=bn(this.config.always).map(e=>zt(this,qc,e))),Object.keys(this.states).forEach(e=>{this.states[e]._initialize()})}get definition(){return{id:this.id,key:this.key,version:this.machine.version,type:this.type,initial:this.initial?{target:this.initial.target,source:this,actions:this.initial.actions.map(Dn),eventType:null,reenter:!1,toJSON:()=>({target:this.initial.target.map(e=>`#${e.id}`),source:`#${this.id}`,actions:this.initial.actions.map(Dn),eventType:null})}:void 0,history:this.history,states:Ma(this.states,e=>e.definition),on:this.on,transitions:[...this.transitions.values()].flat().map(e=>({...e,actions:e.actions.map(Dn)})),entry:this.entry.map(Dn),exit:this.exit.map(Dn),meta:this.meta,order:this.order||-1,output:this.output,invoke:this.invoke,description:this.description,tags:this.tags}}toJSON(){return this.definition}get invoke(){return _n(this,"invoke",()=>xt(this.config.invoke).map((e,n)=>{const{src:r,systemId:i}=e,o=e.id??ja(this.id,n),c=typeof r=="string"?r:`xstate.invoke.${ja(this.id,n)}`;return{...e,src:c,id:o,systemId:i,toJSON(){const{onDone:u,onError:f,...d}=e;return{...d,type:"xstate.invoke",src:c,id:o}}}}))}get on(){return _n(this,"on",()=>[...this.transitions].flatMap(([n,r])=>r.map(i=>[n,i])).reduce((n,[r,i])=>(n[r]=n[r]||[],n[r].push(i),n),{}))}get after(){return _n(this,"delayedTransitions",()=>g_(this))}get initial(){return _n(this,"initial",()=>p_(this,this.config.initial))}next(e,n){const r=n.type,i=[];let o;const c=_n(this,`candidates-${r}`,()=>h_(this,r));for(const u of c){const{guard:f}=u,d=e.context;let _=!1;try{_=!f||Wi(f,d,n,e)}catch(h){const g=typeof f=="string"?f:typeof f=="object"?f.type:void 0;throw new Error(`Unable to evaluate guard ${g?`'${g}' `:""}in transition for event '${r}' in state node '${this.id}':
${h.message}`)}if(_){i.push(...u.actions),o=u;break}}return o?[o]:void 0}get events(){return _n(this,"events",()=>{const{states:e}=this,n=new Set(this.ownEvents);if(e)for(const r of Object.keys(e)){const i=e[r];if(i.states)for(const o of i.events)n.add(`${o}`)}return Array.from(n)})}get ownEvents(){const e=new Set([...this.transitions.keys()].filter(n=>this.transitions.get(n).some(r=>!(!r.target&&!r.actions.length&&!r.reenter))));return Array.from(e)}}const q_="#";class Yi{constructor(e,n){this.config=e,this.version=void 0,this.schemas=void 0,this.implementations=void 0,this.__xstatenode=!0,this.idMap=new Map,this.root=void 0,this.id=void 0,this.states=void 0,this.events=void 0,this.id=e.id||"(machine)",this.implementations={actors:n?.actors??{},actions:n?.actions??{},delays:n?.delays??{},guards:n?.guards??{}},this.version=this.config.version,this.schemas=this.config.schemas,this.transition=this.transition.bind(this),this.getInitialSnapshot=this.getInitialSnapshot.bind(this),this.getPersistedSnapshot=this.getPersistedSnapshot.bind(this),this.restoreSnapshot=this.restoreSnapshot.bind(this),this.start=this.start.bind(this),this.root=new Fr(e,{_key:this.id,_machine:this}),this.root._initialize(),this.states=this.root.states,this.events=this.root.events}provide(e){const{actions:n,guards:r,actors:i,delays:o}=this.implementations;return new Yi(this.config,{actions:{...n,...e.actions},guards:{...r,...e.guards},actors:{...i,...e.actors},delays:{...o,...e.delays}})}resolveState(e){const n=R_(this.root,e.value),r=$r(Lr(this.root,n));return Ir({_nodes:[...r],context:e.context||{},children:{},status:Gi(r,this.root)?"done":e.status||"active",output:e.output,error:e.error,historyValue:e.historyValue},this)}transition(e,n,r){return ni(e,n,r,[]).snapshot}microstep(e,n,r){return ni(e,n,r,[]).microstates}getTransitionData(e,n){return Ji(this.root,e.value,e,n)||[]}getPreInitialState(e,n,r){const{context:i}=this.config,o=Ir({context:typeof i!="function"&&i?i:{},_nodes:[this.root],children:{},status:"active"},this);return typeof i=="function"?kn(o,n,e,[Hn(({spawn:u,event:f,self:d})=>i({spawn:u,input:f.input,self:d}))],r,void 0):o}getInitialSnapshot(e,n){const r=Jc(n),i=[],o=this.getPreInitialState(e,r,i),c=Ii([{target:[...su(this.root)],source:this.root,reenter:!0,actions:[],eventType:null,toJSON:null}],o,e,r,!0,i),{snapshot:u}=ni(c,r,e,i);return u}start(e){Object.values(e.children).forEach(n=>{n.getSnapshot().status==="active"&&n.start()})}getStateNodeById(e){const n=Ni(e),r=n.slice(1),i=ts(n[0])?n[0].slice(q_.length):n[0],o=this.idMap.get(i);if(!o)throw new Error(`Child state node '#${i}' does not exist on machine '${this.id}'`);return Br(o,r)}get definition(){return this.root.definition}toJSON(){return this.definition}getPersistedSnapshot(e,n){return B_(e,n)}restoreSnapshot(e,n){const r={},i=e.children;Object.keys(i).forEach(h=>{const g=i[h],p=g.snapshot,m=g.src,v=typeof m=="string"?zi(this,m):m;if(!v)return;const I=Vn(v,{id:h,parent:n.self,syncSnapshot:g.syncSnapshot,snapshot:p,src:m,systemId:g.systemId});r[h]=I});function o(h,g){if(g instanceof Fr)return g;try{return h.machine.getStateNodeById(g.id)}catch{}}function c(h,g){if(!g||typeof g!="object")return{};const p={};for(const m in g){const v=g[m];for(const I of v){const $=o(h,I);$&&(p[m]??=[],p[m].push($))}}return p}const u=c(this.root,e.historyValue),f=Ir({...e,children:r,_nodes:Array.from($r(Lr(this.root,e.value))),historyValue:u},this),d=new Set;function _(h,g){if(!d.has(h)){d.add(h);for(const p in h){const m=h[p];if(m&&typeof m=="object"){if("xstate$$type"in m&&m.xstate$$type===Vi){h[p]=g[m.id];continue}_(m,g)}}}}return _(f.context,r),f}}function G_(t,e){const n=xt(e);if(!n.includes(t.type)){const r=n.length===1?`type "${n[0]}"`:`one of types "${n.join('", "')}"`;throw new Error(`Expected event ${JSON.stringify(t)} to have ${r}`)}}function J_(t,e){return new Yi(t,e)}function K_({schemas:t,actors:e,actions:n,guards:r,delays:i}){return{createMachine:o=>J_({...o,schemas:t},{actors:e,actions:n,guards:r,delays:i})}}const Y_={timeout:1/0};function X_(t,e,n){const r={...Y_,...n};return new Promise((i,o)=>{const{signal:c}=r;if(c?.aborted){o(c.reason);return}let u=!1;const f=r.timeout===1/0?void 0:setTimeout(()=>{d(),o(new Error(`Timeout of ${r.timeout} ms exceeded`))},r.timeout),d=()=>{clearTimeout(f),u=!0,g?.unsubscribe(),h&&c.removeEventListener("abort",h)};function _(p){e(p)&&(d(),i(p))}let h,g;_(t.getSnapshot()),!u&&(c&&(h=()=>{d(),o(c.reason)},c.addEventListener("abort",h)),g=t.subscribe({next:_,error:p=>{d(),o(p)},complete:()=>{d(),o(new Error("Actor terminated without satisfying predicate"))}}),u&&g.unsubscribe())})}let pr;const Z_=new Uint8Array(16);function Q_(){if(!pr&&(pr=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!pr))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return pr(Z_)}const ep=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function ns(t){return typeof t=="string"&&ep.test(t)}const je=[];for(let t=0;t<256;++t)je.push((t+256).toString(16).slice(1));function fu(t,e=0){return je[t[e+0]]+je[t[e+1]]+je[t[e+2]]+je[t[e+3]]+"-"+je[t[e+4]]+je[t[e+5]]+"-"+je[t[e+6]]+je[t[e+7]]+"-"+je[t[e+8]]+je[t[e+9]]+"-"+je[t[e+10]]+je[t[e+11]]+je[t[e+12]]+je[t[e+13]]+je[t[e+14]]+je[t[e+15]]}function tp(t,e=0){const n=fu(t,e);if(!ns(n))throw TypeError("Stringified UUID is invalid");return n}function np(t){if(!ns(t))throw TypeError("Invalid UUID");let e;const n=new Uint8Array(16);return n[0]=(e=parseInt(t.slice(0,8),16))>>>24,n[1]=e>>>16&255,n[2]=e>>>8&255,n[3]=e&255,n[4]=(e=parseInt(t.slice(9,13),16))>>>8,n[5]=e&255,n[6]=(e=parseInt(t.slice(14,18),16))>>>8,n[7]=e&255,n[8]=(e=parseInt(t.slice(19,23),16))>>>8,n[9]=e&255,n[10]=(e=parseInt(t.slice(24,36),16))/1099511627776&255,n[11]=e/4294967296&255,n[12]=e>>>24&255,n[13]=e>>>16&255,n[14]=e>>>8&255,n[15]=e&255,n}const rp=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Ba={randomUUID:rp};function lu(t,e,n){if(Ba.randomUUID&&!e&&!t)return Ba.randomUUID();t=t||{};const r=t.random||(t.rng||Q_)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){n=n||0;for(let i=0;i<16;++i)e[n+i]=r[i];return e}return fu(r)}var rt={},pe={},De={},ri={},Un={},La;function sp(){return La||(La=1,Object.defineProperty(Un,"__esModule",{value:!0}),Un.crypto=void 0,Un.crypto=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0),Un}var Fa;function du(){return Fa||(Fa=1,function(t){/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */Object.defineProperty(t,"__esModule",{value:!0}),t.wrapXOFConstructorWithOpts=t.wrapConstructorWithOpts=t.wrapConstructor=t.Hash=t.nextTick=t.swap32IfBE=t.byteSwapIfBE=t.swap8IfBE=t.isLE=void 0,t.isBytes=n,t.anumber=r,t.abytes=i,t.ahash=o,t.aexists=c,t.aoutput=u,t.u8=f,t.u32=d,t.clean=_,t.createView=h,t.rotr=g,t.rotl=p,t.byteSwap=m,t.byteSwap32=v,t.bytesToHex=D,t.hexToBytes=z,t.asyncLoop=te,t.utf8ToBytes=Z,t.bytesToUtf8=F,t.toBytes=V,t.kdfInputToBytes=K,t.concatBytes=se,t.checkOpts=S,t.createHasher=P,t.createOptHasher=B,t.createXOFer=U,t.randomBytes=Q;const e=sp();function n(C){return C instanceof Uint8Array||ArrayBuffer.isView(C)&&C.constructor.name==="Uint8Array"}function r(C){if(!Number.isSafeInteger(C)||C<0)throw new Error("positive integer expected, got "+C)}function i(C,...N){if(!n(C))throw new Error("Uint8Array expected");if(N.length>0&&!N.includes(C.length))throw new Error("Uint8Array expected of length "+N+", got length="+C.length)}function o(C){if(typeof C!="function"||typeof C.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");r(C.outputLen),r(C.blockLen)}function c(C,N=!0){if(C.destroyed)throw new Error("Hash instance has been destroyed");if(N&&C.finished)throw new Error("Hash#digest() has already been called")}function u(C,N){i(C);const w=N.outputLen;if(C.length<w)throw new Error("digestInto() expects output buffer of length at least "+w)}function f(C){return new Uint8Array(C.buffer,C.byteOffset,C.byteLength)}function d(C){return new Uint32Array(C.buffer,C.byteOffset,Math.floor(C.byteLength/4))}function _(...C){for(let N=0;N<C.length;N++)C[N].fill(0)}function h(C){return new DataView(C.buffer,C.byteOffset,C.byteLength)}function g(C,N){return C<<32-N|C>>>N}function p(C,N){return C<<N|C>>>32-N>>>0}t.isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function m(C){return C<<24&4278190080|C<<8&16711680|C>>>8&65280|C>>>24&255}t.swap8IfBE=t.isLE?C=>C:C=>m(C),t.byteSwapIfBE=t.swap8IfBE;function v(C){for(let N=0;N<C.length;N++)C[N]=m(C[N]);return C}t.swap32IfBE=t.isLE?C=>C:v;const I=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",$=Array.from({length:256},(C,N)=>N.toString(16).padStart(2,"0"));function D(C){if(i(C),I)return C.toHex();let N="";for(let w=0;w<C.length;w++)N+=$[C[w]];return N}const k={_0:48,_9:57,A:65,F:70,a:97,f:102};function Y(C){if(C>=k._0&&C<=k._9)return C-k._0;if(C>=k.A&&C<=k.F)return C-(k.A-10);if(C>=k.a&&C<=k.f)return C-(k.a-10)}function z(C){if(typeof C!="string")throw new Error("hex string expected, got "+typeof C);if(I)return Uint8Array.fromHex(C);const N=C.length,w=N/2;if(N%2)throw new Error("hex string expected, got unpadded hex of length "+N);const R=new Uint8Array(w);for(let q=0,ie=0;q<w;q++,ie+=2){const ue=Y(C.charCodeAt(ie)),le=Y(C.charCodeAt(ie+1));if(ue===void 0||le===void 0){const de=C[ie]+C[ie+1];throw new Error('hex string expected, got non-hex character "'+de+'" at index '+ie)}R[q]=ue*16+le}return R}const J=async()=>{};t.nextTick=J;async function te(C,N,w){let R=Date.now();for(let q=0;q<C;q++){w(q);const ie=Date.now()-R;ie>=0&&ie<N||(await(0,t.nextTick)(),R+=ie)}}function Z(C){if(typeof C!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(C))}function F(C){return new TextDecoder().decode(C)}function V(C){return typeof C=="string"&&(C=Z(C)),i(C),C}function K(C){return typeof C=="string"&&(C=Z(C)),i(C),C}function se(...C){let N=0;for(let R=0;R<C.length;R++){const q=C[R];i(q),N+=q.length}const w=new Uint8Array(N);for(let R=0,q=0;R<C.length;R++){const ie=C[R];w.set(ie,q),q+=ie.length}return w}function S(C,N){if(N!==void 0&&{}.toString.call(N)!=="[object Object]")throw new Error("options should be object or undefined");return Object.assign(C,N)}class W{}t.Hash=W;function P(C){const N=R=>C().update(V(R)).digest(),w=C();return N.outputLen=w.outputLen,N.blockLen=w.blockLen,N.create=()=>C(),N}function B(C){const N=(R,q)=>C(q).update(V(R)).digest(),w=C({});return N.outputLen=w.outputLen,N.blockLen=w.blockLen,N.create=R=>C(R),N}function U(C){const N=(R,q)=>C(q).update(V(R)).digest(),w=C({});return N.outputLen=w.outputLen,N.blockLen=w.blockLen,N.create=R=>C(R),N}t.wrapConstructor=P,t.wrapConstructorWithOpts=B,t.wrapXOFConstructorWithOpts=U;function Q(C=32){if(e.crypto&&typeof e.crypto.getRandomValues=="function")return e.crypto.getRandomValues(new Uint8Array(C));if(e.crypto&&typeof e.crypto.randomBytes=="function")return Uint8Array.from(e.crypto.randomBytes(C));throw new Error("crypto.getRandomValues must be defined")}}(ri)),ri}var Na;function ip(){if(Na)return De;Na=1,Object.defineProperty(De,"__esModule",{value:!0}),De.SHA512_IV=De.SHA384_IV=De.SHA224_IV=De.SHA256_IV=De.HashMD=void 0,De.setBigUint64=e,De.Chi=n,De.Maj=r;const t=du();function e(o,c,u,f){if(typeof o.setBigUint64=="function")return o.setBigUint64(c,u,f);const d=BigInt(32),_=BigInt(4294967295),h=Number(u>>d&_),g=Number(u&_),p=f?4:0,m=f?0:4;o.setUint32(c+p,h,f),o.setUint32(c+m,g,f)}function n(o,c,u){return o&c^~o&u}function r(o,c,u){return o&c^o&u^c&u}class i extends t.Hash{constructor(c,u,f,d){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=c,this.outputLen=u,this.padOffset=f,this.isLE=d,this.buffer=new Uint8Array(c),this.view=(0,t.createView)(this.buffer)}update(c){(0,t.aexists)(this),c=(0,t.toBytes)(c),(0,t.abytes)(c);const{view:u,buffer:f,blockLen:d}=this,_=c.length;for(let h=0;h<_;){const g=Math.min(d-this.pos,_-h);if(g===d){const p=(0,t.createView)(c);for(;d<=_-h;h+=d)this.process(p,h);continue}f.set(c.subarray(h,h+g),this.pos),this.pos+=g,h+=g,this.pos===d&&(this.process(u,0),this.pos=0)}return this.length+=c.length,this.roundClean(),this}digestInto(c){(0,t.aexists)(this),(0,t.aoutput)(c,this),this.finished=!0;const{buffer:u,view:f,blockLen:d,isLE:_}=this;let{pos:h}=this;u[h++]=128,(0,t.clean)(this.buffer.subarray(h)),this.padOffset>d-h&&(this.process(f,0),h=0);for(let I=h;I<d;I++)u[I]=0;e(f,d-8,BigInt(this.length*8),_),this.process(f,0);const g=(0,t.createView)(c),p=this.outputLen;if(p%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const m=p/4,v=this.get();if(m>v.length)throw new Error("_sha2: outputLen bigger than state");for(let I=0;I<m;I++)g.setUint32(4*I,v[I],_)}digest(){const{buffer:c,outputLen:u}=this;this.digestInto(c);const f=c.slice(0,u);return this.destroy(),f}_cloneInto(c){c||(c=new this.constructor),c.set(...this.get());const{blockLen:u,buffer:f,length:d,finished:_,destroyed:h,pos:g}=this;return c.destroyed=h,c.finished=_,c.length=d,c.pos=g,d%u&&c.buffer.set(f),c}clone(){return this._cloneInto()}}return De.HashMD=i,De.SHA256_IV=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),De.SHA224_IV=Uint32Array.from([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]),De.SHA384_IV=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),De.SHA512_IV=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),De}var oe={},za;function op(){if(za)return oe;za=1,Object.defineProperty(oe,"__esModule",{value:!0}),oe.toBig=oe.shrSL=oe.shrSH=oe.rotrSL=oe.rotrSH=oe.rotrBL=oe.rotrBH=oe.rotr32L=oe.rotr32H=oe.rotlSL=oe.rotlSH=oe.rotlBL=oe.rotlBH=oe.add5L=oe.add5H=oe.add4L=oe.add4H=oe.add3L=oe.add3H=void 0,oe.add=$,oe.fromBig=n,oe.split=r;const t=BigInt(2**32-1),e=BigInt(32);function n(F,V=!1){return V?{h:Number(F&t),l:Number(F>>e&t)}:{h:Number(F>>e&t)|0,l:Number(F&t)|0}}function r(F,V=!1){const K=F.length;let se=new Uint32Array(K),S=new Uint32Array(K);for(let W=0;W<K;W++){const{h:P,l:B}=n(F[W],V);[se[W],S[W]]=[P,B]}return[se,S]}const i=(F,V)=>BigInt(F>>>0)<<e|BigInt(V>>>0);oe.toBig=i;const o=(F,V,K)=>F>>>K;oe.shrSH=o;const c=(F,V,K)=>F<<32-K|V>>>K;oe.shrSL=c;const u=(F,V,K)=>F>>>K|V<<32-K;oe.rotrSH=u;const f=(F,V,K)=>F<<32-K|V>>>K;oe.rotrSL=f;const d=(F,V,K)=>F<<64-K|V>>>K-32;oe.rotrBH=d;const _=(F,V,K)=>F>>>K-32|V<<64-K;oe.rotrBL=_;const h=(F,V)=>V;oe.rotr32H=h;const g=(F,V)=>F;oe.rotr32L=g;const p=(F,V,K)=>F<<K|V>>>32-K;oe.rotlSH=p;const m=(F,V,K)=>V<<K|F>>>32-K;oe.rotlSL=m;const v=(F,V,K)=>V<<K-32|F>>>64-K;oe.rotlBH=v;const I=(F,V,K)=>F<<K-32|V>>>64-K;oe.rotlBL=I;function $(F,V,K,se){const S=(V>>>0)+(se>>>0);return{h:F+K+(S/2**32|0)|0,l:S|0}}const D=(F,V,K)=>(F>>>0)+(V>>>0)+(K>>>0);oe.add3L=D;const k=(F,V,K,se)=>V+K+se+(F/2**32|0)|0;oe.add3H=k;const Y=(F,V,K,se)=>(F>>>0)+(V>>>0)+(K>>>0)+(se>>>0);oe.add4L=Y;const z=(F,V,K,se,S)=>V+K+se+S+(F/2**32|0)|0;oe.add4H=z;const J=(F,V,K,se,S)=>(F>>>0)+(V>>>0)+(K>>>0)+(se>>>0)+(S>>>0);oe.add5L=J;const te=(F,V,K,se,S,W)=>V+K+se+S+W+(F/2**32|0)|0;oe.add5H=te;const Z={fromBig:n,split:r,toBig:i,shrSH:o,shrSL:c,rotrSH:u,rotrSL:f,rotrBH:d,rotrBL:_,rotr32H:h,rotr32L:g,rotlSH:p,rotlSL:m,rotlBH:v,rotlBL:I,add:$,add3L:D,add3H:k,add4L:Y,add4H:z,add5H:te,add5L:J};return oe.default=Z,oe}var Va;function ap(){if(Va)return pe;Va=1,Object.defineProperty(pe,"__esModule",{value:!0}),pe.sha512_224=pe.sha512_256=pe.sha384=pe.sha512=pe.sha224=pe.sha256=pe.SHA512_256=pe.SHA512_224=pe.SHA384=pe.SHA512=pe.SHA224=pe.SHA256=void 0;const t=ip(),e=op(),n=du(),r=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),i=new Uint32Array(64);class o extends t.HashMD{constructor(k=32){super(64,k,8,!1),this.A=t.SHA256_IV[0]|0,this.B=t.SHA256_IV[1]|0,this.C=t.SHA256_IV[2]|0,this.D=t.SHA256_IV[3]|0,this.E=t.SHA256_IV[4]|0,this.F=t.SHA256_IV[5]|0,this.G=t.SHA256_IV[6]|0,this.H=t.SHA256_IV[7]|0}get(){const{A:k,B:Y,C:z,D:J,E:te,F:Z,G:F,H:V}=this;return[k,Y,z,J,te,Z,F,V]}set(k,Y,z,J,te,Z,F,V){this.A=k|0,this.B=Y|0,this.C=z|0,this.D=J|0,this.E=te|0,this.F=Z|0,this.G=F|0,this.H=V|0}process(k,Y){for(let S=0;S<16;S++,Y+=4)i[S]=k.getUint32(Y,!1);for(let S=16;S<64;S++){const W=i[S-15],P=i[S-2],B=(0,n.rotr)(W,7)^(0,n.rotr)(W,18)^W>>>3,U=(0,n.rotr)(P,17)^(0,n.rotr)(P,19)^P>>>10;i[S]=U+i[S-7]+B+i[S-16]|0}let{A:z,B:J,C:te,D:Z,E:F,F:V,G:K,H:se}=this;for(let S=0;S<64;S++){const W=(0,n.rotr)(F,6)^(0,n.rotr)(F,11)^(0,n.rotr)(F,25),P=se+W+(0,t.Chi)(F,V,K)+r[S]+i[S]|0,U=((0,n.rotr)(z,2)^(0,n.rotr)(z,13)^(0,n.rotr)(z,22))+(0,t.Maj)(z,J,te)|0;se=K,K=V,V=F,F=Z+P|0,Z=te,te=J,J=z,z=P+U|0}z=z+this.A|0,J=J+this.B|0,te=te+this.C|0,Z=Z+this.D|0,F=F+this.E|0,V=V+this.F|0,K=K+this.G|0,se=se+this.H|0,this.set(z,J,te,Z,F,V,K,se)}roundClean(){(0,n.clean)(i)}destroy(){this.set(0,0,0,0,0,0,0,0),(0,n.clean)(this.buffer)}}pe.SHA256=o;class c extends o{constructor(){super(28),this.A=t.SHA224_IV[0]|0,this.B=t.SHA224_IV[1]|0,this.C=t.SHA224_IV[2]|0,this.D=t.SHA224_IV[3]|0,this.E=t.SHA224_IV[4]|0,this.F=t.SHA224_IV[5]|0,this.G=t.SHA224_IV[6]|0,this.H=t.SHA224_IV[7]|0}}pe.SHA224=c;const u=e.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(D=>BigInt(D))),f=u[0],d=u[1],_=new Uint32Array(80),h=new Uint32Array(80);class g extends t.HashMD{constructor(k=64){super(128,k,16,!1),this.Ah=t.SHA512_IV[0]|0,this.Al=t.SHA512_IV[1]|0,this.Bh=t.SHA512_IV[2]|0,this.Bl=t.SHA512_IV[3]|0,this.Ch=t.SHA512_IV[4]|0,this.Cl=t.SHA512_IV[5]|0,this.Dh=t.SHA512_IV[6]|0,this.Dl=t.SHA512_IV[7]|0,this.Eh=t.SHA512_IV[8]|0,this.El=t.SHA512_IV[9]|0,this.Fh=t.SHA512_IV[10]|0,this.Fl=t.SHA512_IV[11]|0,this.Gh=t.SHA512_IV[12]|0,this.Gl=t.SHA512_IV[13]|0,this.Hh=t.SHA512_IV[14]|0,this.Hl=t.SHA512_IV[15]|0}get(){const{Ah:k,Al:Y,Bh:z,Bl:J,Ch:te,Cl:Z,Dh:F,Dl:V,Eh:K,El:se,Fh:S,Fl:W,Gh:P,Gl:B,Hh:U,Hl:Q}=this;return[k,Y,z,J,te,Z,F,V,K,se,S,W,P,B,U,Q]}set(k,Y,z,J,te,Z,F,V,K,se,S,W,P,B,U,Q){this.Ah=k|0,this.Al=Y|0,this.Bh=z|0,this.Bl=J|0,this.Ch=te|0,this.Cl=Z|0,this.Dh=F|0,this.Dl=V|0,this.Eh=K|0,this.El=se|0,this.Fh=S|0,this.Fl=W|0,this.Gh=P|0,this.Gl=B|0,this.Hh=U|0,this.Hl=Q|0}process(k,Y){for(let w=0;w<16;w++,Y+=4)_[w]=k.getUint32(Y),h[w]=k.getUint32(Y+=4);for(let w=16;w<80;w++){const R=_[w-15]|0,q=h[w-15]|0,ie=e.rotrSH(R,q,1)^e.rotrSH(R,q,8)^e.shrSH(R,q,7),ue=e.rotrSL(R,q,1)^e.rotrSL(R,q,8)^e.shrSL(R,q,7),le=_[w-2]|0,de=h[w-2]|0,ge=e.rotrSH(le,de,19)^e.rotrBH(le,de,61)^e.shrSH(le,de,6),_e=e.rotrSL(le,de,19)^e.rotrBL(le,de,61)^e.shrSL(le,de,6),Ae=e.add4L(ue,_e,h[w-7],h[w-16]),jt=e.add4H(Ae,ie,ge,_[w-7],_[w-16]);_[w]=jt|0,h[w]=Ae|0}let{Ah:z,Al:J,Bh:te,Bl:Z,Ch:F,Cl:V,Dh:K,Dl:se,Eh:S,El:W,Fh:P,Fl:B,Gh:U,Gl:Q,Hh:C,Hl:N}=this;for(let w=0;w<80;w++){const R=e.rotrSH(S,W,14)^e.rotrSH(S,W,18)^e.rotrBH(S,W,41),q=e.rotrSL(S,W,14)^e.rotrSL(S,W,18)^e.rotrBL(S,W,41),ie=S&P^~S&U,ue=W&B^~W&Q,le=e.add5L(N,q,ue,d[w],h[w]),de=e.add5H(le,C,R,ie,f[w],_[w]),ge=le|0,_e=e.rotrSH(z,J,28)^e.rotrBH(z,J,34)^e.rotrBH(z,J,39),Ae=e.rotrSL(z,J,28)^e.rotrBL(z,J,34)^e.rotrBL(z,J,39),jt=z&te^z&F^te&F,er=J&Z^J&V^Z&V;C=U|0,N=Q|0,U=P|0,Q=B|0,P=S|0,B=W|0,{h:S,l:W}=e.add(K|0,se|0,de|0,ge|0),K=F|0,se=V|0,F=te|0,V=Z|0,te=z|0,Z=J|0;const Dt=e.add3L(ge,Ae,er);z=e.add3H(Dt,de,_e,jt),J=Dt|0}({h:z,l:J}=e.add(this.Ah|0,this.Al|0,z|0,J|0)),{h:te,l:Z}=e.add(this.Bh|0,this.Bl|0,te|0,Z|0),{h:F,l:V}=e.add(this.Ch|0,this.Cl|0,F|0,V|0),{h:K,l:se}=e.add(this.Dh|0,this.Dl|0,K|0,se|0),{h:S,l:W}=e.add(this.Eh|0,this.El|0,S|0,W|0),{h:P,l:B}=e.add(this.Fh|0,this.Fl|0,P|0,B|0),{h:U,l:Q}=e.add(this.Gh|0,this.Gl|0,U|0,Q|0),{h:C,l:N}=e.add(this.Hh|0,this.Hl|0,C|0,N|0),this.set(z,J,te,Z,F,V,K,se,S,W,P,B,U,Q,C,N)}roundClean(){(0,n.clean)(_,h)}destroy(){(0,n.clean)(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}pe.SHA512=g;class p extends g{constructor(){super(48),this.Ah=t.SHA384_IV[0]|0,this.Al=t.SHA384_IV[1]|0,this.Bh=t.SHA384_IV[2]|0,this.Bl=t.SHA384_IV[3]|0,this.Ch=t.SHA384_IV[4]|0,this.Cl=t.SHA384_IV[5]|0,this.Dh=t.SHA384_IV[6]|0,this.Dl=t.SHA384_IV[7]|0,this.Eh=t.SHA384_IV[8]|0,this.El=t.SHA384_IV[9]|0,this.Fh=t.SHA384_IV[10]|0,this.Fl=t.SHA384_IV[11]|0,this.Gh=t.SHA384_IV[12]|0,this.Gl=t.SHA384_IV[13]|0,this.Hh=t.SHA384_IV[14]|0,this.Hl=t.SHA384_IV[15]|0}}pe.SHA384=p;const m=Uint32Array.from([2352822216,424955298,1944164710,2312950998,502970286,855612546,1738396948,1479516111,258812777,2077511080,2011393907,79989058,1067287976,1780299464,286451373,2446758561]),v=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]);class I extends g{constructor(){super(28),this.Ah=m[0]|0,this.Al=m[1]|0,this.Bh=m[2]|0,this.Bl=m[3]|0,this.Ch=m[4]|0,this.Cl=m[5]|0,this.Dh=m[6]|0,this.Dl=m[7]|0,this.Eh=m[8]|0,this.El=m[9]|0,this.Fh=m[10]|0,this.Fl=m[11]|0,this.Gh=m[12]|0,this.Gl=m[13]|0,this.Hh=m[14]|0,this.Hl=m[15]|0}}pe.SHA512_224=I;class $ extends g{constructor(){super(32),this.Ah=v[0]|0,this.Al=v[1]|0,this.Bh=v[2]|0,this.Bl=v[3]|0,this.Ch=v[4]|0,this.Cl=v[5]|0,this.Dh=v[6]|0,this.Dl=v[7]|0,this.Eh=v[8]|0,this.El=v[9]|0,this.Fh=v[10]|0,this.Fl=v[11]|0,this.Gh=v[12]|0,this.Gl=v[13]|0,this.Hh=v[14]|0,this.Hl=v[15]|0}}return pe.SHA512_256=$,pe.sha256=(0,n.createHasher)(()=>new o),pe.sha224=(0,n.createHasher)(()=>new c),pe.sha512=(0,n.createHasher)(()=>new g),pe.sha384=(0,n.createHasher)(()=>new p),pe.sha512_256=(0,n.createHasher)(()=>new $),pe.sha512_224=(0,n.createHasher)(()=>new I),pe}var Wa;function cp(){if(Wa)return rt;Wa=1,Object.defineProperty(rt,"__esModule",{value:!0}),rt.sha224=rt.SHA224=rt.sha256=rt.SHA256=void 0;const t=ap();return rt.SHA256=t.SHA256,rt.sha256=t.sha256,rt.SHA224=t.SHA224,rt.sha224=t.sha224,rt}var si,qa;function up(){if(qa)return si;qa=1;function t(e){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),c=o.charCodeAt(0);if(n[c]!==255)throw new TypeError(o+" is ambiguous");n[c]=i}var u=e.length,f=e.charAt(0),d=Math.log(u)/Math.log(256),_=Math.log(256)/Math.log(u);function h(m){if(m instanceof Uint8Array||(ArrayBuffer.isView(m)?m=new Uint8Array(m.buffer,m.byteOffset,m.byteLength):Array.isArray(m)&&(m=Uint8Array.from(m))),!(m instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(m.length===0)return"";for(var v=0,I=0,$=0,D=m.length;$!==D&&m[$]===0;)$++,v++;for(var k=(D-$)*_+1>>>0,Y=new Uint8Array(k);$!==D;){for(var z=m[$],J=0,te=k-1;(z!==0||J<I)&&te!==-1;te--,J++)z+=256*Y[te]>>>0,Y[te]=z%u>>>0,z=z/u>>>0;if(z!==0)throw new Error("Non-zero carry");I=J,$++}for(var Z=k-I;Z!==k&&Y[Z]===0;)Z++;for(var F=f.repeat(v);Z<k;++Z)F+=e.charAt(Y[Z]);return F}function g(m){if(typeof m!="string")throw new TypeError("Expected String");if(m.length===0)return new Uint8Array;for(var v=0,I=0,$=0;m[v]===f;)I++,v++;for(var D=(m.length-v)*d+1>>>0,k=new Uint8Array(D);m[v];){var Y=m.charCodeAt(v);if(Y>255)return;var z=n[Y];if(z===255)return;for(var J=0,te=D-1;(z!==0||J<$)&&te!==-1;te--,J++)z+=u*k[te]>>>0,k[te]=z%256>>>0,z=z/256>>>0;if(z!==0)throw new Error("Non-zero carry");$=J,v++}for(var Z=D-$;Z!==D&&k[Z]===0;)Z++;for(var F=new Uint8Array(I+(D-Z)),V=I;Z!==D;)F[V++]=k[Z++];return F}function p(m){var v=g(m);if(v)return v;throw new Error("Non-base"+u+" character")}return{encode:h,decodeUnsafe:g,decode:p}}return si=t,si}var ii,Ga;function fp(){return Ga||(Ga=1,ii=up()("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz")),ii}var oi,Ja;function lp(){if(Ja)return oi;Ja=1;var t=fp();return oi=function(e){function n(c){var u=Uint8Array.from(c),f=e(u),d=u.length+4,_=new Uint8Array(d);return _.set(u,0),_.set(f.subarray(0,4),u.length),t.encode(_,d)}function r(c){var u=c.slice(0,-4),f=c.slice(-4),d=e(u);if(!(f[0]^d[0]|f[1]^d[1]|f[2]^d[2]|f[3]^d[3]))return u}function i(c){var u=t.decodeUnsafe(c);if(u)return r(u)}function o(c){var u=t.decode(c),f=r(u);if(!f)throw new Error("Invalid checksum");return f}return{encode:n,decode:o,decodeUnsafe:i}},oi}var ai,Ka;function dp(){if(Ka)return ai;Ka=1;var{sha256:t}=cp(),e=lp();function n(r){return t(t(r))}return ai=e(n),ai}var hp=dp();const Qt=Fi(hp),gp=t=>{if(t.length%2!==0)throw new Error("Hex string must have an even length");const e=new Uint8Array(t.length/2);for(let n=0;n<t.length;n+=2)e[n>>1]=parseInt(t.slice(n,n+2),16);return e},hu=t=>Array.from(t,e=>e.toString(16).padStart(2,"0")).join(""),Nr="automerge:",Wn=t=>{const[e,n,...r]=t.split("#");if(r.length>0)throw new Error("Invalid URL: contains multiple heads sections");const i=new RegExp(`^${Nr}(\\w+)$`),[,o]=e.match(i)||[],c=o,u=yu(c);if(!u)throw new Error("Invalid document URL: "+t);if(n===void 0)return{binaryDocumentId:u,documentId:c};const f=n===""?[]:n.split("|"),d=f.map(_=>{try{return hu(Qt.decode(_))}catch{throw new Error(`Invalid head in URL: ${_}`)}});return{binaryDocumentId:u,hexHeads:d,documentId:c,heads:f}},gu=t=>{if(t instanceof Uint8Array||typeof t=="string")return Nr+(t instanceof Uint8Array?zr(t):t);const{documentId:e,heads:n=void 0}=t;if(e===void 0)throw new Error("Invalid documentId: "+e);const r=e instanceof Uint8Array?zr(e):e;let i=`${Nr}${r}`;return n!==void 0&&(n.forEach(o=>{try{Qt.decode(o)}catch{throw new Error(`Invalid head: ${o}`)}}),i+="#"+n.join("|")),i},_u=t=>{if(typeof t!="string"||!t||!t.startsWith(Nr))return!1;try{const{documentId:e,heads:n}=Wn(t);return!(!pu(e)||n&&!n.every(r=>{try{return Qt.decode(r),!0}catch{return!1}}))}catch{return!1}},pu=t=>{if(typeof t!="string")return!1;const e=yu(t);if(e===void 0)return!1;const n=tp(e);return ns(n)},_p=t=>typeof t=="string"&&ns(t),pp=()=>{const t=lu(null,new Uint8Array(16));return gu({documentId:t})},yu=t=>Qt.decodeUnsafe(t),zr=t=>Qt.encode(t),dt=t=>t.map(e=>Qt.encode(gp(e))),Ft=t=>t.map(e=>hu(Qt.decode(e))),yr=t=>{if(t instanceof Uint8Array)return zr(t);if(_u(t))return Wn(t).documentId;if(pu(t))return t;if(_p(t)){console.warn("Future versions will not support UUIDs as document IDs; use Automerge URLs instead.");const e=np(t);return zr(e)}throw new Error(`Invalid AutomergeUrl: '${t}'`)};let Ei;try{Ei=new TextDecoder}catch{}let ee,Jt,H=0;const yp=105,mp=57342,bp=57343,Ya=57337,Xa=6,pn={};let Pn=11281e4,mt=1681e4,fe={},ve,Vr,Wr=0,qn=0,Te,Ze,xe=[],ki=[],Le,Pe,$n,Za={useRecords:!1,mapsAsObjects:!0},Gn=!1,mu=2;try{new Function("")}catch{mu=1/0}class Jn{constructor(e){if(e&&((e.keyMap||e._keyMap)&&!e.useRecords&&(e.useRecords=!1,e.mapsAsObjects=!0),e.useRecords===!1&&e.mapsAsObjects===void 0&&(e.mapsAsObjects=!0),e.getStructures&&(e.getShared=e.getStructures),e.getShared&&!e.structures&&((e.structures=[]).uninitialized=!0),e.keyMap)){this.mapKey=new Map;for(let[n,r]of Object.entries(e.keyMap))this.mapKey.set(r,n)}Object.assign(this,e)}decodeKey(e){return this.keyMap&&this.mapKey.get(e)||e}encodeKey(e){return this.keyMap&&this.keyMap.hasOwnProperty(e)?this.keyMap[e]:e}encodeKeys(e){if(!this._keyMap)return e;let n=new Map;for(let[r,i]of Object.entries(e))n.set(this._keyMap.hasOwnProperty(r)?this._keyMap[r]:r,i);return n}decodeKeys(e){if(!this._keyMap||e.constructor.name!="Map")return e;if(!this._mapKey){this._mapKey=new Map;for(let[r,i]of Object.entries(this._keyMap))this._mapKey.set(i,r)}let n={};return e.forEach((r,i)=>n[Qe(this._mapKey.has(i)?this._mapKey.get(i):i)]=r),n}mapDecode(e,n){let r=this.decode(e);if(this._keyMap)switch(r.constructor.name){case"Array":return r.map(i=>this.decodeKeys(i))}return r}decode(e,n){if(ee)return Su(()=>(Ri(),this?this.decode(e,n):Jn.prototype.decode.call(Za,e,n)));Jt=n>-1?n:e.length,H=0,qn=0,Vr=null,Te=null,ee=e;try{Pe=e.dataView||(e.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength))}catch(r){throw ee=null,e instanceof Uint8Array?r:new Error("Source must be a Uint8Array or Buffer but was a "+(e&&typeof e=="object"?e.constructor.name:typeof e))}if(this instanceof Jn){if(fe=this,Le=this.sharedValues&&(this.pack?new Array(this.maxPrivatePackedValues||16).concat(this.sharedValues):this.sharedValues),this.structures)return ve=this.structures,mr();(!ve||ve.length>0)&&(ve=[])}else fe=Za,(!ve||ve.length>0)&&(ve=[]),Le=null;return mr()}decodeMultiple(e,n){let r,i=0;try{let o=e.length;Gn=!0;let c=this?this.decode(e,o):Qi.decode(e,o);if(n){if(n(c)===!1)return;for(;H<o;)if(i=H,n(mr())===!1)return}else{for(r=[c];H<o;)i=H,r.push(mr());return r}}catch(o){throw o.lastPosition=i,o.values=r,o}finally{Gn=!1,Ri()}}}function mr(){try{let t=he();if(Te){if(H>=Te.postBundlePosition){let e=new Error("Unexpected bundle position");throw e.incomplete=!0,e}H=Te.postBundlePosition,Te=null}if(H==Jt)ve=null,ee=null,Ze&&(Ze=null);else if(H>Jt){let e=new Error("Unexpected end of CBOR data");throw e.incomplete=!0,e}else if(!Gn)throw new Error("Data read, but end of buffer not reached");return t}catch(t){throw Ri(),(t instanceof RangeError||t.message.startsWith("Unexpected end of buffer"))&&(t.incomplete=!0),t}}function he(){let t=ee[H++],e=t>>5;if(t=t&31,t>23)switch(t){case 24:t=ee[H++];break;case 25:if(e==7)return xp();t=Pe.getUint16(H),H+=2;break;case 26:if(e==7){let n=Pe.getFloat32(H);if(fe.useFloat32>2){let r=Zi[(ee[H]&127)<<1|ee[H+1]>>7];return H+=4,(r*n+(n>0?.5:-.5)>>0)/r}return H+=4,n}t=Pe.getUint32(H),H+=4;break;case 27:if(e==7){let n=Pe.getFloat64(H);return H+=8,n}if(e>1){if(Pe.getUint32(H)>0)throw new Error("JavaScript does not support arrays, maps, or strings with length over 4294967295");t=Pe.getUint32(H+4)}else fe.int64AsNumber?(t=Pe.getUint32(H)*4294967296,t+=Pe.getUint32(H+4)):t=Pe.getBigUint64(H);H+=8;break;case 31:switch(e){case 2:case 3:throw new Error("Indefinite length not supported for byte or text strings");case 4:let n=[],r,i=0;for(;(r=he())!=pn;){if(i>=Pn)throw new Error(`Array length exceeds ${Pn}`);n[i++]=r}return e==4?n:e==3?n.join(""):Buffer.concat(n);case 5:let o;if(fe.mapsAsObjects){let c={},u=0;if(fe.keyMap)for(;(o=he())!=pn;){if(u++>=mt)throw new Error(`Property count exceeds ${mt}`);c[Qe(fe.decodeKey(o))]=he()}else for(;(o=he())!=pn;){if(u++>=mt)throw new Error(`Property count exceeds ${mt}`);c[Qe(o)]=he()}return c}else{$n&&(fe.mapsAsObjects=!0,$n=!1);let c=new Map;if(fe.keyMap){let u=0;for(;(o=he())!=pn;){if(u++>=mt)throw new Error(`Map size exceeds ${mt}`);c.set(fe.decodeKey(o),he())}}else{let u=0;for(;(o=he())!=pn;){if(u++>=mt)throw new Error(`Map size exceeds ${mt}`);c.set(o,he())}}return c}case 7:return pn;default:throw new Error("Invalid major type for indefinite length "+e)}default:throw new Error("Unknown token "+t)}switch(e){case 0:return t;case 1:return~t;case 2:return Sp(t);case 3:if(qn>=H)return Vr.slice(H-Wr,(H+=t)-Wr);if(qn==0&&Jt<140&&t<32){let i=t<16?bu(t):vp(t);if(i!=null)return i}return wp(t);case 4:if(t>=Pn)throw new Error(`Array length exceeds ${Pn}`);let n=new Array(t);for(let i=0;i<t;i++)n[i]=he();return n;case 5:if(t>=mt)throw new Error(`Map size exceeds ${Pn}`);if(fe.mapsAsObjects){let i={};if(fe.keyMap)for(let o=0;o<t;o++)i[Qe(fe.decodeKey(he()))]=he();else for(let o=0;o<t;o++)i[Qe(he())]=he();return i}else{$n&&(fe.mapsAsObjects=!0,$n=!1);let i=new Map;if(fe.keyMap)for(let o=0;o<t;o++)i.set(fe.decodeKey(he()),he());else for(let o=0;o<t;o++)i.set(he(),he());return i}case 6:if(t>=Ya){let i=ve[t&8191];if(i)return i.read||(i.read=Ci(i)),i.read();if(t<65536){if(t==bp){let o=Sn(),c=he(),u=he();Oi(c,u);let f={};if(fe.keyMap)for(let d=2;d<o;d++){let _=fe.decodeKey(u[d-2]);f[Qe(_)]=he()}else for(let d=2;d<o;d++){let _=u[d-2];f[Qe(_)]=he()}return f}else if(t==mp){let o=Sn(),c=he();for(let u=2;u<o;u++)Oi(c++,he());return he()}else if(t==Ya)return Tp();if(fe.getShared&&(Xi(),i=ve[t&8191],i))return i.read||(i.read=Ci(i)),i.read()}}let r=xe[t];if(r)return r.handlesRead?r(he):r(he());{let i=he();for(let o=0;o<ki.length;o++){let c=ki[o](t,i);if(c!==void 0)return c}return new Yt(i,t)}case 7:switch(t){case 20:return!1;case 21:return!0;case 22:return null;case 23:return;case 31:default:let i=(Le||Nt())[t];if(i!==void 0)return i;throw new Error("Unknown token "+t)}default:if(isNaN(t)){let i=new Error("Unexpected end of CBOR data");throw i.incomplete=!0,i}throw new Error("Unknown CBOR token "+t)}}const Qa=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function Ci(t){if(!t)throw new Error("Structure is required in record definition");function e(){let n=ee[H++];if(n=n&31,n>23)switch(n){case 24:n=ee[H++];break;case 25:n=Pe.getUint16(H),H+=2;break;case 26:n=Pe.getUint32(H),H+=4;break;default:throw new Error("Expected array header, but got "+ee[H-1])}let r=this.compiledReader;for(;r;){if(r.propertyCount===n)return r(he);r=r.next}if(this.slowReads++>=mu){let o=this.length==n?this:this.slice(0,n);return r=fe.keyMap?new Function("r","return {"+o.map(c=>fe.decodeKey(c)).map(c=>Qa.test(c)?Qe(c)+":r()":"["+JSON.stringify(c)+"]:r()").join(",")+"}"):new Function("r","return {"+o.map(c=>Qa.test(c)?Qe(c)+":r()":"["+JSON.stringify(c)+"]:r()").join(",")+"}"),this.compiledReader&&(r.next=this.compiledReader),r.propertyCount=n,this.compiledReader=r,r(he)}let i={};if(fe.keyMap)for(let o=0;o<n;o++)i[Qe(fe.decodeKey(this[o]))]=he();else for(let o=0;o<n;o++)i[Qe(this[o])]=he();return i}return t.slowReads=0,e}function Qe(t){if(typeof t=="string")return t==="__proto__"?"__proto_":t;if(typeof t=="number"||typeof t=="boolean"||typeof t=="bigint")return t.toString();if(t==null)return t+"";throw new Error("Invalid property name type "+typeof t)}let wp=Ti;function Ti(t){let e;if(t<16&&(e=bu(t)))return e;if(t>64&&Ei)return Ei.decode(ee.subarray(H,H+=t));const n=H+t,r=[];for(e="";H<n;){const i=ee[H++];if((i&128)===0)r.push(i);else if((i&224)===192){const o=ee[H++]&63;r.push((i&31)<<6|o)}else if((i&240)===224){const o=ee[H++]&63,c=ee[H++]&63;r.push((i&31)<<12|o<<6|c)}else if((i&248)===240){const o=ee[H++]&63,c=ee[H++]&63,u=ee[H++]&63;let f=(i&7)<<18|o<<12|c<<6|u;f>65535&&(f-=65536,r.push(f>>>10&1023|55296),f=56320|f&1023),r.push(f)}else r.push(i);r.length>=4096&&(e+=Me.apply(String,r),r.length=0)}return r.length>0&&(e+=Me.apply(String,r)),e}let Me=String.fromCharCode;function vp(t){let e=H,n=new Array(t);for(let r=0;r<t;r++){const i=ee[H++];if((i&128)>0){H=e;return}n[r]=i}return Me.apply(String,n)}function bu(t){if(t<4)if(t<2){if(t===0)return"";{let e=ee[H++];if((e&128)>1){H-=1;return}return Me(e)}}else{let e=ee[H++],n=ee[H++];if((e&128)>0||(n&128)>0){H-=2;return}if(t<3)return Me(e,n);let r=ee[H++];if((r&128)>0){H-=3;return}return Me(e,n,r)}else{let e=ee[H++],n=ee[H++],r=ee[H++],i=ee[H++];if((e&128)>0||(n&128)>0||(r&128)>0||(i&128)>0){H-=4;return}if(t<6){if(t===4)return Me(e,n,r,i);{let o=ee[H++];if((o&128)>0){H-=5;return}return Me(e,n,r,i,o)}}else if(t<8){let o=ee[H++],c=ee[H++];if((o&128)>0||(c&128)>0){H-=6;return}if(t<7)return Me(e,n,r,i,o,c);let u=ee[H++];if((u&128)>0){H-=7;return}return Me(e,n,r,i,o,c,u)}else{let o=ee[H++],c=ee[H++],u=ee[H++],f=ee[H++];if((o&128)>0||(c&128)>0||(u&128)>0||(f&128)>0){H-=8;return}if(t<10){if(t===8)return Me(e,n,r,i,o,c,u,f);{let d=ee[H++];if((d&128)>0){H-=9;return}return Me(e,n,r,i,o,c,u,f,d)}}else if(t<12){let d=ee[H++],_=ee[H++];if((d&128)>0||(_&128)>0){H-=10;return}if(t<11)return Me(e,n,r,i,o,c,u,f,d,_);let h=ee[H++];if((h&128)>0){H-=11;return}return Me(e,n,r,i,o,c,u,f,d,_,h)}else{let d=ee[H++],_=ee[H++],h=ee[H++],g=ee[H++];if((d&128)>0||(_&128)>0||(h&128)>0||(g&128)>0){H-=12;return}if(t<14){if(t===12)return Me(e,n,r,i,o,c,u,f,d,_,h,g);{let p=ee[H++];if((p&128)>0){H-=13;return}return Me(e,n,r,i,o,c,u,f,d,_,h,g,p)}}else{let p=ee[H++],m=ee[H++];if((p&128)>0||(m&128)>0){H-=14;return}if(t<15)return Me(e,n,r,i,o,c,u,f,d,_,h,g,p,m);let v=ee[H++];if((v&128)>0){H-=15;return}return Me(e,n,r,i,o,c,u,f,d,_,h,g,p,m,v)}}}}}function Sp(t){return fe.copyBuffers?Uint8Array.prototype.slice.call(ee,H,H+=t):ee.subarray(H,H+=t)}let wu=new Float32Array(1),br=new Uint8Array(wu.buffer,0,4);function xp(){let t=ee[H++],e=ee[H++],n=(t&127)>>2;if(n===31)return e||t&3?NaN:t&128?-1/0:1/0;if(n===0){let r=((t&3)<<8|e)/16777216;return t&128?-r:r}return br[3]=t&128|(n>>1)+56,br[2]=(t&7)<<5|e>>3,br[1]=e<<5,br[0]=0,wu[0]}new Array(4096);class Yt{constructor(e,n){this.value=e,this.tag=n}}xe[0]=t=>new Date(t);xe[1]=t=>new Date(Math.round(t*1e3));xe[2]=t=>{let e=BigInt(0);for(let n=0,r=t.byteLength;n<r;n++)e=BigInt(t[n])+(e<<BigInt(8));return e};xe[3]=t=>BigInt(-1)-xe[2](t);xe[4]=t=>+(t[1]+"e"+t[0]);xe[5]=t=>t[1]*Math.exp(t[0]*Math.log(2));const Oi=(t,e)=>{t=t-57344;let n=ve[t];n&&n.isShared&&((ve.restoreStructures||(ve.restoreStructures=[]))[t]=n),ve[t]=e,e.read=Ci(e)};xe[yp]=t=>{let e=t.length,n=t[1];Oi(t[0],n);let r={};for(let i=2;i<e;i++){let o=n[i-2];r[Qe(o)]=t[i]}return r};xe[14]=t=>Te?Te[0].slice(Te.position0,Te.position0+=t):new Yt(t,14);xe[15]=t=>Te?Te[1].slice(Te.position1,Te.position1+=t):new Yt(t,15);let Ap={Error,RegExp};xe[27]=t=>(Ap[t[0]]||Error)(t[1],t[2]);const vu=t=>{if(ee[H++]!=132){let n=new Error("Packed values structure must be followed by a 4 element array");throw ee.length<H&&(n.incomplete=!0),n}let e=t();if(!e||!e.length){let n=new Error("Packed values structure must be followed by a 4 element array");throw n.incomplete=!0,n}return Le=Le?e.concat(Le.slice(e.length)):e,Le.prefixes=t(),Le.suffixes=t(),t()};vu.handlesRead=!0;xe[51]=vu;xe[Xa]=t=>{if(!Le)if(fe.getShared)Xi();else return new Yt(t,Xa);if(typeof t=="number")return Le[16+(t>=0?2*t:-2*t-1)];let e=new Error("No support for non-integer packed references yet");throw t===void 0&&(e.incomplete=!0),e};xe[28]=t=>{Ze||(Ze=new Map,Ze.id=0);let e=Ze.id++,n=H,r=ee[H],i;r>>5==4?i=[]:i={};let o={target:i};Ze.set(e,o);let c=t();return o.used?(Object.getPrototypeOf(i)!==Object.getPrototypeOf(c)&&(H=n,i=c,Ze.set(e,{target:i}),c=t()),Object.assign(i,c)):(o.target=c,c)};xe[28].handlesRead=!0;xe[29]=t=>{let e=Ze.get(t);return e.used=!0,e.target};xe[258]=t=>new Set(t);(xe[259]=t=>(fe.mapsAsObjects&&(fe.mapsAsObjects=!1,$n=!0),t())).handlesRead=!0;function yn(t,e){return typeof t=="string"?t+e:t instanceof Array?t.concat(e):Object.assign({},t,e)}function Nt(){if(!Le)if(fe.getShared)Xi();else throw new Error("No packed values available");return Le}const Ip=1399353956;ki.push((t,e)=>{if(t>=225&&t<=255)return yn(Nt().prefixes[t-224],e);if(t>=28704&&t<=32767)return yn(Nt().prefixes[t-28672],e);if(t>=1879052288&&t<=2147483647)return yn(Nt().prefixes[t-1879048192],e);if(t>=216&&t<=223)return yn(e,Nt().suffixes[t-216]);if(t>=27647&&t<=28671)return yn(e,Nt().suffixes[t-27639]);if(t>=1811940352&&t<=1879048191)return yn(e,Nt().suffixes[t-1811939328]);if(t==Ip)return{packedValues:Le,structures:ve.slice(0),version:e};if(t==55799)return e});const Ep=new Uint8Array(new Uint16Array([1]).buffer)[0]==1,ec=[Uint8Array,Uint8ClampedArray,Uint16Array,Uint32Array,typeof BigUint64Array>"u"?{name:"BigUint64Array"}:BigUint64Array,Int8Array,Int16Array,Int32Array,typeof BigInt64Array>"u"?{name:"BigInt64Array"}:BigInt64Array,Float32Array,Float64Array],kp=[64,68,69,70,71,72,77,78,79,85,86];for(let t=0;t<ec.length;t++)Cp(ec[t],kp[t]);function Cp(t,e){let n="get"+t.name.slice(0,-5),r;typeof t=="function"?r=t.BYTES_PER_ELEMENT:t=null;for(let i=0;i<2;i++){if(!i&&r==1)continue;let o=r==2?1:r==4?2:r==8?3:0;xe[i?e:e-4]=r==1||i==Ep?c=>{if(!t)throw new Error("Could not find typed array for code "+e);return!fe.copyBuffers&&(r===1||r===2&&!(c.byteOffset&1)||r===4&&!(c.byteOffset&3)||r===8&&!(c.byteOffset&7))?new t(c.buffer,c.byteOffset,c.byteLength>>o):new t(Uint8Array.prototype.slice.call(c,0).buffer)}:c=>{if(!t)throw new Error("Could not find typed array for code "+e);let u=new DataView(c.buffer,c.byteOffset,c.byteLength),f=c.length>>o,d=new t(f),_=u[n];for(let h=0;h<f;h++)d[h]=_.call(u,h<<o,i);return d}}}function Tp(){let t=Sn(),e=H+he();for(let r=2;r<t;r++){let i=Sn();H+=i}let n=H;return H=e,Te=[Ti(Sn()),Ti(Sn())],Te.position0=0,Te.position1=0,Te.postBundlePosition=H,H=n,he()}function Sn(){let t=ee[H++]&31;if(t>23)switch(t){case 24:t=ee[H++];break;case 25:t=Pe.getUint16(H),H+=2;break;case 26:t=Pe.getUint32(H),H+=4;break}return t}function Xi(){if(fe.getShared){let t=Su(()=>(ee=null,fe.getShared()))||{},e=t.structures||[];fe.sharedVersion=t.version,Le=fe.sharedValues=t.packedValues,ve===!0?fe.structures=ve=e:ve.splice.apply(ve,[0,e.length].concat(e))}}function Su(t){let e=Jt,n=H,r=Wr,i=qn,o=Vr,c=Ze,u=Te,f=new Uint8Array(ee.slice(0,Jt)),d=ve,_=fe,h=Gn,g=t();return Jt=e,H=n,Wr=r,qn=i,Vr=o,Ze=c,Te=u,ee=f,Gn=h,ve=d,fe=_,Pe=new DataView(ee.buffer,ee.byteOffset,ee.byteLength),g}function Ri(){ee=null,Ze=null,ve=null}const Zi=new Array(147);for(let t=0;t<256;t++)Zi[t]=+("1e"+Math.floor(45.15-t*.30103));let Qi=new Jn({useRecords:!1});const xu=Qi.decode;Qi.decodeMultiple;let Er;try{Er=new TextEncoder}catch{}let Mi,Au;const rs=typeof globalThis=="object"&&globalThis.Buffer,Qn=typeof rs<"u",ci=Qn?rs.allocUnsafeSlow:Uint8Array,tc=Qn?rs:Uint8Array,nc=256,rc=Qn?4294967296:2144337920;let ui,T,be,x=0,Ot,ke=null;const Op=61440,Rp=/[\u0080-\uFFFF]/,Ve=Symbol("record-id");class Iu extends Jn{constructor(e){super(e),this.offset=0;let n,r,i,o,c;e=e||{};let u=tc.prototype.utf8Write?function(S,W,P){return T.utf8Write(S,W,P)}:Er&&Er.encodeInto?function(S,W){return Er.encodeInto(S,T.subarray(W)).written}:!1,f=this,d=e.structures||e.saveStructures,_=e.maxSharedStructures;if(_==null&&(_=d?128:0),_>8190)throw new Error("Maximum maxSharedStructure is 8190");let h=e.sequential;h&&(_=0),this.structures||(this.structures=[]),this.saveStructures&&(this.saveShared=this.saveStructures);let g,p,m=e.sharedValues,v;if(m){v=Object.create(null);for(let S=0,W=m.length;S<W;S++)v[m[S]]=S}let I=[],$=0,D=0;this.mapEncode=function(S,W){if(this._keyMap&&!this._mapped)switch(S.constructor.name){case"Array":S=S.map(P=>this.encodeKeys(P));break}return this.encode(S,W)},this.encode=function(S,W){if(T||(T=new ci(8192),be=new DataView(T.buffer,0,8192),x=0),Ot=T.length-10,Ot-x<2048?(T=new ci(T.length),be=new DataView(T.buffer,0,T.length),Ot=T.length-10,x=0):W===oc&&(x=x+7&2147483640),n=x,f.useSelfDescribedHeader&&(be.setUint32(x,3654940416),x+=3),c=f.structuredClone?new Map:null,f.bundleStrings&&typeof S!="string"?(ke=[],ke.size=1/0):ke=null,r=f.structures,r){if(r.uninitialized){let B=f.getShared()||{};f.structures=r=B.structures||[],f.sharedVersion=B.version;let U=f.sharedValues=B.packedValues;if(U){v={};for(let Q=0,C=U.length;Q<C;Q++)v[U[Q]]=Q}}let P=r.length;if(P>_&&!h&&(P=_),!r.transitions){r.transitions=Object.create(null);for(let B=0;B<P;B++){let U=r[B];if(!U)continue;let Q,C=r.transitions;for(let N=0,w=U.length;N<w;N++){C[Ve]===void 0&&(C[Ve]=B);let R=U[N];Q=C[R],Q||(Q=C[R]=Object.create(null)),C=Q}C[Ve]=B|1048576}}h||(r.nextId=P)}if(i&&(i=!1),o=r||[],p=v,e.pack){let P=new Map;if(P.values=[],P.encoder=f,P.maxValues=e.maxPrivatePackedValues||(v?16:1/0),P.objectMap=v||!1,P.samplingPackedValues=g,kr(S,P),P.values.length>0){T[x++]=216,T[x++]=51,ct(4);let B=P.values;k(B),ct(0),ct(0),p=Object.create(v||null);for(let U=0,Q=B.length;U<Q;U++)p[B[U]]=U}}ui=W&li;try{if(ui)return;if(k(S),ke&&ic(n,k),f.offset=x,c&&c.idsToInsert){x+=c.idsToInsert.length*2,x>Ot&&z(x),f.offset=x;let P=Dp(T.subarray(n,x),c.idsToInsert);return c=null,P}return W&oc?(T.start=n,T.end=x,T):T.subarray(n,x)}finally{if(r){if(D<10&&D++,r.length>_&&(r.length=_),$>1e4)r.transitions=null,D=0,$=0,I.length>0&&(I=[]);else if(I.length>0&&!h){for(let P=0,B=I.length;P<B;P++)I[P][Ve]=void 0;I=[]}}if(i&&f.saveShared){f.structures.length>_&&(f.structures=f.structures.slice(0,_));let P=T.subarray(n,x);return f.updateSharedData()===!1?f.encode(S):P}W&Up&&(x=n)}},this.findCommonStringsToPack=()=>(g=new Map,v||(v=Object.create(null)),S=>{let W=S&&S.threshold||4,P=this.pack?S.maxPrivatePackedValues||16:0;m||(m=this.sharedValues=[]);for(let[B,U]of g)U.count>W&&(v[B]=P++,m.push(B),i=!0);for(;this.saveShared&&this.updateSharedData()===!1;);g=null});const k=S=>{x>Ot&&(T=z(x));var W=typeof S,P;if(W==="string"){if(p){let C=p[S];if(C>=0){C<16?T[x++]=C+224:(T[x++]=198,C&1?k(15-C>>1):k(C-16>>1));return}else if(g&&!e.pack){let N=g.get(S);N?N.count++:g.set(S,{count:1})}}let B=S.length;if(ke&&B>=4&&B<1024){if((ke.size+=B)>Op){let N,w=(ke[0]?ke[0].length*3+ke[1].length:0)+10;x+w>Ot&&(T=z(x+w)),T[x++]=217,T[x++]=223,T[x++]=249,T[x++]=ke.position?132:130,T[x++]=26,N=x-n,x+=4,ke.position&&ic(n,k),ke=["",""],ke.size=0,ke.position=N}let C=Rp.test(S);ke[C?0:1]+=S,T[x++]=C?206:207,k(B);return}let U;B<32?U=1:B<256?U=2:B<65536?U=3:U=5;let Q=B*3;if(x+Q>Ot&&(T=z(x+Q)),B<64||!u){let C,N,w,R=x+U;for(C=0;C<B;C++)N=S.charCodeAt(C),N<128?T[R++]=N:N<2048?(T[R++]=N>>6|192,T[R++]=N&63|128):(N&64512)===55296&&((w=S.charCodeAt(C+1))&64512)===56320?(N=65536+((N&1023)<<10)+(w&1023),C++,T[R++]=N>>18|240,T[R++]=N>>12&63|128,T[R++]=N>>6&63|128,T[R++]=N&63|128):(T[R++]=N>>12|224,T[R++]=N>>6&63|128,T[R++]=N&63|128);P=R-x-U}else P=u(S,x+U,Q);P<24?T[x++]=96|P:P<256?(U<2&&T.copyWithin(x+2,x+1,x+1+P),T[x++]=120,T[x++]=P):P<65536?(U<3&&T.copyWithin(x+3,x+2,x+2+P),T[x++]=121,T[x++]=P>>8,T[x++]=P&255):(U<5&&T.copyWithin(x+5,x+3,x+3+P),T[x++]=122,be.setUint32(x,P),x+=4),x+=P}else if(W==="number")if(!this.alwaysUseFloat&&S>>>0===S)S<24?T[x++]=S:S<256?(T[x++]=24,T[x++]=S):S<65536?(T[x++]=25,T[x++]=S>>8,T[x++]=S&255):(T[x++]=26,be.setUint32(x,S),x+=4);else if(!this.alwaysUseFloat&&S>>0===S)S>=-24?T[x++]=31-S:S>=-256?(T[x++]=56,T[x++]=~S):S>=-65536?(T[x++]=57,be.setUint16(x,~S),x+=2):(T[x++]=58,be.setUint32(x,~S),x+=4);else{let B;if((B=this.useFloat32)>0&&S<4294967296&&S>=-2147483648){T[x++]=250,be.setFloat32(x,S);let U;if(B<4||(U=S*Zi[(T[x]&127)<<1|T[x+1]>>7])>>0===U){x+=4;return}else x--}T[x++]=251,be.setFloat64(x,S),x+=8}else if(W==="object")if(!S)T[x++]=246;else{if(c){let U=c.get(S);if(U){if(T[x++]=216,T[x++]=29,T[x++]=25,!U.references){let Q=c.idsToInsert||(c.idsToInsert=[]);U.references=[],Q.push(U)}U.references.push(x-n),x+=2;return}else c.set(S,{offset:x-n})}let B=S.constructor;if(B===Object)Y(S);else if(B===Array){P=S.length,P<24?T[x++]=128|P:ct(P);for(let U=0;U<P;U++)k(S[U])}else if(B===Map)if((this.mapsAsObjects?this.useTag259ForMaps!==!1:this.useTag259ForMaps)&&(T[x++]=217,T[x++]=1,T[x++]=3),P=S.size,P<24?T[x++]=160|P:P<256?(T[x++]=184,T[x++]=P):P<65536?(T[x++]=185,T[x++]=P>>8,T[x++]=P&255):(T[x++]=186,be.setUint32(x,P),x+=4),f.keyMap)for(let[U,Q]of S)k(f.encodeKey(U)),k(Q);else for(let[U,Q]of S)k(U),k(Q);else{for(let U=0,Q=Mi.length;U<Q;U++){let C=Au[U];if(S instanceof C){let N=Mi[U],w=N.tag;w==null&&(w=N.getTag&&N.getTag.call(this,S)),w<24?T[x++]=192|w:w<256?(T[x++]=216,T[x++]=w):w<65536?(T[x++]=217,T[x++]=w>>8,T[x++]=w&255):w>-1&&(T[x++]=218,be.setUint32(x,w),x+=4),N.encode.call(this,S,k,z);return}}if(S[Symbol.iterator]){if(ui){let U=new Error("Iterable should be serialized as iterator");throw U.iteratorNotHandled=!0,U}T[x++]=159;for(let U of S)k(U);T[x++]=255;return}if(S[Symbol.asyncIterator]||fi(S)){let U=new Error("Iterable/blob should be serialized as iterator");throw U.iteratorNotHandled=!0,U}if(this.useToJSON&&S.toJSON){const U=S.toJSON();if(U!==S)return k(U)}Y(S)}}else if(W==="boolean")T[x++]=S?245:244;else if(W==="bigint"){if(S<BigInt(1)<<BigInt(64)&&S>=0)T[x++]=27,be.setBigUint64(x,S);else if(S>-(BigInt(1)<<BigInt(64))&&S<0)T[x++]=59,be.setBigUint64(x,-S-BigInt(1));else if(this.largeBigIntToFloat)T[x++]=251,be.setFloat64(x,Number(S));else{S>=BigInt(0)?T[x++]=194:(T[x++]=195,S=BigInt(-1)-S);let B=[];for(;S;)B.push(Number(S&BigInt(255))),S>>=BigInt(8);ji(new Uint8Array(B.reverse()),z);return}x+=8}else if(W==="undefined")T[x++]=247;else throw new Error("Unknown type: "+W)},Y=this.useRecords===!1?this.variableMapSize?S=>{let W=Object.keys(S),P=Object.values(S),B=W.length;if(B<24?T[x++]=160|B:B<256?(T[x++]=184,T[x++]=B):B<65536?(T[x++]=185,T[x++]=B>>8,T[x++]=B&255):(T[x++]=186,be.setUint32(x,B),x+=4),f.keyMap)for(let U=0;U<B;U++)k(f.encodeKey(W[U])),k(P[U]);else for(let U=0;U<B;U++)k(W[U]),k(P[U])}:S=>{T[x++]=185;let W=x-n;x+=2;let P=0;if(f.keyMap)for(let B in S)(typeof S.hasOwnProperty!="function"||S.hasOwnProperty(B))&&(k(f.encodeKey(B)),k(S[B]),P++);else for(let B in S)(typeof S.hasOwnProperty!="function"||S.hasOwnProperty(B))&&(k(B),k(S[B]),P++);T[W+++n]=P>>8,T[W+n]=P&255}:(S,W)=>{let P,B=o.transitions||(o.transitions=Object.create(null)),U=0,Q=0,C,N;if(this.keyMap){N=Object.keys(S).map(R=>this.encodeKey(R)),Q=N.length;for(let R=0;R<Q;R++){let q=N[R];P=B[q],P||(P=B[q]=Object.create(null),U++),B=P}}else for(let R in S)(typeof S.hasOwnProperty!="function"||S.hasOwnProperty(R))&&(P=B[R],P||(B[Ve]&1048576&&(C=B[Ve]&65535),P=B[R]=Object.create(null),U++),B=P,Q++);let w=B[Ve];if(w!==void 0)w&=65535,T[x++]=217,T[x++]=w>>8|224,T[x++]=w&255;else if(N||(N=B.__keys__||(B.__keys__=Object.keys(S))),C===void 0?(w=o.nextId++,w||(w=0,o.nextId=1),w>=nc&&(o.nextId=(w=_)+1)):w=C,o[w]=N,w<_){T[x++]=217,T[x++]=w>>8|224,T[x++]=w&255,B=o.transitions;for(let R=0;R<Q;R++)(B[Ve]===void 0||B[Ve]&1048576)&&(B[Ve]=w),B=B[N[R]];B[Ve]=w|1048576,i=!0}else{if(B[Ve]=w,be.setUint32(x,3655335680),x+=3,U&&($+=D*U),I.length>=nc-_&&(I.shift()[Ve]=void 0),I.push(B),ct(Q+2),k(57344+w),k(N),W)return;for(let R in S)(typeof S.hasOwnProperty!="function"||S.hasOwnProperty(R))&&k(S[R]);return}if(Q<24?T[x++]=128|Q:ct(Q),!W)for(let R in S)(typeof S.hasOwnProperty!="function"||S.hasOwnProperty(R))&&k(S[R])},z=S=>{let W;if(S>16777216){if(S-n>rc)throw new Error("Encoded buffer would be larger than maximum buffer size");W=Math.min(rc,Math.round(Math.max((S-n)*(S>67108864?1.25:2),4194304)/4096)*4096)}else W=(Math.max(S-n<<2,T.length-1)>>12)+1<<12;let P=new ci(W);return be=new DataView(P.buffer,0,W),T.copy?T.copy(P,0,n,S):P.set(T.slice(n,S)),x-=n,n=0,Ot=P.length-10,T=P};let J=100,te=1e3;this.encodeAsIterable=function(S,W){return K(S,W,Z)},this.encodeAsAsyncIterable=function(S,W){return K(S,W,se)};function*Z(S,W,P){let B=S.constructor;if(B===Object){let U=f.useRecords!==!1;U?Y(S,!0):sc(Object.keys(S).length,160);for(let Q in S){let C=S[Q];U||k(Q),C&&typeof C=="object"?W[Q]?yield*Z(C,W[Q]):yield*F(C,W,Q):k(C)}}else if(B===Array){let U=S.length;ct(U);for(let Q=0;Q<U;Q++){let C=S[Q];C&&(typeof C=="object"||x-n>J)?W.element?yield*Z(C,W.element):yield*F(C,W,"element"):k(C)}}else if(S[Symbol.iterator]&&!S.buffer){T[x++]=159;for(let U of S)U&&(typeof U=="object"||x-n>J)?W.element?yield*Z(U,W.element):yield*F(U,W,"element"):k(U);T[x++]=255}else fi(S)?(sc(S.size,64),yield T.subarray(n,x),yield S,V()):S[Symbol.asyncIterator]?(T[x++]=159,yield T.subarray(n,x),yield S,V(),T[x++]=255):k(S);P&&x>n?yield T.subarray(n,x):x-n>J&&(yield T.subarray(n,x),V())}function*F(S,W,P){let B=x-n;try{k(S),x-n>J&&(yield T.subarray(n,x),V())}catch(U){if(U.iteratorNotHandled)W[P]={},x=n+B,yield*Z.call(this,S,W[P]);else throw U}}function V(){J=te,f.encode(null,li)}function K(S,W,P){return W&&W.chunkThreshold?J=te=W.chunkThreshold:J=100,S&&typeof S=="object"?(f.encode(null,li),P(S,f.iterateProperties||(f.iterateProperties={}),!0)):[f.encode(S)]}async function*se(S,W){for(let P of Z(S,W,!0)){let B=P.constructor;if(B===tc||B===Uint8Array)yield P;else if(fi(P)){let U=P.stream().getReader(),Q;for(;!(Q=await U.read()).done;)yield Q.value}else if(P[Symbol.asyncIterator])for await(let U of P)V(),U?yield*se(U,W.async||(W.async={})):yield f.encode(U);else yield P}}}useBuffer(e){T=e,be=new DataView(T.buffer,T.byteOffset,T.byteLength),x=0}clearSharedData(){this.structures&&(this.structures=[]),this.sharedValues&&(this.sharedValues=void 0)}updateSharedData(){let e=this.sharedVersion||0;this.sharedVersion=e+1;let n=this.structures.slice(0),r=new Eu(n,this.sharedValues,this.sharedVersion),i=this.saveShared(r,o=>(o&&o.version||0)==e);return i===!1?(r=this.getShared()||{},this.structures=r.structures||[],this.sharedValues=r.packedValues,this.sharedVersion=r.version,this.structures.nextId=this.structures.length):n.forEach((o,c)=>this.structures[c]=o),i}}function sc(t,e){t<24?T[x++]=e|t:t<256?(T[x++]=e|24,T[x++]=t):t<65536?(T[x++]=e|25,T[x++]=t>>8,T[x++]=t&255):(T[x++]=e|26,be.setUint32(x,t),x+=4)}class Eu{constructor(e,n,r){this.structures=e,this.packedValues=n,this.version=r}}function ct(t){t<24?T[x++]=128|t:t<256?(T[x++]=152,T[x++]=t):t<65536?(T[x++]=153,T[x++]=t>>8,T[x++]=t&255):(T[x++]=154,be.setUint32(x,t),x+=4)}const Mp=typeof Blob>"u"?function(){}:Blob;function fi(t){if(t instanceof Mp)return!0;let e=t[Symbol.toStringTag];return e==="Blob"||e==="File"}function kr(t,e){switch(typeof t){case"string":if(t.length>3){if(e.objectMap[t]>-1||e.values.length>=e.maxValues)return;let r=e.get(t);if(r)++r.count==2&&e.values.push(t);else if(e.set(t,{count:1}),e.samplingPackedValues){let i=e.samplingPackedValues.get(t);i?i.count++:e.samplingPackedValues.set(t,{count:1})}}break;case"object":if(t)if(t instanceof Array)for(let r=0,i=t.length;r<i;r++)kr(t[r],e);else{let r=!e.encoder.useRecords;for(var n in t)t.hasOwnProperty(n)&&(r&&kr(n,e),kr(t[n],e))}break;case"function":console.log(t)}}const jp=new Uint8Array(new Uint16Array([1]).buffer)[0]==1;Au=[Date,Set,Error,RegExp,Yt,ArrayBuffer,Uint8Array,Uint8ClampedArray,Uint16Array,Uint32Array,typeof BigUint64Array>"u"?function(){}:BigUint64Array,Int8Array,Int16Array,Int32Array,typeof BigInt64Array>"u"?function(){}:BigInt64Array,Float32Array,Float64Array,Eu];Mi=[{tag:1,encode(t,e){let n=t.getTime()/1e3;(this.useTimestamp32||t.getMilliseconds()===0)&&n>=0&&n<4294967296?(T[x++]=26,be.setUint32(x,n),x+=4):(T[x++]=251,be.setFloat64(x,n),x+=8)}},{tag:258,encode(t,e){let n=Array.from(t);e(n)}},{tag:27,encode(t,e){e([t.name,t.message])}},{tag:27,encode(t,e){e(["RegExp",t.source,t.flags])}},{getTag(t){return t.tag},encode(t,e){e(t.value)}},{encode(t,e,n){ji(t,n)}},{getTag(t){if(t.constructor===Uint8Array&&(this.tagUint8Array||Qn&&this.tagUint8Array!==!1))return 64},encode(t,e,n){ji(t,n)}},at(68,1),at(69,2),at(70,4),at(71,8),at(72,1),at(77,2),at(78,4),at(79,8),at(85,4),at(86,8),{encode(t,e){let n=t.packedValues||[],r=t.structures||[];if(n.values.length>0){T[x++]=216,T[x++]=51,ct(4);let i=n.values;e(i),ct(0),ct(0),packedObjectMap=Object.create(sharedPackedObjectMap||null);for(let o=0,c=i.length;o<c;o++)packedObjectMap[i[o]]=o}if(r){be.setUint32(x,3655335424),x+=3;let i=r.slice(0);i.unshift(57344),i.push(new Yt(t.version,1399353956)),e(i)}else e(new Yt(t.version,1399353956))}}];function at(t,e){return!jp&&e>1&&(t-=4),{tag:t,encode:function(r,i){let o=r.byteLength,c=r.byteOffset||0,u=r.buffer||r;i(Qn?rs.from(u,c,o):new Uint8Array(u,c,o))}}}function ji(t,e){let n=t.byteLength;n<24?T[x++]=64+n:n<256?(T[x++]=88,T[x++]=n):n<65536?(T[x++]=89,T[x++]=n>>8,T[x++]=n&255):(T[x++]=90,be.setUint32(x,n),x+=4),x+n>=T.length&&e(x+n),T.set(t.buffer?t:new Uint8Array(t),x),x+=n}function Dp(t,e){let n,r=e.length*2,i=t.length-r;e.sort((o,c)=>o.offset>c.offset?1:-1);for(let o=0;o<e.length;o++){let c=e[o];c.id=o;for(let u of c.references)t[u++]=o>>8,t[u]=o&255}for(;n=e.pop();){let o=n.offset;t.copyWithin(o+r,o,i),r-=2;let c=o+r;t[c++]=216,t[c++]=28,i=o}return t}function ic(t,e){be.setUint32(ke.position+t,x-ke.position-t+1);let n=ke;ke=null,e(n[0]),e(n[1])}let eo=new Iu({useRecords:!1});eo.encode;eo.encodeAsIterable;eo.encodeAsAsyncIterable;const oc=512,Up=1024,li=2048;function ku(t){return new Iu({tagUint8Array:!1,useRecords:!1}).encode(t)}function Pp(t){return xu(t)}const Hp=(t,e)=>t.length===e.length&&t.every((n,r)=>n===e[r]),to=(t,e)=>Hp(t,e),$p=async(t,e)=>{let n;const r=new Promise((i,o)=>{n=setTimeout(()=>o(new Bp(`withTimeout: timed out after ${e}ms`)),e)});try{return await Promise.race([t,r])}finally{clearTimeout(n)}};class Bp extends Error{constructor(e){super(e),this.name="TimeoutError"}}class qr extends Zt{documentId;#e;#t;#r;#n=vt();#s=6e4;#i={};#c=new Map;constructor(e,n={}){super(),this.documentId=e,"timeoutDelay"in n&&n.timeoutDelay&&(this.#s=n.timeoutDelay),"heads"in n&&(this.#r=n.heads);const r=vt();this.#e=gt(`automerge-repo:dochandle:${this.documentId.slice(0,5)}`);const i=this.#s,o=K_({actions:{onUpdate:Hn(({context:c,event:u})=>{const f=c.doc;G_(u,cc);const{callback:d}=u.payload;return{doc:d(f)}}),onDelete:Hn(()=>(this.emit("delete",{handle:this}),{doc:vt()})),onUnavailable:Hn(()=>({doc:vt()})),onUnload:Hn(()=>({doc:vt()}))}}).createMachine({initial:"idle",context:{documentId:e,doc:r},on:{UPDATE:{actions:"onUpdate"},UNLOAD:".unloaded",DELETE:".deleted"},states:{idle:{on:{BEGIN:"loading"}},loading:{on:{REQUEST:"requesting",DOC_READY:"ready"},after:{[i]:"unavailable"}},requesting:{on:{DOC_UNAVAILABLE:"unavailable",DOC_READY:"ready"},after:{[i]:"unavailable"}},unavailable:{entry:"onUnavailable",on:{DOC_READY:"ready"}},ready:{},unloaded:{entry:"onUnload",on:{RELOAD:"loading"}},deleted:{entry:"onDelete",type:"final"}}});this.#t=Vn(o),this.#t.subscribe(c=>{const u=this.#n,f=c.context.doc;this.#e(`→ ${c.value} %o`,f),this.#u(u,f)}),this.#t.start(),this.begin()}get#a(){return this.#t?.getSnapshot().context.doc}get#o(){return this.#t?.getSnapshot().value}#f(e){const n=Array.isArray(e)?e:[e];return X_(this.#t,r=>n.some(i=>r.matches(i)),{timeout:this.#s*2})}#l(e){let n=null;if(this.#t.send({type:cc,payload:{callback:r=>{try{return e(r)}catch(i){return n=i,r}}}}),n)throw n}#u(e,n){const r=wt(e),i=wt(n);if(!to(dt(i),dt(r))){this.emit("heads-changed",{handle:this,doc:n});const c=Ys(n,r,i);c.length>0&&this.emit("change",{handle:this,doc:n,patches:c,patchInfo:{before:e,after:n,source:"change"}}),this.isReady()||this.#t.send({type:ac})}this.#n=n}get url(){return gu({documentId:this.documentId,heads:this.#r})}isReady=()=>this.inState(["ready"]);isUnloaded=()=>this.inState(["unloaded"]);isDeleted=()=>this.inState(["deleted"]);isUnavailable=()=>this.inState(["unavailable"]);inState=e=>e.some(n=>this.#t.getSnapshot().matches(n));get state(){return this.#t.getSnapshot().value}async whenReady(e=["ready"]){await $p(this.#f(e),this.#s)}doc(){if(!this.isReady())throw new Error("DocHandle is not ready");return this.#r?wg(this.#a,Ft(this.#r)):this.#a}docSync(){return console.warn("docSync is deprecated. Use doc() instead. This function will be removed as part of the 2.0 release."),this.doc()}heads(){if(!this.isReady())throw new Error("DocHandle is not ready");return this.#r?this.#r:dt(wt(this.#a))}begin(){this.#t.send({type:Np})}history(){if(this.isReady())return jg(this.#a).map(e=>dt([e]))}view(e){if(!this.isReady())throw new Error(`DocHandle#${this.documentId} is not ready. Check \`handle.isReady()\` before calling view().`);const n=JSON.stringify(e),r=this.#c.get(n);if(r)return r;const i=new qr(this.documentId,{heads:e,timeoutDelay:this.#s});return i.update(()=>Hr(this.#a)),i.doneLoading(),this.#c.set(n,i),i}diff(e,n){if(!this.isReady())throw new Error(`DocHandle#${this.documentId} is not ready. Check \`handle.isReady()\` before calling diff().`);const r=this.#a;if(!r)throw new Error("Document not available");if(e instanceof qr){if(!e.isReady())throw new Error("Cannot diff against a handle that isn't ready");const c=e.heads();if(!c)throw new Error("Other document's heads not available");const u=xa(Hr(r),e.doc());return Ys(u,Ft(this.heads()),Ft(c))}const i=n?e:this.heads()||[],o=n||e;return Ys(r,Ft(i),Ft(o))}metadata(e){if(this.isReady())return e||(e=this.heads()[0]),Dg(this.#a,Ft([e])[0])||void 0}update(e){this.#l(e)}doneLoading(){this.#t.send({type:ac})}setSyncInfo(e,n){this.#i[e]=n,this.emit("remote-heads",{storageId:e,heads:n.lastHeads,timestamp:n.lastSyncTimestamp})}getRemoteHeads(e){return this.#i[e]?.lastHeads}getSyncInfo(e){return this.#i[e]}change(e,n={}){if(!this.isReady())throw new Error(`DocHandle#${this.documentId} is in ${this.state} and not ready. Check \`handle.isReady()\` before accessing the document.`);if(this.#r)throw new Error(`DocHandle#${this.documentId} is in view-only mode at specific heads. Use clone() to create a new document from this state.`);this.#l(r=>xg(r,n,e))}changeAt(e,n,r={}){if(!this.isReady())throw new Error(`DocHandle#${this.documentId} is not ready. Check \`handle.isReady()\` before accessing the document.`);if(this.#r)throw new Error(`DocHandle#${this.documentId} is in view-only mode at specific heads. Use clone() to create a new document from this state.`);let i;return this.#l(o=>{const c=Ag(o,Ft(e),r,n);return i=c.newHeads?dt(c.newHeads):void 0,c.newDoc}),i}isReadOnly(){return!!this.#r}merge(e){if(!this.isReady()||!e.isReady())throw new Error("Both handles must be ready to merge");if(this.#r)throw new Error(`DocHandle#${this.documentId} is in view-only mode at specific heads. Use clone() to create a new document from this state.`);const n=e.doc();this.update(r=>xa(r,n))}unavailable(){this.#t.send({type:Gp})}request(){this.#o==="loading"&&this.#t.send({type:zp})}unload(){this.#t.send({type:Vp})}reload(){this.#t.send({type:Wp})}delete(){this.#t.send({type:qp})}broadcast(e){this.emit("ephemeral-message-outbound",{handle:this,data:new Uint8Array(ku(e))})}metrics(){return Li(this.#a)}}const Lp={REQUESTING:"requesting",READY:"ready",UNLOADED:"unloaded",DELETED:"deleted",UNAVAILABLE:"unavailable"},{REQUESTING:wr,READY:ut,UNLOADED:Fp,DELETED:vr,UNAVAILABLE:qe}=Lp,Np="BEGIN",zp="REQUEST",ac="DOC_READY",cc="UPDATE",Vp="UNLOAD",Wp="RELOAD",qp="DELETE",Gp="DOC_UNAVAILABLE";class Jp extends Zt{#e=new Map;#t=new Set;#r=new Map;#n=new Set;#s=new Map;#i=gt("automerge-repo:remote-heads-subscriptions");subscribeToRemotes(e){this.#i("subscribeToRemotes",e);const n=[];for(const r of e)this.#t.has(r)||(this.#t.add(r),n.push(r));n.length>0&&this.emit("change-remote-subs",{add:n,peers:Array.from(this.#n)})}unsubscribeFromRemotes(e){this.#i("subscribeToRemotes",e);const n=[];for(const r of e)this.#t.has(r)&&(this.#t.delete(r),this.#r.has(r)||n.push(r));n.length>0&&this.emit("change-remote-subs",{remove:n,peers:Array.from(this.#n)})}handleControlMessage(e){const n=[],r=[],i=[];if(this.#i("handleControlMessage",e),e.add)for(const o of e.add){let c=this.#r.get(o);(this.#t.has(o)||c)&&i.push(o),c||(c=new Set,this.#r.set(o,c),this.#t.has(o)||n.push(o)),c.add(e.senderId)}if(e.remove)for(const o of e.remove){const c=this.#r.get(o);c&&(c.delete(e.senderId),c.size==0&&!this.#t.has(o)&&r.push(o))}(n.length>0||r.length>0)&&this.emit("change-remote-subs",{peers:Array.from(this.#n),add:n,remove:r});for(const o of i){const c=this.#s.get(e.senderId);if(c)for(const u of c){const f=this.#e.get(u);if(!f)continue;const d=f.get(o);d&&this.emit("notify-remote-heads",{targetId:e.senderId,documentId:u,heads:d.lastHeads,timestamp:d.lastSyncTimestamp,storageId:o})}}}handleRemoteHeads(e){this.#i("handleRemoteHeads",e);const n=this.#a(e);for(const r of n)this.#t.has(r.storageId)&&this.emit("remote-heads-changed",r);for(const r of n)for(const i of this.#n)i!==e.senderId&&this.emit("notify-remote-heads",{targetId:i,documentId:r.documentId,heads:r.remoteHeads,timestamp:r.timestamp,storageId:r.storageId});for(const r of n){const i=this.#r.get(r.storageId);if(i)for(const o of i)this.#c(o,r.documentId)&&this.emit("notify-remote-heads",{targetId:o,documentId:r.documentId,heads:r.remoteHeads,timestamp:r.timestamp,storageId:r.storageId})}}handleImmediateRemoteHeadsChanged(e,n,r){this.#i("handleLocalHeadsChanged",e,n,r);const i=this.#e.get(e),o=Date.now();if(!i)this.#e.set(e,new Map([[n,{lastSyncTimestamp:o,lastHeads:r}]]));else{const u=i.get(n);(!u||u.lastSyncTimestamp<Date.now())&&i.set(n,{lastSyncTimestamp:Date.now(),lastHeads:r})}const c=this.#r.get(n);if(c)for(const u of c)this.#c(u,e)&&this.emit("notify-remote-heads",{targetId:u,documentId:e,heads:r,timestamp:o,storageId:n})}addGenerousPeer(e){this.#i("addGenerousPeer",e),this.#n.add(e),this.#t.size>0&&this.emit("change-remote-subs",{add:Array.from(this.#t),peers:[e]});for(const[n,r]of this.#e)for(const[i,{lastHeads:o,lastSyncTimestamp:c}]of r)this.emit("notify-remote-heads",{targetId:e,documentId:n,heads:o,timestamp:c,storageId:i})}removePeer(e){this.#i("removePeer",e);const n=[];this.#n.delete(e),this.#s.delete(e);for(const[r,i]of this.#r)i.has(e)&&(i.delete(e),i.size==0&&(n.push(r),this.#r.delete(r)));n.length>0&&this.emit("change-remote-subs",{remove:n,peers:Array.from(this.#n)})}subscribePeerToDoc(e,n){let r=this.#s.get(e);r||(r=new Set,this.#s.set(e,r)),r.add(n);const i=this.#e.get(n);if(i)for(const[o,c]of i){const u=this.#r.get(o);u&&u.has(e)&&this.emit("notify-remote-heads",{targetId:e,documentId:n,heads:c.lastHeads,timestamp:c.lastSyncTimestamp,storageId:o})}}#c(e,n){const r=this.#s.get(e);return r&&r.has(n)}#a(e){const n=[],{documentId:r,newHeads:i}=e;for(const[o,{heads:c,timestamp:u}]of Object.entries(i)){if(!this.#t.has(o)&&!this.#r.has(o))continue;let f=this.#e.get(r);f||(f=new Map,this.#e.set(r,f));const d=f.get(o);d&&d.lastSyncTimestamp>=u||(f.set(o,{lastSyncTimestamp:u,lastHeads:c}),n.push({documentId:r,storageId:o,remoteHeads:c,timestamp:u}))}return n}}const Di=(t,e)=>{let n=Date.now(),r,i;return function(...o){r=n+e-Date.now(),clearTimeout(i),i=setTimeout(()=>{t(...o),n=Date.now()},r)}},Kp=t=>Xp(t)||Tu(t)||Cu(t)||Yp(t)||Zp(t)||Qp(t),Yp=t=>t.type==="doc-unavailable",Cu=t=>t.type==="request",Xp=t=>t.type==="sync",Tu=t=>t.type==="ephemeral",Zp=t=>t.type==="remote-subscription-change",Qp=t=>t.type==="remote-heads-changed",e0=t=>`${t.senderId}:${t.sessionId}`;class t0 extends Zt{peerId;peerMetadata;#e;#t={};#r=0;#n=Math.random().toString(36).slice(2);#s={};adapters=[];constructor(e,n,r){super(),this.peerId=n,this.peerMetadata=r,this.#e=gt(`automerge-repo:network:${this.peerId}`),e.forEach(i=>this.addNetworkAdapter(i))}disconnect(){this.adapters.forEach(e=>e.disconnect())}reconnect(){this.adapters.forEach(e=>e.connect(this.peerId))}addNetworkAdapter(e){this.adapters.push(e),e.on("peer-candidate",({peerId:n,peerMetadata:r})=>{this.#e(`peer candidate: ${n} `),this.#t[n]||(this.#t[n]=e),this.emit("peer",{peerId:n,peerMetadata:r})}),e.on("peer-disconnected",({peerId:n})=>{this.#e(`peer disconnected: ${n} `),delete this.#t[n],this.emit("peer-disconnected",{peerId:n})}),e.on("message",n=>{if(!Kp(n)){this.#e(`invalid message: ${JSON.stringify(n)}`);return}if(this.#e(`message from ${n.senderId}`),Tu(n)){const r=e0(n);(this.#s[r]===void 0||n.count>this.#s[r])&&(this.#s[r]=n.count,this.emit("message",n));return}this.emit("message",n)}),e.on("close",()=>{this.#e("adapter closed"),Object.entries(this.#t).forEach(([n,r])=>{r===e&&delete this.#t[n]}),this.adapters=this.adapters.filter(n=>n!==e)}),this.peerMetadata.then(n=>{e.connect(this.peerId,n)}).catch(n=>{this.#e("error connecting to network",n)})}removeNetworkAdapter(e){this.adapters=this.adapters.filter(n=>n!==e),e.disconnect()}send(e){const n=this.#t[e.targetId];if(!n){this.#e(`Tried to send message but peer not found: ${e.targetId}`);return}const i=(o=>o.type==="ephemeral"?"count"in o?o:{...o,count:++this.#r,sessionId:this.#n,senderId:this.peerId}:{...o,senderId:this.peerId})(e);this.#e("sending message %o",i),n.send(i)}isReady=()=>this.adapters.every(e=>e.isReady());whenReady=async()=>Promise.all(this.adapters.map(e=>e.whenReady()))}function Ou(t){let e=0;t.forEach(i=>{e+=i.length});const n=new Uint8Array(e);let r=0;return t.forEach(i=>{n.set(i,r),r+=i.length}),n}var Cr={exports:{}},n0=Cr.exports,uc;function r0(){return uc||(uc=1,function(t){(function(e,n){var r={};n(r);var i=r.default;for(var o in r)i[o]=r[o];t.exports=i})(n0,function(e){e.__esModule=!0,e.digestLength=32,e.blockSize=64;var n=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function r(g,p,m,v,I){for(var $,D,k,Y,z,J,te,Z,F,V,K,se,S;I>=64;){for($=p[0],D=p[1],k=p[2],Y=p[3],z=p[4],J=p[5],te=p[6],Z=p[7],V=0;V<16;V++)K=v+V*4,g[V]=(m[K]&255)<<24|(m[K+1]&255)<<16|(m[K+2]&255)<<8|m[K+3]&255;for(V=16;V<64;V++)F=g[V-2],se=(F>>>17|F<<15)^(F>>>19|F<<13)^F>>>10,F=g[V-15],S=(F>>>7|F<<25)^(F>>>18|F<<14)^F>>>3,g[V]=(se+g[V-7]|0)+(S+g[V-16]|0);for(V=0;V<64;V++)se=(((z>>>6|z<<26)^(z>>>11|z<<21)^(z>>>25|z<<7))+(z&J^~z&te)|0)+(Z+(n[V]+g[V]|0)|0)|0,S=(($>>>2|$<<30)^($>>>13|$<<19)^($>>>22|$<<10))+($&D^$&k^D&k)|0,Z=te,te=J,J=z,z=Y+se|0,Y=k,k=D,D=$,$=se+S|0;p[0]+=$,p[1]+=D,p[2]+=k,p[3]+=Y,p[4]+=z,p[5]+=J,p[6]+=te,p[7]+=Z,v+=64,I-=64}return v}var i=function(){function g(){this.digestLength=e.digestLength,this.blockSize=e.blockSize,this.state=new Int32Array(8),this.temp=new Int32Array(64),this.buffer=new Uint8Array(128),this.bufferLength=0,this.bytesHashed=0,this.finished=!1,this.reset()}return g.prototype.reset=function(){return this.state[0]=1779033703,this.state[1]=3144134277,this.state[2]=1013904242,this.state[3]=2773480762,this.state[4]=1359893119,this.state[5]=2600822924,this.state[6]=528734635,this.state[7]=1541459225,this.bufferLength=0,this.bytesHashed=0,this.finished=!1,this},g.prototype.clean=function(){for(var p=0;p<this.buffer.length;p++)this.buffer[p]=0;for(var p=0;p<this.temp.length;p++)this.temp[p]=0;this.reset()},g.prototype.update=function(p,m){if(m===void 0&&(m=p.length),this.finished)throw new Error("SHA256: can't update because hash was finished.");var v=0;if(this.bytesHashed+=m,this.bufferLength>0){for(;this.bufferLength<64&&m>0;)this.buffer[this.bufferLength++]=p[v++],m--;this.bufferLength===64&&(r(this.temp,this.state,this.buffer,0,64),this.bufferLength=0)}for(m>=64&&(v=r(this.temp,this.state,p,v,m),m%=64);m>0;)this.buffer[this.bufferLength++]=p[v++],m--;return this},g.prototype.finish=function(p){if(!this.finished){var m=this.bytesHashed,v=this.bufferLength,I=m/536870912|0,$=m<<3,D=m%64<56?64:128;this.buffer[v]=128;for(var k=v+1;k<D-8;k++)this.buffer[k]=0;this.buffer[D-8]=I>>>24&255,this.buffer[D-7]=I>>>16&255,this.buffer[D-6]=I>>>8&255,this.buffer[D-5]=I>>>0&255,this.buffer[D-4]=$>>>24&255,this.buffer[D-3]=$>>>16&255,this.buffer[D-2]=$>>>8&255,this.buffer[D-1]=$>>>0&255,r(this.temp,this.state,this.buffer,0,D),this.finished=!0}for(var k=0;k<8;k++)p[k*4+0]=this.state[k]>>>24&255,p[k*4+1]=this.state[k]>>>16&255,p[k*4+2]=this.state[k]>>>8&255,p[k*4+3]=this.state[k]>>>0&255;return this},g.prototype.digest=function(){var p=new Uint8Array(this.digestLength);return this.finish(p),p},g.prototype._saveState=function(p){for(var m=0;m<this.state.length;m++)p[m]=this.state[m]},g.prototype._restoreState=function(p,m){for(var v=0;v<this.state.length;v++)this.state[v]=p[v];this.bytesHashed=m,this.finished=!1,this.bufferLength=0},g}();e.Hash=i;var o=function(){function g(p){this.inner=new i,this.outer=new i,this.blockSize=this.inner.blockSize,this.digestLength=this.inner.digestLength;var m=new Uint8Array(this.blockSize);if(p.length>this.blockSize)new i().update(p).finish(m).clean();else for(var v=0;v<p.length;v++)m[v]=p[v];for(var v=0;v<m.length;v++)m[v]^=54;this.inner.update(m);for(var v=0;v<m.length;v++)m[v]^=106;this.outer.update(m),this.istate=new Uint32Array(8),this.ostate=new Uint32Array(8),this.inner._saveState(this.istate),this.outer._saveState(this.ostate);for(var v=0;v<m.length;v++)m[v]=0}return g.prototype.reset=function(){return this.inner._restoreState(this.istate,this.inner.blockSize),this.outer._restoreState(this.ostate,this.outer.blockSize),this},g.prototype.clean=function(){for(var p=0;p<this.istate.length;p++)this.ostate[p]=this.istate[p]=0;this.inner.clean(),this.outer.clean()},g.prototype.update=function(p){return this.inner.update(p),this},g.prototype.finish=function(p){return this.outer.finished?this.outer.finish(p):(this.inner.finish(p),this.outer.update(p,this.digestLength).finish(p)),this},g.prototype.digest=function(){var p=new Uint8Array(this.digestLength);return this.finish(p),p},g}();e.HMAC=o;function c(g){var p=new i().update(g),m=p.digest();return p.clean(),m}e.hash=c,e.default=c;function u(g,p){var m=new o(g).update(p),v=m.digest();return m.clean(),v}e.hmac=u;function f(g,p,m,v){var I=v[0];if(I===0)throw new Error("hkdf: cannot expand more");p.reset(),I>1&&p.update(g),m&&p.update(m),p.update(v),p.finish(g),v[0]++}var d=new Uint8Array(e.digestLength);function _(g,p,m,v){p===void 0&&(p=d),v===void 0&&(v=32);for(var I=new Uint8Array([1]),$=u(p,g),D=new o($),k=new Uint8Array(D.digestLength),Y=k.length,z=new Uint8Array(v),J=0;J<v;J++)Y===k.length&&(f(k,D,m,I),Y=0),z[J]=k[Y++];return D.clean(),k.fill(0),I.fill(0),z}e.hkdf=_;function h(g,p,m,v){for(var I=new o(g),$=I.digestLength,D=new Uint8Array(4),k=new Uint8Array($),Y=new Uint8Array($),z=new Uint8Array(v),J=0;J*$<v;J++){var te=J+1;D[0]=te>>>24&255,D[1]=te>>>16&255,D[2]=te>>>8&255,D[3]=te>>>0&255,I.reset(),I.update(p),I.update(D),I.finish(Y);for(var Z=0;Z<$;Z++)k[Z]=Y[Z];for(var Z=2;Z<=m;Z++){I.reset(),I.update(Y).finish(Y);for(var F=0;F<$;F++)k[F]^=Y[F]}for(var Z=0;Z<$&&J*$+Z<v;Z++)z[J*$+Z]=k[Z]}for(var J=0;J<$;J++)k[J]=Y[J]=0;for(var J=0;J<4;J++)D[J]=0;return I.clean(),z}e.pbkdf2=h})}(Cr)),Cr.exports}var s0=r0();function Ru(t){const e=s0.hash(t);return o0(e)}function i0(t){const e=new TextEncoder,n=Ou(t.map(r=>e.encode(r)));return Ru(n)}function o0(t){return Array.from(t,e=>e.toString(16).padStart(2,"0")).join("")}class a0 extends Zt{#e;#t=new Map;#r=new Map;#n=!1;#s=gt("automerge-repo:storage-subsystem");constructor(e){super(),this.#e=e}async id(){const e=await this.#e.load(["storage-adapter-id"]);let n;return e?n=new TextDecoder().decode(e):(n=lu(),await this.#e.save(["storage-adapter-id"],new TextEncoder().encode(n))),n}async load(e,n){const r=[e,n];return await this.#e.load(r)}async save(e,n,r){const i=[e,n];await this.#e.save(i,r)}async remove(e,n){const r=[e,n];await this.#e.remove(r)}async loadDocData(e){const n=await this.#e.loadRange([e,"snapshot"]),r=await this.#e.loadRange([e,"incremental"]),i=[],o=[];for(const c of n)c.data!==void 0&&(o.push({key:c.key,type:"snapshot",size:c.data.length}),i.push(c.data));for(const c of r)c.data!==void 0&&(o.push({key:c.key,type:"incremental",size:c.data.length}),i.push(c.data));return this.#r.set(e,o),i.length===0?null:Ou(i)}async loadDoc(e){const n=await this.loadDocData(e);if(!n)return null;const r=performance.now(),i=Lc(vt(),n),o=performance.now();return this.emit("document-loaded",{documentId:e,durationMillis:o-r,...Li(i)}),this.#t.set(e,wt(i)),i}async saveDoc(e,n){if(!this.#a(e,n))return;const r=this.#r.get(e)??[];this.#o(r)?await this.#c(e,n,r):await this.#i(e,n),this.#t.set(e,wt(n))}async removeDoc(e){await this.#e.removeRange([e,"snapshot"]),await this.#e.removeRange([e,"incremental"]),await this.#e.removeRange([e,"sync-state"])}async#i(e,n){const r=Mg(n,this.#t.get(e)??[]);if(r&&r.length>0){const i=[e,"incremental",Ru(r)];this.#s(`Saving incremental ${i} for document ${e}`),await this.#e.save(i,r),this.#r.has(e)||this.#r.set(e,[]),this.#r.get(e).push({key:i,type:"incremental",size:r.length}),this.#t.set(e,wt(n))}else return Promise.resolve()}async#c(e,n,r){this.#n=!0;const i=Fc(n),o=i0(wt(n)),c=[e,"snapshot",o],u=new Set(r.map(d=>d.key).filter(d=>d[2]!==o));this.#s(`Saving snapshot ${c} for document ${e}`),this.#s(`deleting old chunks ${Array.from(u)}`),await this.#e.save(c,i);for(const d of u)await this.#e.remove(d);const f=this.#r.get(e)?.filter(d=>!u.has(d.key))??[];f.push({key:c,type:"snapshot",size:i.length}),this.#r.set(e,f),this.#n=!1}async loadSyncState(e,n){const r=[e,"sync-state",n];try{const i=await this.#e.load(r);return i?zc(i):void 0}catch{this.#s(`Error loading sync state for ${e} from ${n}`);return}}async saveSyncState(e,n,r){const i=[e,"sync-state",n];await this.#e.save(i,Nc(r))}#a(e,n){const r=this.#t.get(e);if(!r)return!0;const i=wt(n);return!to(dt(i),dt(r))}#o(e){if(this.#n)return!1;let n=0,r=0;for(const i of e)i.type==="snapshot"?n+=i.size:r+=i.size;return n<1024||r>=n}}class Mu extends Zt{}class c0 extends Mu{#e;syncDebounceRate=100;#t=[];#r={};#n={};#s={};#i=[];#c;#a=!1;#o;#f;constructor({handle:e,peerId:n,onLoadSyncState:r}){super(),this.#c=n,this.#o=e,this.#f=r??(()=>Promise.resolve(void 0));const i=e.documentId.slice(0,5);this.#e=gt(`automerge-repo:docsync:${i}`),e.on("change",Di(()=>this.#l(),this.syncDebounceRate)),e.on("ephemeral-message-outbound",o=>this.#u(o)),(async()=>this.#m())()}get peerStates(){return this.#n}get documentId(){return this.#o.documentId}async#l(){try{await this.#o.whenReady();const e=this.#o.doc();this.#t.forEach(n=>this.#p(n,e))}catch{console.log("sync with peers threw an exception")}}async#u({data:e}){this.#e("broadcastToPeers",this.#t),this.#t.forEach(n=>this.#g(n,e))}#g(e,n){this.#e(`sendEphemeralMessage ->${e}`);const r={type:"ephemeral",targetId:e,documentId:this.#o.documentId,data:n};this.emit("message",r)}#h(e,n){this.#b(e),e in this.#n||(this.#n[e]="unknown");const r=this.#s[e];if(r){n(r);return}let i=this.#r[e];i||(this.#f(e).then(o=>{this.#w(e,o??Og())}).catch(o=>{this.#e(`Error loading sync state for ${e}: ${o}`)}),i=this.#r[e]=[]),i.push(n)}#b(e){this.#t.includes(e)||(this.#t.push(e),this.emit("open-doc",{documentId:this.documentId,peerId:e}))}#w(e,n){const r=this.#r[e];if(r)for(const i of r)i(n);delete this.#r[e],this.#s[e]=n}#_(e,n){this.#s[e]=n,this.emit("sync-state",{peerId:e,syncState:n,documentId:this.#o.documentId})}#p(e,n){this.#e(`sendSyncMessage ->${e}`),this.#h(e,r=>{const[i,o]=Cg(n,r);if(o){this.#_(e,i);const c=wt(n).length===0;!this.#o.isReady()&&c&&i.sharedHeads.length===0&&!Object.values(this.#n).includes("has")&&this.#n[e]==="unknown"?this.emit("message",{type:"request",targetId:e,documentId:this.#o.documentId,data:o}):this.emit("message",{type:"sync",targetId:e,data:o,documentId:this.#o.documentId}),c||(this.#n[e]="has")}})}hasPeer(e){return this.#t.includes(e)}async beginSync(e){this.#o.whenReady([ut,wr,qe]).then(()=>{this.#a=!0,this.#d()}).catch(r=>{console.log("caught whenready",r),this.#a=!0,this.#d()}),this.#t.some(r=>this.#n[r]=="has")&&await this.#o.whenReady(),e.forEach(r=>{this.#h(r,i=>{const o=zc(Nc(i));this.#_(r,o),this.#o.whenReady([ut,wr,qe]).then(()=>{const c=this.#o.isReady()?this.#o.doc():vt(),u=e.every(d=>this.#n[d]in["unavailable","wants"]);c===void 0&&u||this.#p(r,c??vt())}).catch(c=>{this.#e(`Error loading doc for ${r}: ${c}`)})})})}endSync(e){this.#e(`removing peer ${e}`),this.#t=this.#t.filter(n=>n!==e),delete this.#n[e],this.#d()}receiveMessage(e){switch(e.type){case"sync":case"request":this.receiveSyncMessage(e);break;case"ephemeral":this.receiveEphemeralMessage(e);break;case"doc-unavailable":this.#n[e.senderId]="unavailable",this.#d();break;default:throw new Error(`unknown message type: ${e}`)}}receiveEphemeralMessage(e){if(e.documentId!==this.#o.documentId)throw new Error("channelId doesn't match documentId");const{senderId:n,data:r}=e,i=xu(new Uint8Array(r));this.#o.emit("ephemeral-message",{handle:this.#o,senderId:n,message:i}),this.#t.forEach(o=>{o!==n&&this.emit("message",{...e,targetId:o})})}receiveSyncMessage(e){if(e.documentId!==this.#o.documentId)throw new Error("channelId doesn't match documentId");if(!this.#o.inState([ut,wr,qe])){this.#i.push({message:e,received:new Date});return}this.#m(),this.#y(e)}#y(e){Cu(e)&&(this.#n[e.senderId]="wants"),this.#d(),Rg(e.data).heads.length>0&&(this.#n[e.senderId]="has"),this.#h(e.senderId,n=>{this.#o.update(r=>{const i=performance.now(),[o,c]=Tg(r,n,e.data),u=performance.now();return this.emit("metrics",{type:"receive-sync-message",documentId:this.#o.documentId,durationMillis:u-i,...Li(r)}),this.#_(e.senderId,c),this.#p(e.senderId,r),o}),this.#d()})}#d(){this.#a&&this.#o.inState([wr,qe])&&this.#t.every(e=>this.#n[e]==="unavailable"||this.#n[e]==="wants")&&(this.#t.filter(e=>this.#n[e]==="wants").forEach(e=>{this.#n[e]="unavailable";const n={type:"doc-unavailable",documentId:this.#o.documentId,targetId:e};this.emit("message",n)}),this.#o.unavailable())}#m(){for(const e of this.#i)this.#y(e.message);this.#i=[]}metrics(){return{peers:this.#t,size:this.#o.metrics()}}}const Sr=gt("automerge-repo:collectionsync");class u0 extends Mu{repo;#e=new Set;docSynchronizers={};#t={};#r;constructor(e,n=[]){super(),this.repo=e,this.#r=n.map(r=>Wn(r).documentId)}#n(e){return this.docSynchronizers[e.documentId]||(this.docSynchronizers[e.documentId]=this.#s(e)),this.docSynchronizers[e.documentId]}#s(e){const n=new c0({handle:e,peerId:this.repo.networkSubsystem.peerId,onLoadSyncState:async r=>{if(!this.repo.storageSubsystem)return;const{storageId:i,isEphemeral:o}=this.repo.peerMetadataByPeerId[r]||{};if(!(!i||o))return this.repo.storageSubsystem.loadSyncState(e.documentId,i)}});return n.on("message",r=>this.emit("message",r)),n.on("open-doc",r=>this.emit("open-doc",r)),n.on("sync-state",r=>this.emit("sync-state",r)),n.on("metrics",r=>this.emit("metrics",r)),n}async#i(e){const n=Array.from(this.#e),r=[];for(const i of n)await this.repo.sharePolicy(i,e)&&r.push(i);return r}async receiveMessage(e){Sr(`onSyncMessage: ${e.senderId}, ${e.documentId}, ${"data"in e?e.data.byteLength+"bytes":""}`);const n=e.documentId;if(!n)throw new Error("received a message with an invalid documentId");if(this.#r.includes(n)){this.emit("metrics",{type:"doc-denied",documentId:n}),this.emit("message",{type:"doc-unavailable",documentId:n,targetId:e.senderId});return}this.#t[n]=!0;const r=await this.repo.find(n,{allowableStates:["ready","unavailable","requesting"]}),i=this.#n(r);i.receiveMessage(e);const o=await this.#i(n);i.beginSync(o.filter(c=>!i.hasPeer(c)))}addDocument(e){if(this.#t[e.documentId])return;const n=this.#n(e);this.#i(e.documentId).then(r=>{n.beginSync(r)})}removeDocument(e){Sr(`removing document ${e}`);const n=this.docSynchronizers[e];n!==void 0&&this.peers.forEach(r=>n.endSync(r)),delete this.docSynchronizers[e],delete this.#t[e]}addPeer(e){if(Sr(`adding ${e} & synchronizing with them`),!this.#e.has(e)){this.#e.add(e);for(const n of Object.values(this.docSynchronizers)){const{documentId:r}=n;this.repo.sharePolicy(e,r).then(i=>{i&&n.beginSync([e])})}}}removePeer(e){Sr(`removing peer ${e}`),this.#e.delete(e);for(const n of Object.values(this.docSynchronizers))n.endSync(e)}get peers(){return Array.from(this.#e)}metrics(){return Object.fromEntries(Object.entries(this.docSynchronizers).map(([e,n])=>[e,n.metrics()]))}}function fc(t,e){let n=!1;return new Promise((r,i)=>{e?.addEventListener("abort",()=>{n||i(new DOMException("Operation aborted","AbortError"))},{once:!0}),t.then(o=>{r(o)}).catch(o=>{i(o)}).finally(()=>{n=!0})})}function f0(){return"peer-"+Math.random().toString(36).slice(4)}class l0 extends Zt{#e;networkSubsystem;storageSubsystem;#t;#r;#n={};synchronizer;sharePolicy=async()=>!0;peerMetadataByPeerId={};#s=new Jp;#i=!1;#c={};constructor({storage:e,network:n=[],peerId:r=f0(),sharePolicy:i,isEphemeral:o=e===void 0,enableRemoteHeadsGossiping:c=!1,denylist:u=[],saveDebounceRate:f=100}={}){super(),this.#i=c,this.#e=gt("automerge-repo:repo"),this.sharePolicy=i??this.sharePolicy,this.on("delete-document",({documentId:g})=>{this.synchronizer.removeDocument(g),d&&d.removeDoc(g).catch(p=>{this.#e("error deleting document",{documentId:g,err:p})})}),this.synchronizer=new u0(this,u),this.synchronizer.on("message",g=>{this.#e(`sending ${g.type} message to ${g.targetId}`),h.send(g)}),this.synchronizer.on("metrics",g=>this.emit("doc-metrics",g)),this.#i&&this.synchronizer.on("open-doc",({peerId:g,documentId:p})=>{this.#s.subscribePeerToDoc(g,p)});const d=e?new a0(e):void 0;if(d&&d.on("document-loaded",g=>this.emit("doc-metrics",{type:"doc-loaded",...g})),this.storageSubsystem=d,this.#t=f,this.storageSubsystem){const g=({handle:p,doc:m})=>{this.storageSubsystem.saveDoc(p.documentId,m)};this.#r=Di(g,this.#t)}else this.#r=()=>{};const _=(async()=>({storageId:await d?.id(),isEphemeral:o}))(),h=new t0(n,r,_);this.networkSubsystem=h,h.on("peer",async({peerId:g,peerMetadata:p})=>{this.#e("peer connected",{peerId:g}),p&&(this.peerMetadataByPeerId[g]={...p}),this.sharePolicy(g).then(m=>{m&&this.#i&&this.#s.addGenerousPeer(g)}).catch(m=>{console.log("error in share policy",{err:m})}),this.synchronizer.addPeer(g)}),h.on("peer-disconnected",({peerId:g})=>{this.synchronizer.removePeer(g),this.#s.removePeer(g)}),h.on("message",async g=>{this.#o(g)}),this.synchronizer.on("sync-state",g=>{this.#l(g);const p=this.#n[g.documentId],{storageId:m}=this.peerMetadataByPeerId[g.peerId]||{};if(!m)return;const v=p.getSyncInfo(m)?.lastHeads;g.syncState.theirHeads&&(!v||!to(v,dt(g.syncState.theirHeads)))&&g.syncState.theirHeads&&(p.setSyncInfo(m,{lastHeads:dt(g.syncState.theirHeads),lastSyncTimestamp:Date.now()}),m&&this.#i&&this.#s.handleImmediateRemoteHeadsChanged(g.documentId,m,dt(g.syncState.theirHeads)))}),this.#i&&(this.#s.on("notify-remote-heads",g=>{this.networkSubsystem.send({type:"remote-heads-changed",targetId:g.targetId,documentId:g.documentId,newHeads:{[g.storageId]:{heads:g.heads,timestamp:g.timestamp}}})}),this.#s.on("change-remote-subs",g=>{this.#e("change-remote-subs",g);for(const p of g.peers)this.networkSubsystem.send({type:"remote-subscription-change",targetId:p,add:g.add,remove:g.remove})}),this.#s.on("remote-heads-changed",({documentId:g,storageId:p,remoteHeads:m,timestamp:v})=>{this.#n[g].setSyncInfo(p,{lastHeads:m,lastSyncTimestamp:v})}))}#a(e){this.storageSubsystem&&(e.listeners("heads-changed").some(r=>r===this.#r)||e.on("heads-changed",this.#r)),this.synchronizer.addDocument(e)}#o(e){switch(e.type){case"remote-subscription-change":this.#i&&this.#s.handleControlMessage(e);break;case"remote-heads-changed":this.#i&&this.#s.handleRemoteHeads(e);break;case"sync":case"request":case"ephemeral":case"doc-unavailable":this.synchronizer.receiveMessage(e).catch(n=>{console.log("error receiving message",{err:n,message:e})})}}#f={};#l(e){if(!this.storageSubsystem)return;const{storageId:n,isEphemeral:r}=this.peerMetadataByPeerId[e.peerId]||{};if(!n||r)return;let i=this.#f[n];i||(i=this.#f[n]=Di(({documentId:o,syncState:c})=>{this.storageSubsystem.saveSyncState(o,n,c)},this.#t)),i(e)}#u({documentId:e}){if(this.#n[e])return this.#n[e];if(!e)throw new Error(`Invalid documentId ${e}`);const n=new qr(e);return this.#n[e]=n,n}get handles(){return this.#n}get peers(){return this.synchronizer.peers}getStorageIdOfPeer(e){return this.peerMetadataByPeerId[e]?.storageId}create(e){const{documentId:n}=Wn(pp()),r=this.#u({documentId:n});return this.#a(r),r.update(()=>{let i;return e?i=Ug(e):i=Ig(vt()),i}),r.doneLoading(),r}clone(e){if(!e.isReady())throw new Error(`Cloned handle is not yet in ready state.
        (Try await handle.whenReady() first.)`);const n=e.doc(),r=this.create();return r.update(()=>Hr(n)),r}findWithProgress(e,n={}){const{signal:r}=n,{documentId:i,heads:o}=_u(e)?Wn(e):{documentId:yr(e),heads:void 0};if(this.#n[i]){const h=this.#n[i];if(h.state===qe)return{state:"unavailable",error:new Error(`Document ${e} is unavailable`),handle:h};if(h.state===vr)return{state:"failed",error:new Error(`Document ${e} was deleted`),handle:h};if(h.state===ut)return{state:"ready",handle:o?h.view(o):h}}const c=this.#c[i];if(c){const h=this.#n[i];if(h&&(h.state===ut||h.state===qe||h.state===vr||h.state==="loading"))return c}const u=this.#u({documentId:i}),f={state:"loading",progress:0,handle:u},d={subscribers:new Set,currentProgress:void 0,notify:h=>{d.currentProgress=h,d.subscribers.forEach(g=>g(h)),this.#c[i]=h},peek:()=>d.currentProgress||f,subscribe:h=>(d.subscribers.add(h),()=>d.subscribers.delete(h))};d.notify(f),this.#g(e,i,u,d,r?fc(new Promise(()=>{}),r):new Promise(()=>{}));const _={...f,peek:d.peek,subscribe:d.subscribe};return this.#c[i]=_,_}async#g(e,n,r,i,o){try{i.notify({state:"loading",progress:25,handle:r});const c=await(this.storageSubsystem?this.storageSubsystem.loadDoc(r.documentId):Promise.resolve(null)),u=await Promise.race([c,o]);if(u?(r.update(()=>u),r.doneLoading(),i.notify({state:"loading",progress:50,handle:r})):(await Promise.race([this.networkSubsystem.whenReady(),o]),r.request(),i.notify({state:"loading",progress:75,handle:r})),this.#a(r),await Promise.race([r.whenReady([ut,qe]),o]),r.state===qe){const f={state:"unavailable",handle:r};i.notify(f);return}if(r.state===vr)throw new Error(`Document ${e} was deleted`);i.notify({state:"ready",handle:r})}catch(c){i.notify({state:"failed",error:c instanceof Error?c:new Error(String(c)),handle:this.#u({documentId:n})})}}async find(e,n={}){const{allowableStates:r=["ready"],signal:i}=n;if(i?.aborted)throw new Error("Operation aborted");const o=this.findWithProgress(e,{signal:i});if("subscribe"in o)return this.#a(o.handle),new Promise((c,u)=>{const f=o.subscribe(d=>{r.includes(d.handle.state)?(f(),c(d.handle)):d.state==="unavailable"?(f(),u(new Error(`Document ${e} is unavailable`))):d.state==="failed"&&(f(),u(d.error))})});if(o.handle.state===ut)return o.handle;if(await o.handle.whenReady([ut,qe]),o.handle.state==="unavailable"&&!r.includes(qe))throw new Error(`Document ${e} is unavailable`);return o.handle}async#h(e){if(this.#n[e])return this.#n[e];const n=this.#u({documentId:e}),r=await(this.storageSubsystem?this.storageSubsystem.loadDoc(n.documentId):Promise.resolve(null));return r?(n.update(()=>r),n.doneLoading()):(await this.networkSubsystem.whenReady(),n.request()),this.#a(n),n}async findClassic(e,n={}){const r=yr(e),{allowableStates:i,signal:o}=n;return fc((async()=>{const c=await this.#h(r);if(!i&&(await c.whenReady([ut,qe]),c.state===qe&&!o?.aborted))throw new Error(`Document ${e} is unavailable`);return c})(),o)}delete(e){const n=yr(e);this.#u({documentId:n}).delete(),delete this.#n[n],delete this.#c[n],this.emit("delete-document",{documentId:n})}async export(e){const n=yr(e),i=this.#u({documentId:n}).doc();return Fc(i)}import(e){const n=Pg(e),r=this.create();return r.update(()=>Hr(n)),r}subscribeToRemotes=e=>{this.#i?(this.#e("subscribeToRemotes",{remotes:e}),this.#s.subscribeToRemotes(e)):this.#e("WARN: subscribeToRemotes called but remote heads gossiping is not enabled")};storageId=async()=>{if(this.storageSubsystem)return this.storageSubsystem.id()};async flush(e){if(!this.storageSubsystem)return;const n=e?e.map(r=>this.#n[r]):Object.values(this.#n);await Promise.all(n.map(async r=>this.storageSubsystem.saveDoc(r.documentId,r.doc())))}async removeFromCache(e){if(!this.#n[e]){this.#e(`WARN: removeFromCache called but handle not found in handleCache for documentId: ${e}`);return}const n=this.#u({documentId:e});await n.whenReady([ut,Fp,vr,qe]),n.doc()?(n.isReady()?n.unload():this.#e(`WARN: removeFromCache called but handle for documentId: ${e} in unexpected state: ${n.state}`),delete this.#n[e],delete this.#c[e],this.synchronizer.removeDocument(e)):this.#e(`WARN: removeFromCache called but doc undefined for documentId: ${e}`)}shutdown(){return this.networkSubsystem.adapters.forEach(e=>{e.disconnect()}),this.flush()}metrics(){return{documents:this.synchronizer.metrics()}}}class ju extends Zt{peerId;peerMetadata}const d0="/parking-lot/assets/automerge_wasm_bg-B_JtgnFP.wasm",h0=async(t={},e)=>{let n;if(e.startsWith("data:")){const r=e.replace(/^data:.*?base64,/,"");let i;if(typeof Buffer=="function"&&typeof Buffer.from=="function")i=Buffer.from(r,"base64");else if(typeof atob=="function"){const o=atob(r);i=new Uint8Array(o.length);for(let c=0;c<o.length;c++)i[c]=o.charCodeAt(c)}else throw new Error("Cannot decode base64-encoded data URL");n=await WebAssembly.instantiate(i,t)}else{const r=await fetch(e),i=r.headers.get("Content-Type")||"";if("instantiateStreaming"in WebAssembly&&i.startsWith("application/wasm"))n=await WebAssembly.instantiateStreaming(r,t);else{const o=await r.arrayBuffer();n=await WebAssembly.instantiate(o,t)}}return n.instance.exports};let b;function Du(t){b=t}const St=new Array(128).fill(void 0);St.push(void 0,null,!0,!1);function X(t){return St[t]}let et=0,xr=null;function Bn(){return(xr===null||xr.byteLength===0)&&(xr=new Uint8Array(b.memory.buffer)),xr}const g0=typeof TextEncoder>"u"?(0,module.require)("util").TextEncoder:TextEncoder;let Tr=new g0("utf-8");const _0=typeof Tr.encodeInto=="function"?function(t,e){return Tr.encodeInto(t,e)}:function(t,e){const n=Tr.encode(t);return e.set(n),{read:t.length,written:n.length}};function ht(t,e,n){if(n===void 0){const u=Tr.encode(t),f=e(u.length,1)>>>0;return Bn().subarray(f,f+u.length).set(u),et=u.length,f}let r=t.length,i=e(r,1)>>>0;const o=Bn();let c=0;for(;c<r;c++){const u=t.charCodeAt(c);if(u>127)break;o[i+c]=u}if(c!==r){c!==0&&(t=t.slice(c)),i=n(i,r,r=c+t.length*3,1)>>>0;const u=Bn().subarray(i+c,i+r),f=_0(t,u);c+=f.written,i=n(i,r,c,1)>>>0}return et=c,i}let mn=null;function E(){return(mn===null||mn.buffer.detached===!0||mn.buffer.detached===void 0&&mn.buffer!==b.memory.buffer)&&(mn=new DataView(b.memory.buffer)),mn}let Ln=St.length;function M(t){Ln===St.length&&St.push(St.length+1);const e=Ln;return Ln=St[e],St[e]=t,e}function At(t,e){try{return t.apply(this,e)}catch(n){b.__wbindgen_exn_store(M(n))}}const p0=typeof TextDecoder>"u"?(0,module.require)("util").TextDecoder:TextDecoder;let Uu=new p0("utf-8",{ignoreBOM:!0,fatal:!0});Uu.decode();function tt(t,e){return t=t>>>0,Uu.decode(Bn().subarray(t,t+e))}function y0(t,e){return t=t>>>0,Bn().subarray(t/1,t/1+e)}function m0(t){t<132||(St[t]=Ln,Ln=t)}function L(t){const e=X(t);return m0(t),e}function Ui(t){const e=typeof t;if(e=="number"||e=="boolean"||t==null)return`${t}`;if(e=="string")return`"${t}"`;if(e=="symbol"){const i=t.description;return i==null?"Symbol":`Symbol(${i})`}if(e=="function"){const i=t.name;return typeof i=="string"&&i.length>0?`Function(${i})`:"Function"}if(Array.isArray(t)){const i=t.length;let o="[";i>0&&(o+=Ui(t[0]));for(let c=1;c<i;c++)o+=", "+Ui(t[c]);return o+="]",o}const n=/\[object ([^\]]+)\]/.exec(toString.call(t));let r;if(n&&n.length>1)r=n[1];else return toString.call(t);if(r=="Object")try{return"Object("+JSON.stringify(t)+")"}catch{return"Object"}return t instanceof Error?`${t.name}: ${t.message}
${t.stack}`:r}function ye(t){return t==null}function Vt(t,e){if(!(t instanceof e))throw new Error(`expected instance of ${e.name}`)}function b0(t){try{const i=b.__wbindgen_add_to_stack_pointer(-16);b.create(i,M(t));var e=E().getInt32(i+0,!0),n=E().getInt32(i+4,!0),r=E().getInt32(i+8,!0);if(r)throw L(n);return ft.__wrap(e)}finally{b.__wbindgen_add_to_stack_pointer(16)}}function w0(t,e){try{const o=b.__wbindgen_add_to_stack_pointer(-16);b.load(o,M(t),M(e));var n=E().getInt32(o+0,!0),r=E().getInt32(o+4,!0),i=E().getInt32(o+8,!0);if(i)throw L(r);return ft.__wrap(n)}finally{b.__wbindgen_add_to_stack_pointer(16)}}function v0(t){try{const i=b.__wbindgen_add_to_stack_pointer(-16);b.encodeChange(i,M(t));var e=E().getInt32(i+0,!0),n=E().getInt32(i+4,!0),r=E().getInt32(i+8,!0);if(r)throw L(n);return L(e)}finally{b.__wbindgen_add_to_stack_pointer(16)}}function S0(t){try{const i=b.__wbindgen_add_to_stack_pointer(-16);b.decodeChange(i,M(t));var e=E().getInt32(i+0,!0),n=E().getInt32(i+4,!0),r=E().getInt32(i+8,!0);if(r)throw L(n);return L(e)}finally{b.__wbindgen_add_to_stack_pointer(16)}}function x0(){const t=b.initSyncState();return nt.__wrap(t)}function A0(t){try{const i=b.__wbindgen_add_to_stack_pointer(-16);b.importSyncState(i,M(t));var e=E().getInt32(i+0,!0),n=E().getInt32(i+4,!0),r=E().getInt32(i+8,!0);if(r)throw L(n);return nt.__wrap(e)}finally{b.__wbindgen_add_to_stack_pointer(16)}}function I0(t){Vt(t,nt);const e=b.exportSyncState(t.__wbg_ptr);return L(e)}function E0(t){try{const i=b.__wbindgen_add_to_stack_pointer(-16);b.encodeSyncMessage(i,M(t));var e=E().getInt32(i+0,!0),n=E().getInt32(i+4,!0),r=E().getInt32(i+8,!0);if(r)throw L(n);return L(e)}finally{b.__wbindgen_add_to_stack_pointer(16)}}function k0(t){try{const i=b.__wbindgen_add_to_stack_pointer(-16);b.decodeSyncMessage(i,M(t));var e=E().getInt32(i+0,!0),n=E().getInt32(i+4,!0),r=E().getInt32(i+8,!0);if(r)throw L(n);return L(e)}finally{b.__wbindgen_add_to_stack_pointer(16)}}function C0(t){Vt(t,nt);const e=b.encodeSyncState(t.__wbg_ptr);return L(e)}function T0(t){try{const i=b.__wbindgen_add_to_stack_pointer(-16);b.decodeSyncState(i,M(t));var e=E().getInt32(i+0,!0),n=E().getInt32(i+4,!0),r=E().getInt32(i+8,!0);if(r)throw L(n);return nt.__wrap(e)}finally{b.__wbindgen_add_to_stack_pointer(16)}}const O0=Object.freeze({Array:0,0:"Array",String:1,1:"String"}),lc=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>b.__wbg_automerge_free(t>>>0,1));class ft{static __wrap(e){e=e>>>0;const n=Object.create(ft.prototype);return n.__wbg_ptr=e,lc.register(n,n.__wbg_ptr,n),n}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,lc.unregister(this),e}free(){const e=this.__destroy_into_raw();b.__wbg_automerge_free(e,0)}static new(e,n){try{const f=b.__wbindgen_add_to_stack_pointer(-16);var r=ye(e)?0:ht(e,b.__wbindgen_malloc,b.__wbindgen_realloc),i=et;b.automerge_new(f,r,i,n);var o=E().getInt32(f+0,!0),c=E().getInt32(f+4,!0),u=E().getInt32(f+8,!0);if(u)throw L(c);return ft.__wrap(o)}finally{b.__wbindgen_add_to_stack_pointer(16)}}clone(e){try{const u=b.__wbindgen_add_to_stack_pointer(-16);var n=ye(e)?0:ht(e,b.__wbindgen_malloc,b.__wbindgen_realloc),r=et;b.automerge_clone(u,this.__wbg_ptr,n,r);var i=E().getInt32(u+0,!0),o=E().getInt32(u+4,!0),c=E().getInt32(u+8,!0);if(c)throw L(o);return ft.__wrap(i)}finally{b.__wbindgen_add_to_stack_pointer(16)}}fork(e,n){try{const f=b.__wbindgen_add_to_stack_pointer(-16);var r=ye(e)?0:ht(e,b.__wbindgen_malloc,b.__wbindgen_realloc),i=et;b.automerge_fork(f,this.__wbg_ptr,r,i,M(n));var o=E().getInt32(f+0,!0),c=E().getInt32(f+4,!0),u=E().getInt32(f+8,!0);if(u)throw L(c);return ft.__wrap(o)}finally{b.__wbindgen_add_to_stack_pointer(16)}}pendingOps(){const e=b.automerge_pendingOps(this.__wbg_ptr);return L(e)}commit(e,n){var r=ye(e)?0:ht(e,b.__wbindgen_malloc,b.__wbindgen_realloc),i=et;const o=b.automerge_commit(this.__wbg_ptr,r,i,!ye(n),ye(n)?0:n);return L(o)}merge(e){try{const o=b.__wbindgen_add_to_stack_pointer(-16);Vt(e,ft),b.automerge_merge(o,this.__wbg_ptr,e.__wbg_ptr);var n=E().getInt32(o+0,!0),r=E().getInt32(o+4,!0),i=E().getInt32(o+8,!0);if(i)throw L(r);return L(n)}finally{b.__wbindgen_add_to_stack_pointer(16)}}rollback(){return b.automerge_rollback(this.__wbg_ptr)}keys(e,n){try{const c=b.__wbindgen_add_to_stack_pointer(-16);b.automerge_keys(c,this.__wbg_ptr,M(e),ye(n)?0:M(n));var r=E().getInt32(c+0,!0),i=E().getInt32(c+4,!0),o=E().getInt32(c+8,!0);if(o)throw L(i);return L(r)}finally{b.__wbindgen_add_to_stack_pointer(16)}}text(e,n){let r,i;try{const h=b.__wbindgen_add_to_stack_pointer(-16);b.automerge_text(h,this.__wbg_ptr,M(e),ye(n)?0:M(n));var o=E().getInt32(h+0,!0),c=E().getInt32(h+4,!0),u=E().getInt32(h+8,!0),f=E().getInt32(h+12,!0),d=o,_=c;if(f)throw d=0,_=0,L(u);return r=d,i=_,tt(d,_)}finally{b.__wbindgen_add_to_stack_pointer(16),b.__wbindgen_free(r,i,1)}}spans(e,n){try{const c=b.__wbindgen_add_to_stack_pointer(-16);b.automerge_spans(c,this.__wbg_ptr,M(e),ye(n)?0:M(n));var r=E().getInt32(c+0,!0),i=E().getInt32(c+4,!0),o=E().getInt32(c+8,!0);if(o)throw L(i);return L(r)}finally{b.__wbindgen_add_to_stack_pointer(16)}}splice(e,n,r,i){try{const u=b.__wbindgen_add_to_stack_pointer(-16);b.automerge_splice(u,this.__wbg_ptr,M(e),n,r,M(i));var o=E().getInt32(u+0,!0),c=E().getInt32(u+4,!0);if(c)throw L(o)}finally{b.__wbindgen_add_to_stack_pointer(16)}}updateText(e,n){try{const o=b.__wbindgen_add_to_stack_pointer(-16);b.automerge_updateText(o,this.__wbg_ptr,M(e),M(n));var r=E().getInt32(o+0,!0),i=E().getInt32(o+4,!0);if(i)throw L(r)}finally{b.__wbindgen_add_to_stack_pointer(16)}}updateSpans(e,n){try{const o=b.__wbindgen_add_to_stack_pointer(-16);b.automerge_updateSpans(o,this.__wbg_ptr,M(e),M(n));var r=E().getInt32(o+0,!0),i=E().getInt32(o+4,!0);if(i)throw L(r)}finally{b.__wbindgen_add_to_stack_pointer(16)}}push(e,n,r){try{const c=b.__wbindgen_add_to_stack_pointer(-16);b.automerge_push(c,this.__wbg_ptr,M(e),M(n),M(r));var i=E().getInt32(c+0,!0),o=E().getInt32(c+4,!0);if(o)throw L(i)}finally{b.__wbindgen_add_to_stack_pointer(16)}}pushObject(e,n){try{const u=b.__wbindgen_add_to_stack_pointer(-16);b.automerge_pushObject(u,this.__wbg_ptr,M(e),M(n));var r=E().getInt32(u+0,!0),i=E().getInt32(u+4,!0),o=E().getInt32(u+8,!0),c=E().getInt32(u+12,!0);if(c)throw L(o);let f;return r!==0&&(f=tt(r,i).slice(),b.__wbindgen_free(r,i*1,1)),f}finally{b.__wbindgen_add_to_stack_pointer(16)}}insert(e,n,r,i){try{const u=b.__wbindgen_add_to_stack_pointer(-16);b.automerge_insert(u,this.__wbg_ptr,M(e),n,M(r),M(i));var o=E().getInt32(u+0,!0),c=E().getInt32(u+4,!0);if(c)throw L(o)}finally{b.__wbindgen_add_to_stack_pointer(16)}}splitBlock(e,n,r){try{const c=b.__wbindgen_add_to_stack_pointer(-16);b.automerge_splitBlock(c,this.__wbg_ptr,M(e),n,M(r));var i=E().getInt32(c+0,!0),o=E().getInt32(c+4,!0);if(o)throw L(i)}finally{b.__wbindgen_add_to_stack_pointer(16)}}joinBlock(e,n){try{const o=b.__wbindgen_add_to_stack_pointer(-16);b.automerge_joinBlock(o,this.__wbg_ptr,M(e),n);var r=E().getInt32(o+0,!0),i=E().getInt32(o+4,!0);if(i)throw L(r)}finally{b.__wbindgen_add_to_stack_pointer(16)}}updateBlock(e,n,r){try{const c=b.__wbindgen_add_to_stack_pointer(-16);b.automerge_updateBlock(c,this.__wbg_ptr,M(e),n,M(r));var i=E().getInt32(c+0,!0),o=E().getInt32(c+4,!0);if(o)throw L(i)}finally{b.__wbindgen_add_to_stack_pointer(16)}}getBlock(e,n,r){try{const u=b.__wbindgen_add_to_stack_pointer(-16);b.automerge_getBlock(u,this.__wbg_ptr,M(e),n,ye(r)?0:M(r));var i=E().getInt32(u+0,!0),o=E().getInt32(u+4,!0),c=E().getInt32(u+8,!0);if(c)throw L(o);return L(i)}finally{b.__wbindgen_add_to_stack_pointer(16)}}insertObject(e,n,r){try{const f=b.__wbindgen_add_to_stack_pointer(-16);b.automerge_insertObject(f,this.__wbg_ptr,M(e),n,M(r));var i=E().getInt32(f+0,!0),o=E().getInt32(f+4,!0),c=E().getInt32(f+8,!0),u=E().getInt32(f+12,!0);if(u)throw L(c);let d;return i!==0&&(d=tt(i,o).slice(),b.__wbindgen_free(i,o*1,1)),d}finally{b.__wbindgen_add_to_stack_pointer(16)}}put(e,n,r,i){try{const u=b.__wbindgen_add_to_stack_pointer(-16);b.automerge_put(u,this.__wbg_ptr,M(e),M(n),M(r),M(i));var o=E().getInt32(u+0,!0),c=E().getInt32(u+4,!0);if(c)throw L(o)}finally{b.__wbindgen_add_to_stack_pointer(16)}}putObject(e,n,r){try{const u=b.__wbindgen_add_to_stack_pointer(-16);b.automerge_putObject(u,this.__wbg_ptr,M(e),M(n),M(r));var i=E().getInt32(u+0,!0),o=E().getInt32(u+4,!0),c=E().getInt32(u+8,!0);if(c)throw L(o);return L(i)}finally{b.__wbindgen_add_to_stack_pointer(16)}}increment(e,n,r){try{const c=b.__wbindgen_add_to_stack_pointer(-16);b.automerge_increment(c,this.__wbg_ptr,M(e),M(n),M(r));var i=E().getInt32(c+0,!0),o=E().getInt32(c+4,!0);if(o)throw L(i)}finally{b.__wbindgen_add_to_stack_pointer(16)}}get(e,n,r){try{const u=b.__wbindgen_add_to_stack_pointer(-16);b.automerge_get(u,this.__wbg_ptr,M(e),M(n),ye(r)?0:M(r));var i=E().getInt32(u+0,!0),o=E().getInt32(u+4,!0),c=E().getInt32(u+8,!0);if(c)throw L(o);return L(i)}finally{b.__wbindgen_add_to_stack_pointer(16)}}getWithType(e,n,r){try{const u=b.__wbindgen_add_to_stack_pointer(-16);b.automerge_getWithType(u,this.__wbg_ptr,M(e),M(n),ye(r)?0:M(r));var i=E().getInt32(u+0,!0),o=E().getInt32(u+4,!0),c=E().getInt32(u+8,!0);if(c)throw L(o);return L(i)}finally{b.__wbindgen_add_to_stack_pointer(16)}}objInfo(e,n){try{const c=b.__wbindgen_add_to_stack_pointer(-16);b.automerge_objInfo(c,this.__wbg_ptr,M(e),ye(n)?0:M(n));var r=E().getInt32(c+0,!0),i=E().getInt32(c+4,!0),o=E().getInt32(c+8,!0);if(o)throw L(i);return L(r)}finally{b.__wbindgen_add_to_stack_pointer(16)}}getAll(e,n,r){try{const u=b.__wbindgen_add_to_stack_pointer(-16);b.automerge_getAll(u,this.__wbg_ptr,M(e),M(n),ye(r)?0:M(r));var i=E().getInt32(u+0,!0),o=E().getInt32(u+4,!0),c=E().getInt32(u+8,!0);if(c)throw L(o);return L(i)}finally{b.__wbindgen_add_to_stack_pointer(16)}}enableFreeze(e){try{const o=b.__wbindgen_add_to_stack_pointer(-16);b.automerge_enableFreeze(o,this.__wbg_ptr,M(e));var n=E().getInt32(o+0,!0),r=E().getInt32(o+4,!0),i=E().getInt32(o+8,!0);if(i)throw L(r);return L(n)}finally{b.__wbindgen_add_to_stack_pointer(16)}}registerDatatype(e,n,r){try{const c=b.__wbindgen_add_to_stack_pointer(-16);b.automerge_registerDatatype(c,this.__wbg_ptr,M(e),M(n),M(r));var i=E().getInt32(c+0,!0),o=E().getInt32(c+4,!0);if(o)throw L(i)}finally{b.__wbindgen_add_to_stack_pointer(16)}}applyPatches(e,n){try{const c=b.__wbindgen_add_to_stack_pointer(-16);b.automerge_applyPatches(c,this.__wbg_ptr,M(e),M(n));var r=E().getInt32(c+0,!0),i=E().getInt32(c+4,!0),o=E().getInt32(c+8,!0);if(o)throw L(i);return L(r)}finally{b.__wbindgen_add_to_stack_pointer(16)}}applyAndReturnPatches(e,n){try{const c=b.__wbindgen_add_to_stack_pointer(-16);b.automerge_applyAndReturnPatches(c,this.__wbg_ptr,M(e),M(n));var r=E().getInt32(c+0,!0),i=E().getInt32(c+4,!0),o=E().getInt32(c+8,!0);if(o)throw L(i);return L(r)}finally{b.__wbindgen_add_to_stack_pointer(16)}}diffIncremental(){try{const i=b.__wbindgen_add_to_stack_pointer(-16);b.automerge_diffIncremental(i,this.__wbg_ptr);var e=E().getInt32(i+0,!0),n=E().getInt32(i+4,!0),r=E().getInt32(i+8,!0);if(r)throw L(n);return L(e)}finally{b.__wbindgen_add_to_stack_pointer(16)}}updateDiffCursor(){b.automerge_updateDiffCursor(this.__wbg_ptr)}resetDiffCursor(){b.automerge_resetDiffCursor(this.__wbg_ptr)}diff(e,n){try{const c=b.__wbindgen_add_to_stack_pointer(-16);b.automerge_diff(c,this.__wbg_ptr,M(e),M(n));var r=E().getInt32(c+0,!0),i=E().getInt32(c+4,!0),o=E().getInt32(c+8,!0);if(o)throw L(i);return L(r)}finally{b.__wbindgen_add_to_stack_pointer(16)}}isolate(e){try{const i=b.__wbindgen_add_to_stack_pointer(-16);b.automerge_isolate(i,this.__wbg_ptr,M(e));var n=E().getInt32(i+0,!0),r=E().getInt32(i+4,!0);if(r)throw L(n)}finally{b.__wbindgen_add_to_stack_pointer(16)}}integrate(){b.automerge_integrate(this.__wbg_ptr)}length(e,n){try{const c=b.__wbindgen_add_to_stack_pointer(-16);b.automerge_length(c,this.__wbg_ptr,M(e),ye(n)?0:M(n));var r=E().getFloat64(c+0,!0),i=E().getInt32(c+8,!0),o=E().getInt32(c+12,!0);if(o)throw L(i);return r}finally{b.__wbindgen_add_to_stack_pointer(16)}}delete(e,n){try{const o=b.__wbindgen_add_to_stack_pointer(-16);b.automerge_delete(o,this.__wbg_ptr,M(e),M(n));var r=E().getInt32(o+0,!0),i=E().getInt32(o+4,!0);if(i)throw L(r)}finally{b.__wbindgen_add_to_stack_pointer(16)}}save(){const e=b.automerge_save(this.__wbg_ptr);return L(e)}saveIncremental(){const e=b.automerge_saveIncremental(this.__wbg_ptr);return L(e)}saveSince(e){try{const o=b.__wbindgen_add_to_stack_pointer(-16);b.automerge_saveSince(o,this.__wbg_ptr,M(e));var n=E().getInt32(o+0,!0),r=E().getInt32(o+4,!0),i=E().getInt32(o+8,!0);if(i)throw L(r);return L(n)}finally{b.__wbindgen_add_to_stack_pointer(16)}}saveNoCompress(){const e=b.automerge_saveNoCompress(this.__wbg_ptr);return L(e)}saveAndVerify(){try{const i=b.__wbindgen_add_to_stack_pointer(-16);b.automerge_saveAndVerify(i,this.__wbg_ptr);var e=E().getInt32(i+0,!0),n=E().getInt32(i+4,!0),r=E().getInt32(i+8,!0);if(r)throw L(n);return L(e)}finally{b.__wbindgen_add_to_stack_pointer(16)}}loadIncremental(e){try{const o=b.__wbindgen_add_to_stack_pointer(-16);b.automerge_loadIncremental(o,this.__wbg_ptr,M(e));var n=E().getFloat64(o+0,!0),r=E().getInt32(o+8,!0),i=E().getInt32(o+12,!0);if(i)throw L(r);return n}finally{b.__wbindgen_add_to_stack_pointer(16)}}applyChanges(e){try{const i=b.__wbindgen_add_to_stack_pointer(-16);b.automerge_applyChanges(i,this.__wbg_ptr,M(e));var n=E().getInt32(i+0,!0),r=E().getInt32(i+4,!0);if(r)throw L(n)}finally{b.__wbindgen_add_to_stack_pointer(16)}}getChanges(e){try{const o=b.__wbindgen_add_to_stack_pointer(-16);b.automerge_getChanges(o,this.__wbg_ptr,M(e));var n=E().getInt32(o+0,!0),r=E().getInt32(o+4,!0),i=E().getInt32(o+8,!0);if(i)throw L(r);return L(n)}finally{b.__wbindgen_add_to_stack_pointer(16)}}getChangeByHash(e){try{const o=b.__wbindgen_add_to_stack_pointer(-16);b.automerge_getChangeByHash(o,this.__wbg_ptr,M(e));var n=E().getInt32(o+0,!0),r=E().getInt32(o+4,!0),i=E().getInt32(o+8,!0);if(i)throw L(r);return L(n)}finally{b.__wbindgen_add_to_stack_pointer(16)}}getDecodedChangeByHash(e){try{const o=b.__wbindgen_add_to_stack_pointer(-16);b.automerge_getDecodedChangeByHash(o,this.__wbg_ptr,M(e));var n=E().getInt32(o+0,!0),r=E().getInt32(o+4,!0),i=E().getInt32(o+8,!0);if(i)throw L(r);return L(n)}finally{b.__wbindgen_add_to_stack_pointer(16)}}getChangesAdded(e){Vt(e,ft);const n=b.automerge_getChangesAdded(this.__wbg_ptr,e.__wbg_ptr);return L(n)}getHeads(){const e=b.automerge_getHeads(this.__wbg_ptr);return L(e)}getActorId(){let e,n;try{const o=b.__wbindgen_add_to_stack_pointer(-16);b.automerge_getActorId(o,this.__wbg_ptr);var r=E().getInt32(o+0,!0),i=E().getInt32(o+4,!0);return e=r,n=i,tt(r,i)}finally{b.__wbindgen_add_to_stack_pointer(16),b.__wbindgen_free(e,n,1)}}getLastLocalChange(){const e=b.automerge_getLastLocalChange(this.__wbg_ptr);return L(e)}dump(){b.automerge_dump(this.__wbg_ptr)}getMissingDeps(e){try{const o=b.__wbindgen_add_to_stack_pointer(-16);b.automerge_getMissingDeps(o,this.__wbg_ptr,ye(e)?0:M(e));var n=E().getInt32(o+0,!0),r=E().getInt32(o+4,!0),i=E().getInt32(o+8,!0);if(i)throw L(r);return L(n)}finally{b.__wbindgen_add_to_stack_pointer(16)}}receiveSyncMessage(e,n){try{const o=b.__wbindgen_add_to_stack_pointer(-16);Vt(e,nt),b.automerge_receiveSyncMessage(o,this.__wbg_ptr,e.__wbg_ptr,M(n));var r=E().getInt32(o+0,!0),i=E().getInt32(o+4,!0);if(i)throw L(r)}finally{b.__wbindgen_add_to_stack_pointer(16)}}generateSyncMessage(e){Vt(e,nt);const n=b.automerge_generateSyncMessage(this.__wbg_ptr,e.__wbg_ptr);return L(n)}toJS(e){try{const o=b.__wbindgen_add_to_stack_pointer(-16);b.automerge_toJS(o,this.__wbg_ptr,M(e));var n=E().getInt32(o+0,!0),r=E().getInt32(o+4,!0),i=E().getInt32(o+8,!0);if(i)throw L(r);return L(n)}finally{b.__wbindgen_add_to_stack_pointer(16)}}materialize(e,n,r){try{const u=b.__wbindgen_add_to_stack_pointer(-16);b.automerge_materialize(u,this.__wbg_ptr,M(e),ye(n)?0:M(n),M(r));var i=E().getInt32(u+0,!0),o=E().getInt32(u+4,!0),c=E().getInt32(u+8,!0);if(c)throw L(o);return L(i)}finally{b.__wbindgen_add_to_stack_pointer(16)}}getCursor(e,n,r,i){let o,c;try{const p=b.__wbindgen_add_to_stack_pointer(-16);b.automerge_getCursor(p,this.__wbg_ptr,M(e),M(n),ye(r)?0:M(r),M(i));var u=E().getInt32(p+0,!0),f=E().getInt32(p+4,!0),d=E().getInt32(p+8,!0),_=E().getInt32(p+12,!0),h=u,g=f;if(_)throw h=0,g=0,L(d);return o=h,c=g,tt(h,g)}finally{b.__wbindgen_add_to_stack_pointer(16),b.__wbindgen_free(o,c,1)}}getCursorPosition(e,n,r){try{const u=b.__wbindgen_add_to_stack_pointer(-16);b.automerge_getCursorPosition(u,this.__wbg_ptr,M(e),M(n),ye(r)?0:M(r));var i=E().getFloat64(u+0,!0),o=E().getInt32(u+8,!0),c=E().getInt32(u+12,!0);if(c)throw L(o);return i}finally{b.__wbindgen_add_to_stack_pointer(16)}}emptyChange(e,n){var r=ye(e)?0:ht(e,b.__wbindgen_malloc,b.__wbindgen_realloc),i=et;const o=b.automerge_emptyChange(this.__wbg_ptr,r,i,!ye(n),ye(n)?0:n);return L(o)}mark(e,n,r,i,o){try{const f=b.__wbindgen_add_to_stack_pointer(-16);b.automerge_mark(f,this.__wbg_ptr,M(e),M(n),M(r),M(i),M(o));var c=E().getInt32(f+0,!0),u=E().getInt32(f+4,!0);if(u)throw L(c)}finally{b.__wbindgen_add_to_stack_pointer(16)}}unmark(e,n,r){try{const c=b.__wbindgen_add_to_stack_pointer(-16);b.automerge_unmark(c,this.__wbg_ptr,M(e),M(n),M(r));var i=E().getInt32(c+0,!0),o=E().getInt32(c+4,!0);if(o)throw L(i)}finally{b.__wbindgen_add_to_stack_pointer(16)}}marks(e,n){try{const c=b.__wbindgen_add_to_stack_pointer(-16);b.automerge_marks(c,this.__wbg_ptr,M(e),ye(n)?0:M(n));var r=E().getInt32(c+0,!0),i=E().getInt32(c+4,!0),o=E().getInt32(c+8,!0);if(o)throw L(i);return L(r)}finally{b.__wbindgen_add_to_stack_pointer(16)}}marksAt(e,n,r){try{const u=b.__wbindgen_add_to_stack_pointer(-16);b.automerge_marksAt(u,this.__wbg_ptr,M(e),n,ye(r)?0:M(r));var i=E().getInt32(u+0,!0),o=E().getInt32(u+4,!0),c=E().getInt32(u+8,!0);if(c)throw L(o);return L(i)}finally{b.__wbindgen_add_to_stack_pointer(16)}}hasOurChanges(e){Vt(e,nt);const n=b.automerge_hasOurChanges(this.__wbg_ptr,e.__wbg_ptr);return L(n)}topoHistoryTraversal(){const e=b.automerge_topoHistoryTraversal(this.__wbg_ptr);return L(e)}stats(){const e=b.automerge_stats(this.__wbg_ptr);return L(e)}}const dc=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>b.__wbg_syncstate_free(t>>>0,1));class nt{static __wrap(e){e=e>>>0;const n=Object.create(nt.prototype);return n.__wbg_ptr=e,dc.register(n,n.__wbg_ptr,n),n}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,dc.unregister(this),e}free(){const e=this.__destroy_into_raw();b.__wbg_syncstate_free(e,0)}get sharedHeads(){const e=b.syncstate_sharedHeads(this.__wbg_ptr);return L(e)}get lastSentHeads(){const e=b.syncstate_lastSentHeads(this.__wbg_ptr);return L(e)}set lastSentHeads(e){try{const i=b.__wbindgen_add_to_stack_pointer(-16);b.syncstate_set_lastSentHeads(i,this.__wbg_ptr,M(e));var n=E().getInt32(i+0,!0),r=E().getInt32(i+4,!0);if(r)throw L(n)}finally{b.__wbindgen_add_to_stack_pointer(16)}}set sentHashes(e){try{const i=b.__wbindgen_add_to_stack_pointer(-16);b.syncstate_set_sentHashes(i,this.__wbg_ptr,M(e));var n=E().getInt32(i+0,!0),r=E().getInt32(i+4,!0);if(r)throw L(n)}finally{b.__wbindgen_add_to_stack_pointer(16)}}clone(){const e=b.syncstate_clone(this.__wbg_ptr);return nt.__wrap(e)}}function Pu(t,e){const n=String(X(e)),r=ht(n,b.__wbindgen_malloc,b.__wbindgen_realloc),i=et;E().setInt32(t+4,i,!0),E().setInt32(t+0,r,!0)}function Hu(){return At(function(t,e,n){const r=Reflect.apply(X(t),X(e),X(n));return M(r)},arguments)}function $u(t,e){const n=Object.assign(X(t),X(e));return M(n)}function Bu(t){const e=X(t).buffer;return M(e)}function Lu(){return At(function(t,e){const n=X(t).call(X(e));return M(n)},arguments)}function Fu(){return At(function(t,e,n){const r=X(t).call(X(e),X(n));return M(r)},arguments)}function Nu(t,e){const n=X(t).concat(X(e));return M(n)}function zu(t,e,n){const r=Object.defineProperty(X(t),X(e),X(n));return M(r)}function Vu(){return At(function(t,e){return Reflect.deleteProperty(X(t),X(e))},arguments)}function Wu(t){return X(t).done}function qu(t){const e=Object.entries(X(t));return M(e)}function Gu(t,e){let n,r;try{n=t,r=e,console.error(tt(t,e))}finally{b.__wbindgen_free(n,r,1)}}function Ju(t,e){const n=Symbol.for(tt(t,e));return M(n)}function Ku(t){const e=Object.freeze(X(t));return M(e)}function Yu(t){const e=Array.from(X(t));return M(e)}function Xu(){return At(function(t,e){globalThis.crypto.getRandomValues(y0(t,e))},arguments)}function Zu(t){return X(t).getTime()}function Qu(){return At(function(t,e){const n=Reflect.get(X(t),X(e));return M(n)},arguments)}function ef(t,e){const n=X(t)[e>>>0];return M(n)}function tf(t){let e;try{e=X(t)instanceof ArrayBuffer}catch{e=!1}return e}function nf(t){let e;try{e=X(t)instanceof Date}catch{e=!1}return e}function rf(t){let e;try{e=X(t)instanceof Object}catch{e=!1}return e}function sf(t){let e;try{e=X(t)instanceof Uint8Array}catch{e=!1}return e}function of(t){return Array.isArray(X(t))}function af(){return M(Symbol.iterator)}function cf(t){const e=Object.keys(X(t));return M(e)}function uf(t){return X(t).length}function ff(t){return X(t).length}function lf(t){return X(t).length}function df(t,e){console.log(X(t),X(e))}function hf(t){console.log(X(t))}function gf(t,e){const n=new RangeError(tt(t,e));return M(n)}function _f(t){const e=new Date(X(t));return M(e)}function pf(){const t=new Object;return M(t)}function yf(){const t=new Array;return M(t)}function mf(){const t=new Error;return M(t)}function bf(t){const e=new Uint8Array(X(t));return M(e)}function wf(t,e){const n=new Error(tt(t,e));return M(n)}function vf(t,e,n){const r=new Uint8Array(X(t),e>>>0,n>>>0);return M(r)}function Sf(t){const e=X(t).next;return M(e)}function xf(){return At(function(t){const e=X(t).next();return M(e)},arguments)}function Af(){return At(function(t){const e=Reflect.ownKeys(X(t));return M(e)},arguments)}function If(t,e){return X(t).push(X(e))}function Ef(t,e,n){X(t)[e>>>0]=L(n)}function kf(t,e,n){X(t)[L(e)]=L(n)}function Cf(t,e,n){X(t).set(X(e),n>>>0)}function Tf(){return At(function(t,e,n){return Reflect.set(X(t),X(e),X(n))},arguments)}function Of(t,e,n){const r=X(t).slice(e>>>0,n>>>0);return M(r)}function Rf(t,e){const n=X(e).stack,r=ht(n,b.__wbindgen_malloc,b.__wbindgen_realloc),i=et;E().setInt32(t+4,i,!0),E().setInt32(t+0,r,!0)}function Mf(t){const e=X(t).toString();return M(e)}function jf(t,e){return X(t).unshift(X(e))}function Df(t){const e=X(t).value;return M(e)}function Uf(t){const e=Object.values(X(t));return M(e)}function Pf(t){return M(t)}function Hf(t){const e=BigInt.asUintN(64,t);return M(e)}function $f(t){const e=X(t);return typeof e=="boolean"?e?1:0:2}function Bf(t,e){const n=Ui(X(e)),r=ht(n,b.__wbindgen_malloc,b.__wbindgen_realloc),i=et;E().setInt32(t+4,i,!0),E().setInt32(t+0,r,!0)}function Lf(t,e){const n=new Error(tt(t,e));return M(n)}function Ff(t){return Array.isArray(X(t))}function Nf(t){return typeof X(t)=="function"}function zf(t){return X(t)===null}function Vf(t){const e=X(t);return typeof e=="object"&&e!==null}function Wf(t){return typeof X(t)=="string"}function qf(t){return X(t)===void 0}function Gf(t,e){const n=X(e),r=JSON.stringify(n===void 0?null:n),i=ht(r,b.__wbindgen_malloc,b.__wbindgen_realloc),o=et;E().setInt32(t+4,o,!0),E().setInt32(t+0,i,!0)}function Jf(t,e){return X(t)==X(e)}function Kf(){const t=b.memory;return M(t)}function Yf(t,e){const n=X(e),r=typeof n=="number"?n:void 0;E().setFloat64(t+8,ye(r)?0:r,!0),E().setInt32(t+0,!ye(r),!0)}function Xf(t){return M(t)}function Zf(t){const e=X(t);return M(e)}function Qf(t){L(t)}function el(t,e){const n=X(e),r=typeof n=="string"?n:void 0;var i=ye(r)?0:ht(r,b.__wbindgen_malloc,b.__wbindgen_realloc),o=et;E().setInt32(t+4,o,!0),E().setInt32(t+0,i,!0)}function tl(t,e){const n=tt(t,e);return M(n)}function nl(t,e){throw new Error(tt(t,e))}URL=globalThis.URL;const G=await h0({"./automerge_wasm_bg.js":{__wbindgen_object_drop_ref:Qf,__wbindgen_string_get:el,__wbindgen_error_new:Lf,__wbindgen_string_new:tl,__wbindgen_number_new:Xf,__wbindgen_object_clone_ref:Zf,__wbindgen_number_get:Yf,__wbindgen_is_undefined:qf,__wbindgen_boolean_get:$f,__wbindgen_is_null:zf,__wbindgen_is_string:Wf,__wbindgen_is_function:Nf,__wbindgen_is_object:Vf,__wbindgen_is_array:Ff,__wbindgen_json_serialize:Gf,__wbg_new_8a6f238a6ece86ea:mf,__wbg_stack_0ed75d68575b0f3c:Rf,__wbg_error_7534b8e9a36f1ab4:Gu,__wbindgen_jsval_loose_eq:Jf,__wbg_String_fed4d24b68977888:Pu,__wbindgen_bigint_from_i64:Pf,__wbindgen_bigint_from_u64:Hf,__wbg_set_3fda3bac07393de4:kf,__wbg_getRandomValues_3d90134a348e46b3:Xu,__wbg_log_c222819a41e063d3:hf,__wbg_log_1ae1e9f741096e91:df,__wbg_get_b9b93047fe3cf45b:ef,__wbg_length_e2d2a49132c1b256:lf,__wbg_new_78feb108b6472713:yf,__wbg_next_25feadfc0913fea9:Sf,__wbg_next_6574e1a8a62d1055:xf,__wbg_done_769e5ede4b31c67b:Wu,__wbg_value_cd1ffa7b1ab794f1:Df,__wbg_iterator_9a24c88df860dc65:af,__wbg_get_67b2ba62fc30de12:Qu,__wbg_call_672a4d21634d4a24:Lu,__wbg_new_405e22f390576ce2:pf,__wbg_length_d56737991078581b:ff,__wbg_set_37837023f3d740e8:Ef,__wbg_from_2a5d3e218e67aa85:Yu,__wbg_isArray_a1eab7e0d067391b:of,__wbg_push_737cfc8c1432c2c6:If,__wbg_unshift_c290010f73f04fb1:jf,__wbg_instanceof_ArrayBuffer_e14585432e3737fc:tf,__wbg_new_c68d7209be747379:wf,__wbg_call_7cccdd69e0791ae2:Fu,__wbg_instanceof_Date_e9a9be8b9cea7890:nf,__wbg_getTime_46267b1c24877e30:Zu,__wbg_new_31a97dac4f10fab7:_f,__wbg_instanceof_Object_7f2dcef8f78644a4:rf,__wbg_assign_3627b8559449930a:$u,__wbg_defineProperty_a3ddad9901e2d29e:zu,__wbg_entries_3265d4158b33e5dc:qu,__wbg_freeze_ef6d70cf38e8d948:Ku,__wbg_keys_5c77a08ddc2fb8a6:cf,__wbg_values_fcb8ba8c0aad8b58:Uf,__wbg_new_1ab78df5e132f715:gf,__wbg_apply_eb9e9b97497f91e4:Hu,__wbg_deleteProperty_96363d4a1d977c97:Vu,__wbg_ownKeys_3930041068756f1f:Af,__wbg_set_bb8cecf6a62b9f46:Tf,__wbg_buffer_609cc3eee51ed158:Bu,__wbg_concat_9de968491c4340cf:Nu,__wbg_slice_972c243648c9fd2e:Of,__wbg_for_4ff07bddd743c5e7:Ju,__wbg_toString_66ab719c2a98bdf1:Mf,__wbg_newwithbyteoffsetandlength_d97e637ebe145a9a:vf,__wbg_new_a12002a7f91c75be:bf,__wbg_set_65595bdd868b3009:Cf,__wbg_length_a446193dc22c12f8:uf,__wbg_instanceof_Uint8Array_17156bcf118086a9:sf,__wbindgen_debug_string:Bf,__wbindgen_throw:nl,__wbindgen_memory:Kf}},d0),R0=G.memory,M0=G.__wbg_syncstate_free,j0=G.syncstate_sharedHeads,D0=G.syncstate_lastSentHeads,U0=G.syncstate_set_lastSentHeads,P0=G.syncstate_set_sentHashes,H0=G.syncstate_clone,$0=G.__wbg_automerge_free,B0=G.automerge_new,L0=G.automerge_clone,F0=G.automerge_fork,N0=G.automerge_pendingOps,z0=G.automerge_commit,V0=G.automerge_merge,W0=G.automerge_rollback,q0=G.automerge_keys,G0=G.automerge_text,J0=G.automerge_spans,K0=G.automerge_splice,Y0=G.automerge_updateText,X0=G.automerge_updateSpans,Z0=G.automerge_push,Q0=G.automerge_pushObject,ey=G.automerge_insert,ty=G.automerge_splitBlock,ny=G.automerge_joinBlock,ry=G.automerge_updateBlock,sy=G.automerge_getBlock,iy=G.automerge_insertObject,oy=G.automerge_put,ay=G.automerge_putObject,cy=G.automerge_increment,uy=G.automerge_get,fy=G.automerge_getWithType,ly=G.automerge_objInfo,dy=G.automerge_getAll,hy=G.automerge_enableFreeze,gy=G.automerge_registerDatatype,_y=G.automerge_applyPatches,py=G.automerge_applyAndReturnPatches,yy=G.automerge_diffIncremental,my=G.automerge_updateDiffCursor,by=G.automerge_resetDiffCursor,wy=G.automerge_diff,vy=G.automerge_isolate,Sy=G.automerge_integrate,xy=G.automerge_length,Ay=G.automerge_delete,Iy=G.automerge_save,Ey=G.automerge_saveIncremental,ky=G.automerge_saveSince,Cy=G.automerge_saveNoCompress,Ty=G.automerge_saveAndVerify,Oy=G.automerge_loadIncremental,Ry=G.automerge_applyChanges,My=G.automerge_getChanges,jy=G.automerge_getChangeByHash,Dy=G.automerge_getDecodedChangeByHash,Uy=G.automerge_getChangesAdded,Py=G.automerge_getHeads,Hy=G.automerge_getActorId,$y=G.automerge_getLastLocalChange,By=G.automerge_dump,Ly=G.automerge_getMissingDeps,Fy=G.automerge_receiveSyncMessage,Ny=G.automerge_generateSyncMessage,zy=G.automerge_toJS,Vy=G.automerge_materialize,Wy=G.automerge_getCursor,qy=G.automerge_getCursorPosition,Gy=G.automerge_emptyChange,Jy=G.automerge_mark,Ky=G.automerge_unmark,Yy=G.automerge_marks,Xy=G.automerge_marksAt,Zy=G.automerge_hasOurChanges,Qy=G.automerge_topoHistoryTraversal,em=G.automerge_stats,tm=G.create,nm=G.load,rm=G.encodeChange,sm=G.decodeChange,im=G.initSyncState,om=G.importSyncState,am=G.exportSyncState,cm=G.encodeSyncMessage,um=G.decodeSyncMessage,fm=G.encodeSyncState,lm=G.decodeSyncState,dm=G.__wbindgen_malloc,hm=G.__wbindgen_realloc,gm=G.__wbindgen_exn_store,_m=G.__wbindgen_free,pm=G.__wbindgen_add_to_stack_pointer,ym=Object.freeze(Object.defineProperty({__proto__:null,__wbg_automerge_free:$0,__wbg_syncstate_free:M0,__wbindgen_add_to_stack_pointer:pm,__wbindgen_exn_store:gm,__wbindgen_free:_m,__wbindgen_malloc:dm,__wbindgen_realloc:hm,automerge_applyAndReturnPatches:py,automerge_applyChanges:Ry,automerge_applyPatches:_y,automerge_clone:L0,automerge_commit:z0,automerge_delete:Ay,automerge_diff:wy,automerge_diffIncremental:yy,automerge_dump:By,automerge_emptyChange:Gy,automerge_enableFreeze:hy,automerge_fork:F0,automerge_generateSyncMessage:Ny,automerge_get:uy,automerge_getActorId:Hy,automerge_getAll:dy,automerge_getBlock:sy,automerge_getChangeByHash:jy,automerge_getChanges:My,automerge_getChangesAdded:Uy,automerge_getCursor:Wy,automerge_getCursorPosition:qy,automerge_getDecodedChangeByHash:Dy,automerge_getHeads:Py,automerge_getLastLocalChange:$y,automerge_getMissingDeps:Ly,automerge_getWithType:fy,automerge_hasOurChanges:Zy,automerge_increment:cy,automerge_insert:ey,automerge_insertObject:iy,automerge_integrate:Sy,automerge_isolate:vy,automerge_joinBlock:ny,automerge_keys:q0,automerge_length:xy,automerge_loadIncremental:Oy,automerge_mark:Jy,automerge_marks:Yy,automerge_marksAt:Xy,automerge_materialize:Vy,automerge_merge:V0,automerge_new:B0,automerge_objInfo:ly,automerge_pendingOps:N0,automerge_push:Z0,automerge_pushObject:Q0,automerge_put:oy,automerge_putObject:ay,automerge_receiveSyncMessage:Fy,automerge_registerDatatype:gy,automerge_resetDiffCursor:by,automerge_rollback:W0,automerge_save:Iy,automerge_saveAndVerify:Ty,automerge_saveIncremental:Ey,automerge_saveNoCompress:Cy,automerge_saveSince:ky,automerge_spans:J0,automerge_splice:K0,automerge_splitBlock:ty,automerge_stats:em,automerge_text:G0,automerge_toJS:zy,automerge_topoHistoryTraversal:Qy,automerge_unmark:Ky,automerge_updateBlock:ry,automerge_updateDiffCursor:my,automerge_updateSpans:X0,automerge_updateText:Y0,create:tm,decodeChange:sm,decodeSyncMessage:um,decodeSyncState:lm,encodeChange:rm,encodeSyncMessage:cm,encodeSyncState:fm,exportSyncState:am,importSyncState:om,initSyncState:im,load:nm,memory:R0,syncstate_clone:H0,syncstate_lastSentHeads:D0,syncstate_set_lastSentHeads:U0,syncstate_set_sentHashes:P0,syncstate_sharedHeads:j0},Symbol.toStringTag,{value:"Module"}));Du(ym);const mm=Object.freeze(Object.defineProperty({__proto__:null,Automerge:ft,SyncState:nt,TextRepresentation:O0,__wbg_String_fed4d24b68977888:Pu,__wbg_apply_eb9e9b97497f91e4:Hu,__wbg_assign_3627b8559449930a:$u,__wbg_buffer_609cc3eee51ed158:Bu,__wbg_call_672a4d21634d4a24:Lu,__wbg_call_7cccdd69e0791ae2:Fu,__wbg_concat_9de968491c4340cf:Nu,__wbg_defineProperty_a3ddad9901e2d29e:zu,__wbg_deleteProperty_96363d4a1d977c97:Vu,__wbg_done_769e5ede4b31c67b:Wu,__wbg_entries_3265d4158b33e5dc:qu,__wbg_error_7534b8e9a36f1ab4:Gu,__wbg_for_4ff07bddd743c5e7:Ju,__wbg_freeze_ef6d70cf38e8d948:Ku,__wbg_from_2a5d3e218e67aa85:Yu,__wbg_getRandomValues_3d90134a348e46b3:Xu,__wbg_getTime_46267b1c24877e30:Zu,__wbg_get_67b2ba62fc30de12:Qu,__wbg_get_b9b93047fe3cf45b:ef,__wbg_instanceof_ArrayBuffer_e14585432e3737fc:tf,__wbg_instanceof_Date_e9a9be8b9cea7890:nf,__wbg_instanceof_Object_7f2dcef8f78644a4:rf,__wbg_instanceof_Uint8Array_17156bcf118086a9:sf,__wbg_isArray_a1eab7e0d067391b:of,__wbg_iterator_9a24c88df860dc65:af,__wbg_keys_5c77a08ddc2fb8a6:cf,__wbg_length_a446193dc22c12f8:uf,__wbg_length_d56737991078581b:ff,__wbg_length_e2d2a49132c1b256:lf,__wbg_log_1ae1e9f741096e91:df,__wbg_log_c222819a41e063d3:hf,__wbg_new_1ab78df5e132f715:gf,__wbg_new_31a97dac4f10fab7:_f,__wbg_new_405e22f390576ce2:pf,__wbg_new_78feb108b6472713:yf,__wbg_new_8a6f238a6ece86ea:mf,__wbg_new_a12002a7f91c75be:bf,__wbg_new_c68d7209be747379:wf,__wbg_newwithbyteoffsetandlength_d97e637ebe145a9a:vf,__wbg_next_25feadfc0913fea9:Sf,__wbg_next_6574e1a8a62d1055:xf,__wbg_ownKeys_3930041068756f1f:Af,__wbg_push_737cfc8c1432c2c6:If,__wbg_set_37837023f3d740e8:Ef,__wbg_set_3fda3bac07393de4:kf,__wbg_set_65595bdd868b3009:Cf,__wbg_set_bb8cecf6a62b9f46:Tf,__wbg_set_wasm:Du,__wbg_slice_972c243648c9fd2e:Of,__wbg_stack_0ed75d68575b0f3c:Rf,__wbg_toString_66ab719c2a98bdf1:Mf,__wbg_unshift_c290010f73f04fb1:jf,__wbg_value_cd1ffa7b1ab794f1:Df,__wbg_values_fcb8ba8c0aad8b58:Uf,__wbindgen_bigint_from_i64:Pf,__wbindgen_bigint_from_u64:Hf,__wbindgen_boolean_get:$f,__wbindgen_debug_string:Bf,__wbindgen_error_new:Lf,__wbindgen_is_array:Ff,__wbindgen_is_function:Nf,__wbindgen_is_null:zf,__wbindgen_is_object:Vf,__wbindgen_is_string:Wf,__wbindgen_is_undefined:qf,__wbindgen_json_serialize:Gf,__wbindgen_jsval_loose_eq:Jf,__wbindgen_memory:Kf,__wbindgen_number_get:Yf,__wbindgen_number_new:Xf,__wbindgen_object_clone_ref:Zf,__wbindgen_object_drop_ref:Qf,__wbindgen_string_get:el,__wbindgen_string_new:tl,__wbindgen_throw:nl,create:b0,decodeChange:S0,decodeSyncMessage:k0,decodeSyncState:T0,encodeChange:v0,encodeSyncMessage:E0,encodeSyncState:C0,exportSyncState:I0,importSyncState:A0,initSyncState:x0,load:w0},Symbol.toStringTag,{value:"Module"}));yg(mm);var di={exports:{}},ce={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hc;function bm(){if(hc)return ce;hc=1;var t=Symbol.for("react.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),h=Symbol.iterator;function g(w){return w===null||typeof w!="object"?null:(w=h&&w[h]||w["@@iterator"],typeof w=="function"?w:null)}var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,v={};function I(w,R,q){this.props=w,this.context=R,this.refs=v,this.updater=q||p}I.prototype.isReactComponent={},I.prototype.setState=function(w,R){if(typeof w!="object"&&typeof w!="function"&&w!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,w,R,"setState")},I.prototype.forceUpdate=function(w){this.updater.enqueueForceUpdate(this,w,"forceUpdate")};function $(){}$.prototype=I.prototype;function D(w,R,q){this.props=w,this.context=R,this.refs=v,this.updater=q||p}var k=D.prototype=new $;k.constructor=D,m(k,I.prototype),k.isPureReactComponent=!0;var Y=Array.isArray,z=Object.prototype.hasOwnProperty,J={current:null},te={key:!0,ref:!0,__self:!0,__source:!0};function Z(w,R,q){var ie,ue={},le=null,de=null;if(R!=null)for(ie in R.ref!==void 0&&(de=R.ref),R.key!==void 0&&(le=""+R.key),R)z.call(R,ie)&&!te.hasOwnProperty(ie)&&(ue[ie]=R[ie]);var ge=arguments.length-2;if(ge===1)ue.children=q;else if(1<ge){for(var _e=Array(ge),Ae=0;Ae<ge;Ae++)_e[Ae]=arguments[Ae+2];ue.children=_e}if(w&&w.defaultProps)for(ie in ge=w.defaultProps,ge)ue[ie]===void 0&&(ue[ie]=ge[ie]);return{$$typeof:t,type:w,key:le,ref:de,props:ue,_owner:J.current}}function F(w,R){return{$$typeof:t,type:w.type,key:R,ref:w.ref,props:w.props,_owner:w._owner}}function V(w){return typeof w=="object"&&w!==null&&w.$$typeof===t}function K(w){var R={"=":"=0",":":"=2"};return"$"+w.replace(/[=:]/g,function(q){return R[q]})}var se=/\/+/g;function S(w,R){return typeof w=="object"&&w!==null&&w.key!=null?K(""+w.key):R.toString(36)}function W(w,R,q,ie,ue){var le=typeof w;(le==="undefined"||le==="boolean")&&(w=null);var de=!1;if(w===null)de=!0;else switch(le){case"string":case"number":de=!0;break;case"object":switch(w.$$typeof){case t:case e:de=!0}}if(de)return de=w,ue=ue(de),w=ie===""?"."+S(de,0):ie,Y(ue)?(q="",w!=null&&(q=w.replace(se,"$&/")+"/"),W(ue,R,q,"",function(Ae){return Ae})):ue!=null&&(V(ue)&&(ue=F(ue,q+(!ue.key||de&&de.key===ue.key?"":(""+ue.key).replace(se,"$&/")+"/")+w)),R.push(ue)),1;if(de=0,ie=ie===""?".":ie+":",Y(w))for(var ge=0;ge<w.length;ge++){le=w[ge];var _e=ie+S(le,ge);de+=W(le,R,q,_e,ue)}else if(_e=g(w),typeof _e=="function")for(w=_e.call(w),ge=0;!(le=w.next()).done;)le=le.value,_e=ie+S(le,ge++),de+=W(le,R,q,_e,ue);else if(le==="object")throw R=String(w),Error("Objects are not valid as a React child (found: "+(R==="[object Object]"?"object with keys {"+Object.keys(w).join(", ")+"}":R)+"). If you meant to render a collection of children, use an array instead.");return de}function P(w,R,q){if(w==null)return w;var ie=[],ue=0;return W(w,ie,"","",function(le){return R.call(q,le,ue++)}),ie}function B(w){if(w._status===-1){var R=w._result;R=R(),R.then(function(q){(w._status===0||w._status===-1)&&(w._status=1,w._result=q)},function(q){(w._status===0||w._status===-1)&&(w._status=2,w._result=q)}),w._status===-1&&(w._status=0,w._result=R)}if(w._status===1)return w._result.default;throw w._result}var U={current:null},Q={transition:null},C={ReactCurrentDispatcher:U,ReactCurrentBatchConfig:Q,ReactCurrentOwner:J};function N(){throw Error("act(...) is not supported in production builds of React.")}return ce.Children={map:P,forEach:function(w,R,q){P(w,function(){R.apply(this,arguments)},q)},count:function(w){var R=0;return P(w,function(){R++}),R},toArray:function(w){return P(w,function(R){return R})||[]},only:function(w){if(!V(w))throw Error("React.Children.only expected to receive a single React element child.");return w}},ce.Component=I,ce.Fragment=n,ce.Profiler=i,ce.PureComponent=D,ce.StrictMode=r,ce.Suspense=f,ce.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=C,ce.act=N,ce.cloneElement=function(w,R,q){if(w==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+w+".");var ie=m({},w.props),ue=w.key,le=w.ref,de=w._owner;if(R!=null){if(R.ref!==void 0&&(le=R.ref,de=J.current),R.key!==void 0&&(ue=""+R.key),w.type&&w.type.defaultProps)var ge=w.type.defaultProps;for(_e in R)z.call(R,_e)&&!te.hasOwnProperty(_e)&&(ie[_e]=R[_e]===void 0&&ge!==void 0?ge[_e]:R[_e])}var _e=arguments.length-2;if(_e===1)ie.children=q;else if(1<_e){ge=Array(_e);for(var Ae=0;Ae<_e;Ae++)ge[Ae]=arguments[Ae+2];ie.children=ge}return{$$typeof:t,type:w.type,key:ue,ref:le,props:ie,_owner:de}},ce.createContext=function(w){return w={$$typeof:c,_currentValue:w,_currentValue2:w,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},w.Provider={$$typeof:o,_context:w},w.Consumer=w},ce.createElement=Z,ce.createFactory=function(w){var R=Z.bind(null,w);return R.type=w,R},ce.createRef=function(){return{current:null}},ce.forwardRef=function(w){return{$$typeof:u,render:w}},ce.isValidElement=V,ce.lazy=function(w){return{$$typeof:_,_payload:{_status:-1,_result:w},_init:B}},ce.memo=function(w,R){return{$$typeof:d,type:w,compare:R===void 0?null:R}},ce.startTransition=function(w){var R=Q.transition;Q.transition={};try{w()}finally{Q.transition=R}},ce.unstable_act=N,ce.useCallback=function(w,R){return U.current.useCallback(w,R)},ce.useContext=function(w){return U.current.useContext(w)},ce.useDebugValue=function(){},ce.useDeferredValue=function(w){return U.current.useDeferredValue(w)},ce.useEffect=function(w,R){return U.current.useEffect(w,R)},ce.useId=function(){return U.current.useId()},ce.useImperativeHandle=function(w,R,q){return U.current.useImperativeHandle(w,R,q)},ce.useInsertionEffect=function(w,R){return U.current.useInsertionEffect(w,R)},ce.useLayoutEffect=function(w,R){return U.current.useLayoutEffect(w,R)},ce.useMemo=function(w,R){return U.current.useMemo(w,R)},ce.useReducer=function(w,R,q){return U.current.useReducer(w,R,q)},ce.useRef=function(w){return U.current.useRef(w)},ce.useState=function(w){return U.current.useState(w)},ce.useSyncExternalStore=function(w,R,q){return U.current.useSyncExternalStore(w,R,q)},ce.useTransition=function(){return U.current.useTransition()},ce.version="18.3.1",ce}var gc;function wm(){return gc||(gc=1,di.exports=bm()),di.exports}var vm=wm();vm.createContext(null);function Sm(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var _c={exports:{}},pc;function xm(){return pc||(pc=1,function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function i(f,d,_){this.fn=f,this.context=d,this.once=_||!1}function o(f,d,_,h,g){if(typeof _!="function")throw new TypeError("The listener must be a function");var p=new i(_,h||f,g),m=n?n+d:d;return f._events[m]?f._events[m].fn?f._events[m]=[f._events[m],p]:f._events[m].push(p):(f._events[m]=p,f._eventsCount++),f}function c(f,d){--f._eventsCount===0?f._events=new r:delete f._events[d]}function u(){this._events=new r,this._eventsCount=0}u.prototype.eventNames=function(){var f=[],d,_;if(this._eventsCount===0)return f;for(_ in d=this._events)e.call(d,_)&&f.push(n?_.slice(1):_);return Object.getOwnPropertySymbols?f.concat(Object.getOwnPropertySymbols(d)):f},u.prototype.listeners=function(f){var d=n?n+f:f,_=this._events[d];if(!_)return[];if(_.fn)return[_.fn];for(var h=0,g=_.length,p=new Array(g);h<g;h++)p[h]=_[h].fn;return p},u.prototype.listenerCount=function(f){var d=n?n+f:f,_=this._events[d];return _?_.fn?1:_.length:0},u.prototype.emit=function(f,d,_,h,g,p){var m=n?n+f:f;if(!this._events[m])return!1;var v=this._events[m],I=arguments.length,$,D;if(v.fn){switch(v.once&&this.removeListener(f,v.fn,void 0,!0),I){case 1:return v.fn.call(v.context),!0;case 2:return v.fn.call(v.context,d),!0;case 3:return v.fn.call(v.context,d,_),!0;case 4:return v.fn.call(v.context,d,_,h),!0;case 5:return v.fn.call(v.context,d,_,h,g),!0;case 6:return v.fn.call(v.context,d,_,h,g,p),!0}for(D=1,$=new Array(I-1);D<I;D++)$[D-1]=arguments[D];v.fn.apply(v.context,$)}else{var k=v.length,Y;for(D=0;D<k;D++)switch(v[D].once&&this.removeListener(f,v[D].fn,void 0,!0),I){case 1:v[D].fn.call(v[D].context);break;case 2:v[D].fn.call(v[D].context,d);break;case 3:v[D].fn.call(v[D].context,d,_);break;case 4:v[D].fn.call(v[D].context,d,_,h);break;default:if(!$)for(Y=1,$=new Array(I-1);Y<I;Y++)$[Y-1]=arguments[Y];v[D].fn.apply(v[D].context,$)}}return!0},u.prototype.on=function(f,d,_){return o(this,f,d,_,!1)},u.prototype.once=function(f,d,_){return o(this,f,d,_,!0)},u.prototype.removeListener=function(f,d,_,h){var g=n?n+f:f;if(!this._events[g])return this;if(!d)return c(this,g),this;var p=this._events[g];if(p.fn)p.fn===d&&(!h||p.once)&&(!_||p.context===_)&&c(this,g);else{for(var m=0,v=[],I=p.length;m<I;m++)(p[m].fn!==d||h&&!p[m].once||_&&p[m].context!==_)&&v.push(p[m]);v.length?this._events[g]=v.length===1?v[0]:v:c(this,g)}return this},u.prototype.removeAllListeners=function(f){var d;return f?(d=n?n+f:f,this._events[d]&&c(this,d)):(this._events=new r,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=n,u.EventEmitter=u,t.exports=u}(_c)),_c.exports}var Am=xm();const Im=Sm(Am);new Im;class Em extends ju{#e;#t=!1;#r;#n=!1;#s;#i=new Promise(e=>{this.#s=e});#c=[];isReady(){return this.#n}whenReady(){return this.#i}#a(){this.#n||(this.#n=!0,this.#s?.())}constructor(e){super(),this.#r={channelName:"broadcast",...e??{}},this.#e=new BroadcastChannel(this.#r.channelName)}connect(e,n){this.peerId=e,this.peerMetadata=n,this.#t=!1,this.#e.addEventListener("message",r=>{const i=r.data;if("targetId"in i&&i.targetId!==this.peerId||this.#t)return;const{senderId:o,type:c}=i;switch(c){case"arrive":{const{peerMetadata:u}=i;this.#e.postMessage({senderId:this.peerId,targetId:o,type:"welcome",peerMetadata:this.peerMetadata}),this.#o(o,u)}break;case"welcome":{const{peerMetadata:u}=i;this.#o(o,u)}break;case"leave":this.#c=this.#c.filter(u=>u!==o),this.emit("peer-disconnected",{peerId:o});break;default:if(!("data"in i))this.emit("message",i);else{if(!i.data)throw new Error("We got a message without data, we can't send this.");const u=i.data;this.emit("message",{...i,data:new Uint8Array(u)})}break}}),this.#e.postMessage({senderId:this.peerId,type:"arrive",peerMetadata:n})}#o(e,n){this.#a(),this.#c.push(e),this.emit("peer-candidate",{peerId:e,peerMetadata:n})}send(e){if(this.#t)return!1;"data"in e?this.#e.postMessage({...e,data:e.data?e.data.buffer.slice(e.data.byteOffset,e.data.byteOffset+e.data.byteLength):void 0}):this.#e.postMessage(e)}disconnect(){this.#e.postMessage({senderId:this.peerId,type:"leave"});for(const e of this.#c)this.emit("peer-disconnected",{peerId:e});this.#t=!0}}var hi={exports:{}},yc;function km(){return yc||(yc=1,function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function i(f,d,_){this.fn=f,this.context=d,this.once=_||!1}function o(f,d,_,h,g){if(typeof _!="function")throw new TypeError("The listener must be a function");var p=new i(_,h||f,g),m=n?n+d:d;return f._events[m]?f._events[m].fn?f._events[m]=[f._events[m],p]:f._events[m].push(p):(f._events[m]=p,f._eventsCount++),f}function c(f,d){--f._eventsCount===0?f._events=new r:delete f._events[d]}function u(){this._events=new r,this._eventsCount=0}u.prototype.eventNames=function(){var d=[],_,h;if(this._eventsCount===0)return d;for(h in _=this._events)e.call(_,h)&&d.push(n?h.slice(1):h);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(_)):d},u.prototype.listeners=function(d){var _=n?n+d:d,h=this._events[_];if(!h)return[];if(h.fn)return[h.fn];for(var g=0,p=h.length,m=new Array(p);g<p;g++)m[g]=h[g].fn;return m},u.prototype.listenerCount=function(d){var _=n?n+d:d,h=this._events[_];return h?h.fn?1:h.length:0},u.prototype.emit=function(d,_,h,g,p,m){var v=n?n+d:d;if(!this._events[v])return!1;var I=this._events[v],$=arguments.length,D,k;if(I.fn){switch(I.once&&this.removeListener(d,I.fn,void 0,!0),$){case 1:return I.fn.call(I.context),!0;case 2:return I.fn.call(I.context,_),!0;case 3:return I.fn.call(I.context,_,h),!0;case 4:return I.fn.call(I.context,_,h,g),!0;case 5:return I.fn.call(I.context,_,h,g,p),!0;case 6:return I.fn.call(I.context,_,h,g,p,m),!0}for(k=1,D=new Array($-1);k<$;k++)D[k-1]=arguments[k];I.fn.apply(I.context,D)}else{var Y=I.length,z;for(k=0;k<Y;k++)switch(I[k].once&&this.removeListener(d,I[k].fn,void 0,!0),$){case 1:I[k].fn.call(I[k].context);break;case 2:I[k].fn.call(I[k].context,_);break;case 3:I[k].fn.call(I[k].context,_,h);break;case 4:I[k].fn.call(I[k].context,_,h,g);break;default:if(!D)for(z=1,D=new Array($-1);z<$;z++)D[z-1]=arguments[z];I[k].fn.apply(I[k].context,D)}}return!0},u.prototype.on=function(d,_,h){return o(this,d,_,h,!1)},u.prototype.once=function(d,_,h){return o(this,d,_,h,!0)},u.prototype.removeListener=function(d,_,h,g){var p=n?n+d:d;if(!this._events[p])return this;if(!_)return c(this,p),this;var m=this._events[p];if(m.fn)m.fn===_&&(!g||m.once)&&(!h||m.context===h)&&c(this,p);else{for(var v=0,I=[],$=m.length;v<$;v++)(m[v].fn!==_||g&&!m[v].once||h&&m[v].context!==h)&&I.push(m[v]);I.length?this._events[p]=I.length===1?I[0]:I:c(this,p)}return this},u.prototype.removeAllListeners=function(d){var _;return d?(_=n?n+d:d,this._events[_]&&c(this,_)):(this._events=new r,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=n,u.EventEmitter=u,t.exports=u}(hi)),hi.exports}km();gt("automerge-repo:messagechannel");var wn=null;typeof WebSocket<"u"?wn=WebSocket:typeof MozWebSocket<"u"?wn=MozWebSocket:typeof global<"u"?wn=global.WebSocket||global.MozWebSocket:typeof window<"u"?wn=window.WebSocket||window.MozWebSocket:typeof self<"u"&&(wn=self.WebSocket||self.MozWebSocket);const gi=wn,Cm=t=>t.type==="peer",Tm=t=>t.type==="error",Om="1";function bt(t,e="Assertion failed"){if(t===!1||t===null||t===void 0){const n=new Error(Rm(e));throw n.stack=Mm(n.stack,"assert.ts"),n}}const Rm=t=>t.split(`
`).map(e=>e.trim()).join(`
`),Mm=(t="",e)=>t.split(`
`).filter(n=>!n.includes(e)).join(`
`),jm=t=>{const{buffer:e,byteOffset:n,byteLength:r}=t;return e.slice(n,n+r)};class Dm extends ju{socket}class Um extends Dm{url;retryInterval;#e=!1;#t;#r=new Promise(e=>{this.#t=e});isReady(){return this.#e}whenReady(){return this.#r}#n(){this.#e||(this.#e=!0,this.#t?.())}#s;#i=gt("automerge-repo:websocket:browser");remotePeerId;constructor(e,n=5e3){super(),this.url=e,this.retryInterval=n,this.#i=this.#i.extend(e)}connect(e,n){!this.socket||!this.peerId?(this.#i("connecting"),this.peerId=e,this.peerMetadata=n??{}):(this.#i("reconnecting"),bt(e===this.peerId),this.socket.removeEventListener("open",this.onOpen),this.socket.removeEventListener("close",this.onClose),this.socket.removeEventListener("message",this.onMessage),this.socket.removeEventListener("error",this.onError)),this.#s||(this.#s=setInterval(()=>{this.connect(e,n)},this.retryInterval)),this.socket=new gi(this.url),this.socket.binaryType="arraybuffer",this.socket.addEventListener("open",this.onOpen),this.socket.addEventListener("close",this.onClose),this.socket.addEventListener("message",this.onMessage),this.socket.addEventListener("error",this.onError),setTimeout(()=>this.#n(),1e3),this.join()}onOpen=()=>{this.#i("open"),clearInterval(this.#s),this.#s=void 0,this.join()};onClose=()=>{this.#i("close"),this.remotePeerId&&this.emit("peer-disconnected",{peerId:this.remotePeerId}),this.retryInterval>0&&!this.#s&&setTimeout(()=>(bt(this.peerId),this.connect(this.peerId,this.peerMetadata)),this.retryInterval)};onMessage=e=>{this.receiveMessage(e.data)};onError=e=>{if("error"in e&&e.error.code!=="ECONNREFUSED")throw e.error;this.#i("Connection failed, retrying...")};join(){bt(this.peerId),bt(this.socket),this.socket.readyState===gi.OPEN&&this.send(Pm(this.peerId,this.peerMetadata))}disconnect(){bt(this.peerId),bt(this.socket);const e=this.socket;e&&(e.removeEventListener("open",this.onOpen),e.removeEventListener("close",this.onClose),e.removeEventListener("message",this.onMessage),e.removeEventListener("error",this.onError),e.close()),clearInterval(this.#s),this.remotePeerId&&this.emit("peer-disconnected",{peerId:this.remotePeerId}),this.socket=void 0}send(e){if("data"in e&&e.data?.byteLength===0)throw new Error("Tried to send a zero-length message");if(bt(this.peerId),!this.socket){this.#i("Tried to send on a disconnected socket.");return}if(this.socket.readyState!==gi.OPEN)throw new Error(`Websocket not ready (${this.socket.readyState})`);const n=ku(e);this.socket.send(jm(n))}peerCandidate(e,n){bt(this.socket),this.#n(),this.remotePeerId=e,this.emit("peer-candidate",{peerId:e,peerMetadata:n})}receiveMessage(e){let n;try{n=Pp(new Uint8Array(e))}catch(r){this.#i("error decoding message:",r);return}if(bt(this.socket),e.byteLength===0)throw new Error("received a zero-length message");if(Cm(n)){const{peerMetadata:r}=n;this.#i(`peer: ${n.senderId}`),this.peerCandidate(n.senderId,r)}else Tm(n)?this.#i(`error: ${n.message}`):this.emit("message",n)}}function Pm(t,e){return{type:"join",senderId:t,peerMetadata:e,supportedProtocolVersions:[Om]}}gt("WebsocketServer");class Hm{database;store;dbPromise;constructor(e="automerge",n="documents"){this.database=e,this.store=n,this.dbPromise=this.createDatabasePromise()}createDatabasePromise(){return new Promise((e,n)=>{const r=indexedDB.open(this.database,1);r.onerror=()=>{n(r.error)},r.onupgradeneeded=i=>{i.target.result.createObjectStore(this.store)},r.onsuccess=i=>{const o=i.target.result;e(o)}})}async load(e){const r=(await this.dbPromise).transaction(this.store),o=r.objectStore(this.store).get(e);return new Promise((c,u)=>{r.onerror=()=>{u(o.error)},o.onsuccess=f=>{const d=f.target.result;d&&typeof d=="object"&&"binary"in d?c(d.binary):c(void 0)}})}async save(e,n){const i=(await this.dbPromise).transaction(this.store,"readwrite");return i.objectStore(this.store).put({key:e,binary:n},e),new Promise((c,u)=>{i.onerror=()=>{u(i.error)},i.oncomplete=()=>{c()}})}async remove(e){const r=(await this.dbPromise).transaction(this.store,"readwrite");return r.objectStore(this.store).delete(e),new Promise((o,c)=>{r.onerror=()=>{c(r.error)},r.oncomplete=()=>{o()}})}async loadRange(e){const n=await this.dbPromise,r=e,i=[...e,"￿"],o=IDBKeyRange.bound(r,i),c=n.transaction(this.store),f=c.objectStore(this.store).openCursor(o),d=[];return new Promise((_,h)=>{c.onerror=()=>{h(f.error)},f.onsuccess=g=>{const p=g.target.result;p?(d.push({data:p.value.binary,key:p.key}),p.continue()):_(d)}})}async removeRange(e){const n=await this.dbPromise,r=e,i=[...e,"￿"],o=IDBKeyRange.bound(r,i),c=n.transaction(this.store,"readwrite");return c.objectStore(this.store).delete(o),new Promise((f,d)=>{c.onerror=()=>{d(c.error)},c.oncomplete=()=>{f()}})}}const rl=typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{};(function(){var t=Object.defineProperty;function e(s){s=[typeof globalThis=="object"&&globalThis,s,typeof window=="object"&&window,typeof self=="object"&&self,typeof global=="object"&&global];for(var a=0;a<s.length;++a){var l=s[a];if(l&&l.Math==Math)return l}throw Error("Cannot find global object")}var n=e(this);function r(s,a){if(a)e:{var l=n;s=s.split(".");for(var y=0;y<s.length-1;y++){var A=s[y];if(!(A in l))break e;l=l[A]}s=s[s.length-1],y=l[s],a=a(y),a!=y&&a!=null&&t(l,s,{configurable:!0,writable:!0,value:a})}}r("Symbol.dispose",function(s){return s||Symbol("Symbol.dispose")});var i=this||self;function o(s,a){var l=Array.prototype.slice.call(arguments,1);return function(){var y=l.slice();return y.push.apply(y,arguments),s.apply(this,y)}}function c(s,a){function l(){}l.prototype=a.prototype,s.qa=a.prototype,s.prototype=new l,s.prototype.constructor=s,s.oa=function(y,A,j){for(var O=Array(arguments.length-2),re=2;re<arguments.length;re++)O[re-2]=arguments[re];return a.prototype[A].apply(y,O)}}function u(s,a){if(Error.captureStackTrace)Error.captureStackTrace(this,u);else{const l=Error().stack;l&&(this.stack=l)}s&&(this.message=String(s)),a!==void 0&&(this.cause=a)}c(u,Error),u.prototype.name="CustomError";function f(s){i.setTimeout(()=>{throw s},0)}var d,_;e:{for(var h=["CLOSURE_FLAGS"],g=i,p=0;p<h.length;p++)if(g=g[h[p]],g==null){_=null;break e}_=g}var m=_&&_[610401301];d=m??!1;var v;const I=i.navigator;v=I&&I.userAgentData||null;function $(s){return d&&v?v.brands.some(({brand:a})=>a&&a.indexOf(s)!=-1):!1}function D(s){var a;e:{if((a=i.navigator)&&(a=a.userAgent))break e;a=""}return a.indexOf(s)!=-1}function k(){return d?!!v&&v.brands.length>0:!1}function Y(){return k()?$("Chromium"):(D("Chrome")||D("CriOS"))&&!(!k()&&D("Edge"))||D("Silk")}function z(s,a){a=Array.prototype.indexOf.call(s,a,void 0),a>=0&&Array.prototype.splice.call(s,a,1)}!D("Android")||Y(),Y(),D("Safari")&&(Y()||!k()&&D("Coast")||!k()&&D("Opera")||!k()&&D("Edge")||(k()?$("Microsoft Edge"):D("Edg/"))||k()&&$("Opera"));function J(s){let a="",l=0;const y=s.length-10240;for(;l<y;)a+=String.fromCharCode.apply(null,s.subarray(l,l+=10240));return a+=String.fromCharCode.apply(null,l?s.subarray(l):s),btoa(a)}const te=/[-_.]/g,Z={"-":"+",_:"/",".":"="};function F(s){return Z[s]||""}function V(s){return s!=null&&s instanceof Uint8Array}var K={};function se(){return W||(W=new S(null,K))}var S=class{constructor(s,a){if(P(a),this.g=s,s!=null&&s.length===0)throw Error("ByteString should be constructed with non-empty values")}};let W;function P(s){if(s!==K)throw Error("illegal external caller")}function B(s,a){s.__closure__error__context__984382||(s.__closure__error__context__984382={}),s.__closure__error__context__984382.severity=a}let U;function Q(){const s=Error();B(s,"incident"),f(s)}function C(s){return s=Error(s),B(s,"warning"),s}function N(){return typeof BigInt=="function"}function w(s){return Array.prototype.slice.call(s)}function R(s,a){return a&&Symbol.for&&s?Symbol.for(s):s!=null?Symbol(s):Symbol()}var q=R("jas",!0),ie=R(),ue=R();function le(s,a){a[q]=(s|0)&-30975}function de(s,a){a[q]=(s|34)&-30941}var ge={},_e={};function Ae(s){return!(!s||typeof s!="object"||s.g!==_e)}function jt(s){return s!==null&&typeof s=="object"&&!Array.isArray(s)&&s.constructor===Object}function er(s,a){if(s!=null){if(typeof s=="string")s=s?new S(s,K):se();else if(s.constructor!==S)if(V(s))s=s.length?new S(new Uint8Array(s),K):se();else{if(!a)throw Error();s=void 0}}return s}function Dt(s){return!Array.isArray(s)||s.length?!1:!!((s[q]|0)&1)}var no;const ro=[];ro[q]=55,no=Object.freeze(ro);function tr(s){if(s&2)throw Error()}var sl=Object.freeze({});function nr(s){return s.pa=!0,s}var il=nr(s=>typeof s=="number"),so=nr(s=>typeof s=="string"),ol=nr(s=>typeof s=="boolean"),rr=typeof i.BigInt=="function"&&typeof i.BigInt(0)=="bigint",ss=nr(s=>rr?s>=cl&&s<=fl:s[0]==="-"?io(s,al):io(s,ul));const al=Number.MIN_SAFE_INTEGER.toString(),cl=rr?BigInt(Number.MIN_SAFE_INTEGER):void 0,ul=Number.MAX_SAFE_INTEGER.toString(),fl=rr?BigInt(Number.MAX_SAFE_INTEGER):void 0;function io(s,a){if(s.length>a.length)return!1;if(s.length<a.length||s===a)return!0;for(let l=0;l<s.length;l++){const y=s[l],A=a[l];if(y>A)return!1;if(y<A)return!0}}let He=0,Ge=0;function oo(s){const a=s>>>0;He=a,Ge=(s-a)/4294967296>>>0}function ao(s){if(s<0){oo(-s);const[a,l]=os(He,Ge);He=a>>>0,Ge=l>>>0}else oo(s)}function is(s,a){if(a>>>=0,s>>>=0,a<=2097151)var l=""+(4294967296*a+s);else N()?l=""+(BigInt(a)<<BigInt(32)|BigInt(s)):(l=(s>>>24|a<<8)&16777215,a=a>>16&65535,s=(s&16777215)+l*6777216+a*6710656,l+=a*8147497,a*=2,s>=1e7&&(l+=s/1e7>>>0,s%=1e7),l>=1e7&&(a+=l/1e7>>>0,l%=1e7),l=a+co(l)+co(s));return l}function co(s){return s=String(s),"0000000".slice(s.length)+s}function os(s,a){return a=~a,s?s=~s+1:a+=1,[s,a]}function uo(s){if(s==null||typeof s=="boolean")return s;if(typeof s=="number")return!!s}const ll=/^-?([1-9][0-9]*|0)(\.[0-9]+)?$/;function fo(s){const a=typeof s;switch(a){case"bigint":return!0;case"number":return Number.isFinite(s)}return a!=="string"?!1:ll.test(s)}function It(s){if(s!=null){if(!Number.isFinite(s))throw C("enum");s|=0}return s}function as(s){if(s!=null&&typeof s=="string"){if(!s)return;s=+s}}function cs(s){if(s!=null)e:{if(!fo(s))throw C("int64");switch(typeof s){case"string":s=ho(s);break e;case"bigint":var a=s=BigInt.asIntN(64,s);if(so(a)){if(!/^\s*(?:-?[1-9]\d*|0)?\s*$/.test(a))throw Error(String(a))}else if(il(a)&&!Number.isSafeInteger(a))throw Error(String(a));rr?s=BigInt(s):s=ol(s)?s?"1":"0":so(s)?s.trim()||"0":String(s);break e;default:s=lo(s)}}return s}function lo(s){if(s=Math.trunc(s),!Number.isSafeInteger(s)){ao(s);var a=He,l=Ge;(s=l&2147483648)&&(a=~a+1>>>0,l=~l>>>0,a==0&&(l=l+1>>>0));const y=l*4294967296+(a>>>0);a=Number.isSafeInteger(y)?y:is(a,l),s=typeof a=="number"?s?-a:a:s?"-"+a:a}return s}function ho(s){var a=Math.trunc(Number(s));if(Number.isSafeInteger(a))return String(a);if(a=s.indexOf("."),a!==-1&&(s=s.substring(0,a)),!(s[0]==="-"?s.length<20||s.length===20&&Number(s.substring(0,7))>-922337:s.length<19||s.length===19&&Number(s.substring(0,6))<922337)){if(s.length<16)ao(Number(s));else if(N())s=BigInt(s),He=Number(s&BigInt(4294967295))>>>0,Ge=Number(s>>BigInt(32)&BigInt(4294967295));else{a=+(s[0]==="-"),Ge=He=0;const l=s.length;for(let y=a,A=(l-a)%6+a;A<=l;y=A,A+=6){const j=Number(s.slice(y,A));Ge*=1e6,He=He*1e6+j,He>=4294967296&&(Ge+=Math.trunc(He/4294967296),Ge>>>=0,He>>>=0)}if(a){const[y,A]=os(He,Ge);He=y,Ge=A}}if(s=He,a=Ge,a&2147483648)if(N())s=""+(BigInt(a|0)<<BigInt(32)|BigInt(s>>>0));else{const[l,y]=os(s,a);s="-"+is(l,y)}else s=is(s,a)}return s}function Et(s){if(s!=null&&typeof s!="string")throw Error();return s}function go(s,a,l){if(s!=null&&typeof s=="object"&&s.H===ge)return s;if(Array.isArray(s)){var y=s[q]|0,A=y;return A===0&&(A|=l&32),A|=l&2,A!==y&&(s[q]=A),new a(s)}}function dl(s){Cn===void 0&&(Cn=typeof Proxy=="function"?po(Proxy):null);var a;return(a=!Cn)||(Tn===void 0&&(Tn=typeof WeakMap=="function"?po(WeakMap):null),a=!Tn),a?s:(a=_o(s))?a:Math.random()>.01?s:(_l(s),a=new Cn(s,{set(l,y,A){return hl(),l[y]=A,!0}}),gl(s,a),a)}function hl(){Q()}let sr,us;function _o(s){let a;return(a=sr)==null?void 0:a.get(s)}function gl(s,a){(sr||(sr=new Tn)).set(s,a),(us||(us=new Tn)).set(a,s)}let Cn,Tn;function po(s){try{return s.toString().indexOf("[native code]")!==-1?s:null}catch{return null}}let fs;function _l(s){if(fs===void 0){const a=new Cn([],{});fs=Array.prototype.concat.call([],a).length===1}fs&&typeof Symbol=="function"&&Symbol.isConcatSpreadable&&(s[Symbol.isConcatSpreadable]=!0)}function pl(s,a){return yo(a)}function yo(s){switch(typeof s){case"number":return isFinite(s)?s:String(s);case"bigint":return ss(s)?Number(s):String(s);case"boolean":return s?1:0;case"object":if(s)if(Array.isArray(s)){if(Dt(s))return}else{if(V(s))return J(s);if(s instanceof S){const a=s.g;return a==null?"":typeof a=="string"?a:s.g=J(a)}}}return s}function yl(s,a,l){s=w(s);var y=s.length;const A=a&256?s[y-1]:void 0;for(y+=A?-1:0,a=a&512?1:0;a<y;a++)s[a]=l(s[a]);if(A){a=s[a]={};for(const j in A)a[j]=l(A[j])}return s}function mo(s,a,l,y,A){if(s!=null){if(Array.isArray(s))s=Dt(s)?void 0:A&&(s[q]|0)&2?s:ls(s,a,l,y!==void 0,A);else if(jt(s)){const j={};for(let O in s)j[O]=mo(s[O],a,l,y,A);s=j}else s=a(s,y);return s}}function ls(s,a,l,y,A){const j=y||l?s[q]|0:0;y=y?!!(j&32):void 0,s=w(s);for(let O=0;O<s.length;O++)s[O]=mo(s[O],a,l,y,A);return l&&l(j,s),s}function ml(s){return s.H===ge?s.toJSON():yo(s)}function bo(s,a,l=de){if(s!=null){if(s instanceof Uint8Array)return a?s:new Uint8Array(s);if(Array.isArray(s)){var y=s[q]|0;return y&2?s:(a&&(a=y===0||!!(y&32)&&!(y&64||!(y&16))),a?(s[q]=(y|34)&-12293,s):ls(s,bo,y&4?de:l,!0,!0))}return s.H===ge&&(l=s.m,y=l[q],s=y&2?s:new s.constructor(ds(l,y,!0))),s}}function ds(s,a,l){const y=l||a&2?de:le,A=!!(a&32);return s=yl(s,a,j=>bo(j,A,y)),s[q]=s[q]|32|(l?2:0),s}function hs(s){const a=s.m,l=a[q];return l&2?new s.constructor(ds(a,l,!1)):s}function kt(s,a){return s=s.m,en(s,s[q],a)}function wo(s,a,l,y){if(a=y+(+!!(a&512)-1),!(a<0||a>=s.length||a>=l))return s[a]}function en(s,a,l,y){if(l===-1)return null;const A=a>>15&1023||536870912;if(l>=A){if(a&256)return s[s.length-1][l]}else{var j=s.length;if(y&&a&256&&(y=s[j-1][l],y!=null)){if(wo(s,a,A,l)&&ie!=null){var O;s=(O=U)!=null?O:U={},O=s[ie]||0,O>=4||(s[ie]=O+1,Q())}return y}return wo(s,a,A,l)}}function gs(s,a,l){const y=s.m;let A=y[q];return tr(A),Ne(y,A,a,l),s}function Ne(s,a,l,y){const A=a>>15&1023||536870912;if(l>=A){let j,O=a;if(a&256)j=s[s.length-1];else{if(y==null)return O;j=s[A+(+!!(a&512)-1)]={},O|=256}return j[l]=y,l<A&&(s[l+(+!!(a&512)-1)]=void 0),O!==a&&(s[q]=O),O}return s[l+(+!!(a&512)-1)]=y,a&256&&(s=s[s.length-1],l in s&&delete s[l]),a}function tn(s,a,l,y){return l=Ct(s,y)===l?l:-1,vo(s,a,l)!==void 0}function nn(s){return!!(2&s)&&!!(4&s)||!!(2048&s)}function Ie(s,a,l,y){const A=s.m;let j=A[q];return tr(j),Ne(A,j,a,(y==="0"?Number(l)===0:l===y)?void 0:l),s}function Ct(s,a){return s=s.m,ps(_s(s),s,s[q],a)}function _s(s){let a;return(a=s[ue])!=null?a:s[ue]=new Map}function ps(s,a,l,y){let A=s.get(y);if(A!=null)return A;A=0;for(let j=0;j<y.length;j++){const O=y[j];en(a,l,O)!=null&&(A!==0&&(l=Ne(a,l,A)),A=O)}return s.set(y,A),A}function vo(s,a,l,y){s=s.m;let A=s[q];return y=en(s,A,l,y),a=go(y,a,A),a!==y&&a!=null&&Ne(s,A,l,a),a}function ys(s,a,l){if(a=vo(s,a,l,!1),a==null)return a;s=s.m;let y=s[q];if(!(y&2)){const A=hs(a);A!==a&&(a=A,Ne(s,y,l,a))}return a}function rn(s,a,l){return l==null&&(l=void 0),gs(s,a,l)}function we(s,a,l,y){y==null&&(y=void 0);e:{const O=s.m;var A=O[q];if(tr(A),y==null){var j=_s(O);if(ps(j,O,A,l)===a)j.set(l,0);else break e}else{j=O;const re=_s(j),ne=ps(re,j,A,l);ne!==a&&(ne&&(A=Ne(j,A,ne)),re.set(l,a))}Ne(O,A,a,y)}return s}function So(s,a){const l=s.m;let y=l[q];if(tr(y),a==null)return Ne(l,y,1),s;var A=a,j;a=((j=us)==null?void 0:j.get(A))||A,j=A=a[q]|0;const O=nn(A),re=O||Object.isFrozen(a);let ne=!0,Re=!0;for(let ze=0;ze<a.length;ze++){var $e=a[ze];O||($e=!!(($e.m[q]|0)&2),ne&&(ne=!$e),Re&&(Re=$e))}return O||(A=ne?13:5,A=Re?A|16:A&-17),re&&A===j||(a=w(a),j=0,A=ir(A,y),A=ms(A,y,!0)),A!==j&&(a[q]=A),Ne(l,y,1,a),s}function ir(s,a){return s=(2&a?s|2:s&-3)|32,s&=-2049}function ms(s,a,l){return 32&a&&l||(s&=-33),s}function sn(s,a){return s??a}function xo(s){return s=kt(s,1),s!=null&&(typeof s=="bigint"?ss(s)?s=Number(s):(s=BigInt.asIntN(64,s),s=ss(s)?Number(s):String(s)):s=fo(s)?typeof s=="number"?lo(s):ho(s):void 0),sn(s,0)}function Je(s,a){return s=kt(s,a),sn(s==null||typeof s=="string"?s:void 0,"")}function Ut(s,a){return s=kt(s,a),s=s==null?s:Number.isFinite(s)?s|0:void 0,sn(s,0)}function Ee(s,a,l,y){return l=Ct(s,y)===l?l:-1,ys(s,a,l)}let on;function bs(s){try{return on=!0,JSON.stringify(ws(s),pl)}finally{on=!1}}function bl(){var s=ia||(ia=wl("[1,2,0]"));s=hs(s),s=gs(s,4,Et("dev-706864954"));const a=s.m,l=a[q];return l&2?s:new s.constructor(ds(a,l,!0))}var ae=class{constructor(s){e:{var a=a??0;if(s==null){var l=96;s=[]}else{if(!Array.isArray(s))throw Error("narr");if(l=s[q]|0,l&2048)throw Error("farr");if(l&64)break e;a===1||a===2||(l|=64),a=s;var y=a.length;if(y&&(--y,jt(a[y]))){if(l|=256,a=y-(+!!(l&512)-1),a>=1024)throw Error("pvtlmt");l=l&-33521665|(a&1023)<<15}}s[q]=l}this.m=s}toJSON(){return ws(this)}};ae.prototype.H=ge,ae.prototype.toString=function(){try{return on=!0,ws(this).toString()}finally{on=!1}};function ws(s){s=s.m,s=on?s:ls(s,ml,void 0,void 0,!1);{var a=!on;let Re=s.length;if(Re){var l=s[Re-1],y=jt(l);y?Re--:l=void 0;var A=s;if(y){e:{var j=l,O,re=!1;if(j){for(let $e in j)if(isNaN(+$e)){let ze;((ze=O)!=null?ze:O={})[$e]=j[$e]}else if(y=j[$e],Array.isArray(y)&&(Dt(y)||Ae(y)&&y.size===0)&&(y=null),y==null&&(re=!0),y!=null){let ze;((ze=O)!=null?ze:O={})[$e]=y}}if(re||(O=j),O)for(let $e in O){re=O;break e}re=null}j=re==null?l!=null:re!==l}for(;Re>0&&(O=A[Re-1],!!(O==null||Dt(O)||Ae(O)&&O.size===0));Re--)var ne=!0;(A!==s||j||ne)&&(a?(ne||j||re)&&(A.length=Re):A=Array.prototype.slice.call(A,0,Re),re&&A.push(re)),ne=A}else ne=s}return ne}function or(s){return a=>{if(a==null||a=="")a=new s;else{if(a=JSON.parse(a),!Array.isArray(a))throw Error("dnarr");a[q]|=32,a=new s(a)}return a}}var wl=function(s){return a=>{if(a=JSON.parse(a),!Array.isArray(a)){var l=typeof a;throw Error("Expected jspb data to be an array, got "+(l!="object"?l:a?Array.isArray(a)?"array":l:"null")+": "+a)}return a[q]|=34,new s(a)}}(class extends ae{}),Ao=class extends ae{};function vl(s){var a=new ko(500);let l=0,y;return(...A)=>{Io(a)?s(...A):(y=()=>void s(...A),l||(l=setTimeout(()=>{l=0;let j;(j=y)==null||j()},xl(a))))}}function Sl(s){var a=new ko(100),l=Promise.resolve();return(...y)=>Io(a)?s(...y):l}function Io(s){return Eo(s,s.index)>=s.g?(s.h[s.index]=Date.now(),s.index=(s.index+1)%1,!0):!1}function xl(s){const a=s.g;return s=Eo(s,s.index),s>=a?0:a-s}function Eo(s,a){let l;return Date.now()-((l=s.h[a])!=null?l:-1*s.g)}var ko=class{constructor(s){this.g=s,this.h=[],this.index=0}},Co=class extends ae{},Al=[2,3],Il=class extends ae{},me=class extends Error{constructor({errorType:s,message:a,i:l}){super(`Meet Add-on SDK error: ${`${a}${l?` - ${l}`:""}`}`),this.errorType=s}},Pt={errorType:"InternalError",message:"An unexpected error has occurred.",i:"No further information is available."},To={errorType:"MissingUrlParameter",message:"Missing required Meet SDK URL parameter",i:"This parameter is automatically appended by Meet to the iframe URL. Ensure that your infrastructure does not strip URL parameters (e.g. as part of a redirect)."},Oo={errorType:"NeedsMainStageContext",message:"This method can only be invoked if the addon is running in the main stage.",i:"Use getFrameType to check whether the addon is running in the main stage before invoking this method."},El={errorType:"NeedsSidePanelContext",message:"This method can only be invoked if the addon is running in the side panel.",i:"Use getFrameType to check whether the addon is running in the side panel before invoking this method."},kl={errorType:"NotSupportedInStandalone",message:"This method is not supported in standalone mode.",i:"Do not call this method in standalone mode."},Cl={errorType:"InternalError",message:"The frame type URL parameter is set to an unexpected value.",i:"This parameter is automatically appended by Meet to the iframe URL. Ensure that your infrastructure does not modify URL parameters (e.g. as part of a redirect)."},Tl={errorType:"InvalidCloudProjectNumber",message:"Cloud Project Number provided by meet does not match the one passed in by the SDK. Ensure that the correct Cloud Project Number is passed to the SDK as a string.",i:"This parameter is automatically appended by Meet to the iframe URL. Ensure that your infrastructure does not modify URL parameters (e.g. as part of a redirect) and ensure that the correct Cloud Project Number was passed into the SDK as a string."},Ol={errorType:"DestinationNotReady",message:"The recipient frame is not connected via the addon SDK and cannot receive the notification.",i:"Make sure the destination frame has connected before sending messages to it."},Rl={errorType:"InvalidActivityStartingState",message:"Origin of the ActivityStartingState iframeURLs does not match the origin of the URLs provided in the Add-on manifest.",i:"Ensure that the ActivityStartingState iframeURL origins match the origins of the URLs provided in the Add-on manifest."},Ml={errorType:"ActivityStartingStateMissingAttributes",message:"The supplied ActivityStartingState object does not contain any recognized attributes.",i:"Ensure that the ActivityStartingState object contains at least one of the following attributes: mainStageUrl, sidePanelUrl, additionalData."},jl={errorType:"ActivityStartingStateUnrecognizedAttributes",message:"The supplied ActivityStartingState object contains attributes that are not recognized.",i:"Ensure that the ActivityStartingState object has only the following attributes: mainStageUrl, sidePanelUrl, additionalData."},Dl={errorType:"AddonStartingStateMissingAttributes",message:"The supplied AddonStartingState object does not contain any recognized attributes.",i:"Ensure that the AddonStartingState object contains at least one of the following attributes: sidePanelUrl, additionalData."},Ul={errorType:"AddonStartingStateUnrecognizedAttributes",message:"The supplied AddonStartingState object contains attributes that are not recognized.",i:"Ensure that the AddonStartingState object has only the following attributes: sidePanelUrl, additionalData."},vs=s=>({errorType:"ArgumentNullError",message:`The argument supplied for '${s}' was 'null' but a value was expected.`,i:"Ensure you are passing a value of the expected type for the argument."}),_t=(s,a,l)=>({errorType:"ArgumentTypeError",message:`The type '${a}' of argument supplied for '${s}' did not match the expected type '${l}'.`,i:"Ensure the type of the argument provided matches the expected type."}),Ro=s=>({errorType:"InternalError",message:`Could not connect to ${s} channel. Unknown error`,i:"No further information is available."}),Pl={errorType:"ActivityIsOngoing",message:"Operation cannot be performed while an activity is ongoing.",i:"Ensure that no activity is ongoing."},Hl={errorType:"InternalError",message:"Frame message missing required Meet SDK command.",i:"Send one of the available commands in the frame message."},$l={errorType:"NoActivityFound",message:"No activity found.",i:"Ensure that the activity is started before performing this operation."},Bl={errorType:"RequiresEapEnrollment",message:"This feature is only available to early access partners.",i:"Meet add-on early access enrollment is currently closed."},Ll={errorType:"UserNotInitiator",message:"Operation cannot be performed because the user is not the initiator of the current activity.",i:"Ensure that the user is the initiator of the current activity or that the activity has ended."},Fl={errorType:"SizeLimitExceededActivityStartingState",message:"The size of the activityStartingState URLs and/or its data exceed the limits allowed.",i:"Ensure that the activityStartingState URL size is less than 512 characters and the additional data size is less than 4096 characters."},Nl={errorType:"SizeLimitExceededFrameToFrameMessage",message:"The size of the frame to frame message exceeds the limits allowed.",i:"Ensure that the frame to frame message size is less than 1,000,000 characters."},zl={errorType:"AddonSessionAlreadyCreated",message:"The addon session has already been created.",i:"Only instantiate the AddonSession once."},Vl={errorType:"UserCancelled",message:"The user cancelled starting an activity.",i:"The user needs to click continue to start the activity."},Wl={errorType:"NotSupportedInMeetCall",message:"This method is not supported during a Meet call.",i:"Do not call this method during a Meet call."},ql={errorType:"InvalidAddonStartingState",message:"Origin of the AddonStartingState iframeURLs does not match the origin of the URLs provided in the Add-on manifest.",i:"Ensure that the AddonStartingState iframeURL origins match the origins of the URLs provided in the Add-on manifest."},Gl={errorType:"SizeLimitExceededAddonStartingState",message:"The size of the AddonStartingState URLs and/or its data exceed the limits allowed.",i:"Ensure that the AddonStartingState URL size is less than 512 characters and the additional data size is less than 4096 characters."},Jl={errorType:"MeetingPolicyPreventsStartingActivity",message:"A meeting policy (such as using host control settings) prevents the user from starting the activity.",i:"Have a meeting host or administrator modify the necessary settings to allow the current user to start the activity."};function Kl(s){switch(s){case 0:return Pt;case 1:return Ol;case 2:return Rl;case 3:return Pl;case 4:return Hl;case 5:return Bl;case 6:return kl;case 7:return Ll;case 8:return Fl;case 9:return Nl;case 10:return Vl;case 11:return Wl;case 12:return ql;case 13:return Gl;case 14:return $l;case 15:return Jl;default:return Pt}}function Yl(s){let a;var l=(a=Ut(s,1))!=null?a:0;switch(s=Xl(Ct(s,Al)),l){case 1:return{errorType:"InternalError",message:`Could not connect to ${s} channel. Meet did not respond with a MessagePort.`,i:"No further information is available."};case 2:return{errorType:"InternalError",message:`Could not connect to ${s}. A conflicting ${s} exists.`,i:"No further information is available."};case 3:return{errorType:"InternalError",message:`Could not connect to ${s} channel. The addon does not have permission to open a ${s}.`,i:"This method might require EAP enrollment."};case 4:return{errorType:"InternalError",message:`Could not connect to ${s} channel. The addon is not authorized for this ${s}.`,i:"No further information is available."};case 0:return Ro(s);case 5:e:switch(s){case"co":l={errorType:"InternalError",message:`Could not connect to ${s} channel. The coActivity was not found.`,i:`Consider starting the ${s} only after after the startActivity promise returns.`};break e;default:l={errorType:"InternalError",message:`Could not connect to ${s} channel.`,i:"No further information is available."}}return l;default:return Ro(s)}}function Xl(s){switch(s){case 2:return"co";case 3:return"gd";case 0:return"unknown";default:return"unknown"}}function an({errorType:s,message:a,i:l},y=""){throw new me({errorType:s,message:y?`${a} ${y}`:a,i:l})}function ar(s,a){an({...To,message:`${To.message}: ${s}. In URL ${a}`})}function Ss(s){var a=new Mo;return Ie(a,1,It(s),0)}function xs(s,a){return Ie(s,2,Et(a),"")}function As(s,a){return Ie(s,3,Et(a),"")}var Mo=class extends ae{getFrameType(){return Ut(this,1)}};function jo(s){var a;sl===void 0?a=2:a=4;var l=s.m[q],y=l,A=!(2&l),j=Mo;s=s.m,a=(l=!!(2&y))?1:a,A&&(A=!l),l=en(s,y,1),l=Array.isArray(l)?l:no;var O=l[q]|0,re=!!(4&O);if(!re){var ne=O;ne===0&&(ne=ir(ne,y)),O=l,ne|=1;var Re=y;const hr=!!(2&ne);hr&&(Re|=2);let Vs=!hr,Ws=!0,gr=0,qs=0;for(;gr<O.length;gr++){const Gs=go(O[gr],j,Re);if(Gs instanceof j){if(!hr){const ya=!!((Gs.m[q]|0)&2);Vs&&(Vs=!ya),Ws&&(Ws=ya)}O[qs++]=Gs}}qs<gr&&(O.length=qs),ne|=4,ne=Ws?ne|16:ne&-17,ne=Vs?ne|8:ne&-9,O[q]=ne,hr&&Object.freeze(O),O=ne}if(A&&!(8&O||!l.length&&(a===1||a===4&&32&O))){for(nn(O)&&(l=w(l),O=ir(O,y),y=Ne(s,y,1,l)),A=l,j=O,O=0;O<A.length;O++)ne=A[O],Re=hs(ne),ne!==Re&&(A[O]=Re);j|=8,j=A.length?j&-17:j|16,O=A[q]=j}let $e;if(a===1||a===4&&32&O){if(!nn(O)){y=O;var ze=!!(32&O);O|=!l.length||16&O&&(!re||ze)?2:2048,O!==y&&(l[q]=O),Object.freeze(l)}}else re=a!==5?!1:!!(32&O)||nn(O)||!!_o(l),(a===2||re)&&nn(O)&&(l=w(l),O=ir(O,y),O=ms(O,y,!1),l[q]=O,y=Ne(s,y,1,l)),nn(O)||(s=O,O=ms(O,y,!1),O!==s&&(l[q]=O)),re?$e=dl(l):a===2&&((ze=sr)==null||ze.delete(l));return $e||l}function Do(s){var a=new Uo;return So(a,s)}var Uo=class extends ae{},Zl=class extends ae{};function Is(s){var a=new Ql;return Ie(a,1,It(s),0)}var Ql=class extends ae{},ed=class extends ae{},td=class extends ae{},nd=class extends ae{},rd=class extends ae{getMeetingInfo(){return Ee(this,nd,3,Es)}getMeetPlatformInfo(){return Ee(this,td,4,Es)}},Es=[2,3,4,5],cr=class extends ae{},cn=[1,4,5,6,7,8,9,10,11,12,13,14,15,16,17],sd=class extends ae{},id=class extends ae{},od=new Map([[2,"MAIN_STAGE"],[1,"SIDE_PANEL"]]),ad=new Map([[0,"UNKNOWN"],[1,"OPEN_ADDON"],[2,"START_ACTIVITY"],[3,"JOIN_ACTIVITY"]]);function cd(s){s&&typeof s.dispose=="function"&&s.dispose()}function Tt(){this.s=this.s,this.g=this.g}Tt.prototype.s=!1,Tt.prototype.dispose=function(){this.s||(this.s=!0,this.G())},Tt.prototype[Symbol.dispose]=function(){this.dispose()};function Po(s,a){s.s?a():(s.g||(s.g=[]),s.g.push(a))}Tt.prototype.G=function(){if(this.g)for(;this.g.length;)this.g.shift()()};function Ho({J:s,R:a}){if(s===null)throw new me(vs("activityStartingState"));if(a||s!==void 0){if(typeof s!="object")throw new me(_t("activityStartingState",typeof s,`object${a?"":" | undefined"}`));if(s.mainStageUrl!==void 0&&typeof s.mainStageUrl!="string")throw new me(_t("mainStageUrl",typeof s.mainStageUrl,"string | undefined"));if(s.sidePanelUrl!==void 0&&typeof s.sidePanelUrl!="string")throw new me(_t("sidePanelUrl",typeof s.sidePanelUrl,"string | undefined"));if(s.additionalData!==void 0&&typeof s.additionalData!="string")throw new me(_t("additionalData",typeof s.additionalData,"string | undefined"));if(Object.keys(s).length!==+!!s.mainStageUrl+ +!!s.sidePanelUrl+ +!!s.additionalData)throw new me(jl);if(Object.keys(s).length===0)throw new me(Ml)}}function $o(s){const a=[];return a.push(As(xs(Ss(2),s.mainStageUrl),s.additionalData)),a.push(As(xs(Ss(1),s.sidePanelUrl),s.additionalData)),a}var ks=class extends Tt{constructor(s){super(),this.context=s,this.h={},Rn(this.context.g.U,a=>{switch(Ct(a.content,cn)){case 7:const y=this.h.frameToFrameMessage;if(a=Ee(a.content,ed,7,cn),y&&a){var l=Ut(a,1);if(l=od.get(l),l===void 0)throw Error("Unknown frame type.");y({originator:l,payload:Je(a,2)})}}})}async getMeetingInfo(){const s=await Bs(this.context.g,Is(2));return{meetingId:Je(s.getMeetingInfo(),1),meetingCode:Je(s.getMeetingInfo(),2)}}async getFrameOpenReason(){let s;const a=(s=this.context.h.ca)!=null?s:0;let l;return(l=ad.get(a))!=null?l:"UNKNOWN"}async getActivityStartingState(){var s=Ee(await Bs(this.context.g,Is(1)),Uo,2,Es);const a=s==null?void 0:jo(s).find(l=>l.getFrameType()===2);return s=s==null?void 0:jo(s).find(l=>l.getFrameType()===1),{mainStageUrl:(a==null?void 0:Je(a,2))||void 0,sidePanelUrl:(s==null?void 0:Je(s,2))||void 0,additionalData:(s==null?void 0:Je(s,3))||void 0}}async setActivityStartingState(s){Ho({J:s,R:!0});var a=$o(s);s=Jd;var l=this.context.g,y=new sd;a=Do(a),y=rn(y,1,a),await s(l,y)}on(s,a){this.h[s]=a}async getMeetPlatformInfo(){const s=await Bs(this.context.g,Is(3));return{isMeetHardware:sn(uo(kt(s.getMeetPlatformInfo(),1)),!1)}}async closeAddon(){await Kd(this.context.g)}async startActivity(s){Ho({J:s,R:!1});const a=new id;s&&(s=$o(s),s=Do(s),rn(a,1,s)),await Yd(this.context.g,a)}async endActivity(s){var a=Xd,l=this.context.g,y=new Zl;s=Ie(y,1,It(s==="aab61ee0-51b4-475d-aa4d-849f2498640d"?999:0),0),await a(l,s)}},ud=or(class extends ae{getFrameOpenReason(){return Ut(this,5)}});function Cs(){var s=window.location.href,a=window.location.href,l=new URL(a).searchParams.get("meet_sdk");if(l?a=ud(atob(l)):(ar("meet_sdk",a),a=void 0),(l=Je(a,1))||ar("meet_addon_frame_type",s),l=Number(l),l!==2&&l!==1)throw new me(Cl);const y=Je(a,2);y||ar("meet_control_channel_name",s);const A=Je(a,4);A||ar("addon_cloud_project_number",s);var j;return s=(j=a.getFrameOpenReason())!=null?j:0,j=Je(a,3)||"https://meet.google.com",{ca:s,frameType:l,ba:y,cloudProjectNumber:A,S:j}}var fd=class extends ae{},ld=class extends ae{};function dd(){var s=new hd,a=new ld;return we(s,1,gd,a)}var hd=class extends ae{},gd=[1,2];function _d(s){var a=new yd;return rn(a,2,s)}function pd(s,a){return Ie(s,3,Et(a),"")}var yd=class extends ae{},md=class extends ae{},bd=class extends ae{},wd=class extends ae{},vd=class extends ae{},Sd=class extends ae{setAddonStartingState(s){return rn(this,1,s)}},xd=class extends ae{};function Ad(s,a){return we(s,2,Ye,a)}var Ke=class extends ae{},Ye=[1,2,5,6,7,8,9,10,11,13,14,15,16],Bo=class extends ae{},ur=or(Bo),un=[1,2];class Id{constructor(a,l){this.data=a,this.channel=l}}var Ed=Promise;function Lo(s){const a=new MessageChannel;return Fo(a.port1,s),a}function Ts(s,a){return Fo(s,a),new kd(s)}class kd{constructor(a){this.g=a}send(a,l,y=[]){l=Lo(l),this.g.postMessage(a,[l.port2].concat(y))}C(a,l){return new Ed(y=>{this.send(a,y,l)})}}function Fo(s,a){a&&(s.onmessage=l=>{var y=l.data;l=Ts(l.ports[0]),a(new Id(y,l))})}var Os=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?s=>s&&AsyncContext.Snapshot.wrap(s):s=>s;function No(s,a){s.l(a),s.h<100&&(s.h++,a.next=s.g,s.g=a)}class zo{constructor(a,l){this.j=a,this.l=l,this.h=0,this.g=null}get(){let a;return this.h>0?(this.h--,a=this.g,this.g=a.next,a.next=null):a=this.j(),a}}function Cd(){var s=Wo;let a=null;return s.g&&(a=s.g,s.g=s.g.next,s.g||(s.h=null),a.next=null),a}class Td{constructor(){this.h=this.g=null}add(a,l){const y=Vo.get();y.set(a,l),this.h?this.h.next=y:this.g=y,this.h=y}}var Vo=new zo(()=>new Od,s=>s.reset());class Od{constructor(){this.next=this.g=this.h=null}set(a,l){this.h=a,this.g=l,this.next=null}reset(){this.next=this.g=this.h=null}}let Rs,Ms=!1,Wo=new Td,js=(s,a)=>{Rs||Rd(),Ms||(Rs(),Ms=!0),Wo.add(s,a)},Rd=()=>{const s=Promise.resolve(void 0);Rs=()=>{s.then(Md)}};function Md(){let s;for(;s=Cd();){try{s.h.call(s.g)}catch(a){f(a)}No(Vo,s)}Ms=!1}function qo(){}function pt(s){if(this.g=0,this.T=void 0,this.l=this.h=this.j=null,this.v=this.B=!1,s!=qo)try{const a=this;s.call(void 0,function(l){fn(a,2,l)},function(l){fn(a,3,l)})}catch(a){fn(this,3,a)}}function Go(){this.next=this.context=this.h=this.l=this.g=null,this.j=!1}Go.prototype.reset=function(){this.context=this.h=this.l=this.g=null,this.j=!1};var Jo=new zo(function(){return new Go},function(s){s.reset()});function Ds(s,a,l){const y=Jo.get();return y.l=s,y.h=a,y.context=l,y}function jd(){let s,a;const l=new pt(function(y,A){s=y,a=A});return new Hd(l,s,a)}pt.prototype.then=function(s,a,l){return Dd(this,Os(typeof s=="function"?s:null),Os(typeof a=="function"?a:null),l)},pt.prototype.$goog_Thenable=!0;function Ko(s,a){a=Os(a),a=Ds(a,a),a.j=!0,Us(s,a)}pt.prototype.cancel=function(s){if(this.g==0){const a=new yt(s);js(function(){Yo(this,a)},this)}};function Yo(s,a){if(s.g==0)if(s.j){var l=s.j;if(l.h){var y=0,A=null,j=null;for(let O=l.h;O&&(O.j||(y++,O.g==s&&(A=O),!(A&&y>1)));O=O.next)A||(j=O);A&&(l.g==0&&y==1?Yo(l,a):(j?(y=j,y.next==l.l&&(l.l=y),y.next=y.next.next):Zo(l),Qo(l,A,3,a)))}s.j=null}else fn(s,3,a)}function Us(s,a){s.h||s.g!=2&&s.g!=3||Xo(s),s.l?s.l.next=a:s.h=a,s.l=a}function Dd(s,a,l,y){const A=Ds(null,null,null);return A.g=new pt(function(j,O){A.l=a?function(re){try{const ne=a.call(y,re);j(ne)}catch(ne){O(ne)}}:j,A.h=l?function(re){try{const ne=l.call(y,re);ne===void 0&&re instanceof yt?O(re):j(ne)}catch(ne){O(ne)}}:O}),A.g.j=s,Us(s,A),A.g}pt.prototype.ma=function(s){this.g=0,fn(this,2,s)},pt.prototype.na=function(s){this.g=0,fn(this,3,s)};function fn(s,a,l){if(s.g==0){s===l&&(a=3,l=new TypeError("Promise cannot resolve to itself")),s.g=1;e:{var y=l,A=s.ma,j=s.na;if(y instanceof pt){Us(y,Ds(A||qo,j||null,s));var O=!0}else{if(y)try{var re=!!y.$goog_Thenable}catch{re=!1}else re=!1;if(re)y.then(A,j,s),O=!0;else{if(re=typeof y,re=="object"&&y!=null||re=="function")try{const ne=y.then;if(typeof ne=="function"){Ud(y,ne,A,j,s),O=!0;break e}}catch(ne){j.call(s,ne),O=!0;break e}O=!1}}}O||(s.T=l,s.g=a,s.j=null,Xo(s),a!=3||l instanceof yt||Pd(s,l))}}function Ud(s,a,l,y,A){function j(ne){re||(re=!0,y.call(A,ne))}function O(ne){re||(re=!0,l.call(A,ne))}let re=!1;try{a.call(s,O,j)}catch(ne){j(ne)}}function Xo(s){s.B||(s.B=!0,js(s.la,s))}function Zo(s){let a=null;return s.h&&(a=s.h,s.h=a.next,a.next=null),s.h||(s.l=null),a}pt.prototype.la=function(){let s;for(;s=Zo(this);)Qo(this,s,this.g,this.T);this.B=!1};function Qo(s,a,l,y){if(l==3&&a.h&&!a.j)for(;s&&s.v;s=s.j)s.v=!1;if(a.g)a.g.j=null,ea(a,l,y);else try{a.j?a.l.call(a.context):ea(a,l,y)}catch(A){ta.call(null,A)}No(Jo,a)}function ea(s,a,l){a==2?s.l.call(s.context,l):s.h&&s.h.call(s.context,l)}function Pd(s,a){s.v=!0,js(function(){s.v&&ta.call(null,a)})}var ta=f;function yt(s){u.call(this,s)}c(yt,u),yt.prototype.name="cancel";function Hd(s,a,l){this.promise=s,this.resolve=a,this.reject=l}let $d=1,On=new WeakMap;function fr(s,a,l){var y=Bd;s.h.has(a),y(a,l)}var Ps=class extends Tt{constructor(){super(),this.h=new Set}signal(){const s=new Fd;return this.h.add(s),Po(this,o(cd,s)),s}};function Bd(s,a){return new Promise(l=>{ln(()=>{s.L&&(s.ea=a,s.P=!0);for(const{I:y,slot:A}of s.o.values())try{A(a,{signal:s,I:y})}catch(j){f(j)}for(const y of s.A)y.resolve(a);s.A.clear(),l()})})}function Rn(s,a,l){const y=$d++;return ln(()=>{Ld(s,y,a,l)}),y}function Ld(s,a,l,y){if(!s.s)if(y){if(!y.s){const A=()=>{ln(()=>{s.o.delete(a);const j=On.get(y);j&&z(j,A)})};s.o.set(a,{I:a,slot:l,F:A}),ra(y,A)}}else s.o.set(a,{I:a,slot:l,F:()=>s.o.delete(a)})}var Fd=class extends Tt{constructor(){super(),this.L=!1,this.o=new Map,this.A=new Set,this.P=!1}detach(s){ln(()=>{const a=this.o.get(s);a&&a.F()})}value(s){return this.promise(!0,s)}next(s){return this.promise(!1,s)}promise(s,a){const l=jd();return ln(()=>{if(this.s)l.reject(new yt("Signal initially disposed"));else if(a&&a.s)l.reject(new yt("Owner initially disposed"));else if(s&&this.L&&this.P)l.resolve(this.ea);else if(this.A.add(l),Ko(l.promise,()=>{this.A.delete(l)}),a){const y=()=>{l.reject(new yt("Owner asynchronously disposed"))};Ko(l.promise,()=>{const A=On.get(a);A&&z(A,y)}),ra(a,y)}}),l.promise}G(){super.G(),ln(()=>{for(const{F:s}of this.o.values())s();this.o.clear();for(const s of this.A)s.reject(new yt("Signal asynchronously disposed"));this.A.clear()})}};const Mn=[];let Hs=!1;function ln(s){Mn.push(s),Nd()}async function Nd(){if(!Hs)try{Hs=!0;let s=na(0);for(;s<Mn.length;)await Promise.resolve(),s=na(s)}catch(s){f(s)}finally{Mn.length=0,Hs=!1}}function na(s){const a=s+100;for(;s<a&&s<Mn.length;)try{Mn[s++]()}catch(l){f(l)}return s}function ra(s,a){if(s.s)a();else{var l=On.get(s);if(l)l.push(a);else{const y=[a];On.set(s,y),Po(s,()=>{for(const A of[...y])A();On.delete(s)})}}}function Xe(s){var a=new Bo;return s=we(a,1,un,s),{content:bs(s)}}const sa=new Ps;function zd(s,a){const l=sa.signal();return{channel:Ts(s,y=>{const A=a(y.data);fr(sa,l,{content:A,ka:y})}),signal:l}}let ia;var Ht=class extends ae{},$t=class extends ae{},$s=class extends ae{h(){return Ee(this,Ht,2,lr)}g(){return tn(this,Ht,2,lr)}j(){return Ee(this,$t,3,lr)}l(){return tn(this,$t,3,lr)}},lr=[2,3],Vd=or(class extends ae{}),Wd=or(class extends ae{}),dr=[1,2],qd=({destination:s,origin:a,ra:l,Y:y="ZNWN1d",onMessage:A})=>{if(a==="*")throw Error("Sending to wildcard origin not allowed.");const j=Lo(A);return s.postMessage(l?{n:y,t:l}:y,a,[j.port2]),Ts(j.port1,A)};function Gd(s,a,l){const y=new Ps,A=y.signal();return s=qd({destination:window.parent,origin:a,Y:s,onMessage:j=>{const O=ur(j.data.content);Ct(O,un)===2&&fr(y,A,{content:Ee(O,cr,2,un),ka:j,messagePort:j.data.messagePort})}}),new rh(A,s,l)}async function Bs(s,a){var l=st,y=new Ke;a=we(y,9,Ye,a),s=await l(s,Xe(a));let A;return(A=Ee(ur(s.data.content),cr,2,un))==null?void 0:Ee(A,rd,9,cn)}async function Jd(s,a){var l=st,y=new Ke;a=we(y,8,Ye,a),await l(s,Xe(a))}async function Kd(s){var a=st,l=new Ke,y=new fd;l=we(l,11,Ye,y),await a(s,Xe(l))}async function Yd(s,a){var l=st,y=new Ke;a=we(y,14,Ye,a),await l(s,Xe(a))}async function Xd(s,a){var l=st,y=new Ke;a=we(y,15,Ye,a),await l(s,Xe(a))}async function Zd(s){await s.h()}async function st(s,a){(s=await s.channel.C(a))||an(Pt,`Falsy response received from the message channel. ${JSON.stringify(s)}`),(a=s.data)||an(Pt,`Data field in the response from the message channel is falsy. ${JSON.stringify(a)}`),(a=a.content)||an(Pt,`Content field in the response from the message channel is falsy. ${JSON.stringify(a)}`);let l;try{l=ur(a)}catch(y){an(Pt,`The ControlMessage can't be deserialized. ${JSON.stringify(a)}. ${JSON.stringify(y)}`)}if((a=Ee(l,cr,2,un))||an(Pt,`MeetToAddonMessage field on ControlMessage is falsy. ${JSON.stringify(a)}`),a=a==null?void 0:Ee(a,Il,10,cn),(a==null?void 0:Ut(a,1))!==void 0)throw new me(Kl(Ut(a,1)));return s}async function Qd(s,a,l){var y=st,A=new Ke;a=we(A,1,Ye,a),y=await y(s,Xe(a)),s=y.data.messagePort;var j;return(y=(j=Ee(ur(y.data.content),cr,2,un))==null?void 0:Ee(j,Co,1,cn))!=null?j=y:(j=new Co,j=Ie(j,1,It(0),0)),{channel:s?zd(s,l):void 0,response:j}}async function oa(s){const a=dd(),{channel:l,response:y}=await Qd(s,a,A=>Wd(A));if(!l)throw new me(Yl(y));return l}async function eh(s){var a=st,l=new Ke,y=new xd;l=we(l,5,Ye,y),await a(s,Xe(l))}async function th(s){var a=st,l=new Ke,y=new md;l=we(l,6,Ye,y),await a(s,Xe(l))}async function aa(s,a,l){var y=st,A=new Ke,j=new bd;a=Ie(j,1,It(a),0),l=Ie(a,2,Et(l),""),A=we(A,7,Ye,l),await y(s,Xe(A))}async function nh(s,a){var l=st,y=new Ke;a=we(y,16,Ye,a),await l(s,Xe(a))}class rh extends Tt{constructor(a,l,y){super(),this.U=a,this.channel=l,this.h=Sl(async()=>{var A=this.channel,j=A.C,O=new Ke,re=new wd;O=we(O,13,Ye,re),await j.call(A,Xe(O))}),a=bl(),Je(a,4),as(kt(a,1)),as(kt(a,2)),as(kt(a,3)),y=Ad(new Ke,pd(_d(a),y)),this.channel.send(Xe(y)),Rn(this.U,async A=>{switch(Ct(A.content,cn)){case 16:await Zd(this)}})}}let Ls;var sh=class{constructor(s){var a=Ls;this.h=s,this.g=a}delete(){throw Error("Not implemented.")}},ih=class extends ae{h(){return Ee(this,Ht,2,dn)}g(){return tn(this,Ht,2,dn)}j(){return Ee(this,$t,3,dn)}l(){return tn(this,$t,3,dn)}},dn=[2,3],oh=class extends ae{},ah=class extends ae{},ch=class extends ae{},uh=class extends ae{h(){return Ee(this,Ht,2,hn)}g(){return tn(this,Ht,2,hn)}j(){return Ee(this,$t,3,hn)}l(){return tn(this,$t,3,hn)}},hn=[2,3],ca=[5,6],fh=class extends ae{},Fs=class extends ae{},Ns=[1,2,3],lh=class extends Error{constructor(){super("Failed to create CoActivity: Connection refused - Meet refused to begin Live Sharing")}},dh=class{constructor(s){this.config=s}start(){return this.g!=null||(this.g=setInterval(()=>{this.config.ha()},this.config.da)),this}shutdown(){clearInterval(this.g)}};function zs(){const s=new Map,a={set(l,y){return s.set(l,y),a},D:()=>s};return a}function hh(s){if(s.g()){s=s.h().m;var a=s[q],l=en(s,a,1),y=er(l,!0);if(y!=null&&y!==l&&Ne(s,a,1,y),s=y,a=s??se(),s=Uint8Array,P(K),l=a.g,l!=null&&!V(l))if(typeof l=="string"){te.test(l)&&(l=l.replace(te,F)),l=atob(l),y=new Uint8Array(l.length);for(let A=0;A<l.length;A++)y[A]=l.charCodeAt(A);l=y}else l=null;return a=l==null?l:a.g=l,{bytes:new s(a||0)}}}function gh(s,a){return a=ua(a),we(s,2,hn,a),s}function _h(s,a){return a=ua(a),we(s,2,dn,a),s}function ua(s){var a=new Ht;return Ie(a,1,er(s.bytes,!1),se())}function ph(s){if(s.l()){s=s.j();var a,l,y=Je(s,1),A=(l=(a=ys(s,Ao,2))==null?void 0:xo(a))!=null?l:0;l=s.m;let j=l[q];const O=en(l,j,4);return a=O==null||typeof O=="number"?O:O==="NaN"||O==="Infinity"||O==="-Infinity"?Number(O):void 0,a!=null&&a!==O&&Ne(l,j,4,a),{mediaId:y,mediaPlayoutPosition:A,mediaPlayoutRate:sn(a,0),playbackState:bh.get(Ut(s,3))}}}function yh(s,a){return a=fa(a),we(s,3,hn,a),s}function mh(s,a){return a=fa(a),we(s,3,dn,a),s}const bh=zs().set(0,"INVALID").set(1,"BUFFERING").set(2,"PLAY").set(3,"PAUSE").set(4,"ENDED").D(),wh=zs().set("INVALID",0).set("BUFFERING",1).set("PLAY",2).set("PAUSE",3).set("ENDED",4).D();function fa(s){var a=new $t;a=Ie(a,1,Et(s.mediaId),"");var l=s.mediaPlayoutRate;if(l!=null&&typeof l!="number")throw Error(`Value of float/double field must be a number, found ${typeof l}: ${l}`);return a=Ie(a,4,l,0),l=new Ao,l=Ie(l,1,cs(s.mediaPlayoutPosition),"0"),a=rn(a,2,l),s=wh.get(s.playbackState),Ie(a,3,It(s),0)}function vh({activityTitle:s}){var a=new ch;return gs(a,4,Et(s))}function Sh(s,a){var l=new ah;return a=Ie(l,1,It(a.u),0),we(s,6,ca,a),s}function xh(s){var a=new oh;return we(s,5,ca,a),s}const Ah=zs().set("co-doing",1).set("co-watching",2).D();async function la(s,a,l){var y=a.C,A=new Fs,j=new fh;j=Ie(j,1,Et(s.activityTitle),"");var O=Ah.get(s.K);j=Ie(j,2,It(O),0),A=we(A,3,Ns,j),y=await y.call(a,A,Vd);let re;if((re=sn(uo(kt(y,1)),!1))!=null&&re)return new Ih(s,a,l,ys(y,$s,2));throw new lh}function da(s,a){const l=s.config.N(a);l&&!s.config.M(s.g,l)&&(s.g=l,s.j=xo(a),s.v(s.g))}function Bt(s,a){const{state:l,fa:y,context:A}=a(s.g);s.g=l,s.notify(s.g,A,y)}class Ih{constructor(a,l,y,A){this.l=a,this.h=l,this.config=y,this.v=vl(j=>void this.l.O(j)),Oh(this.h,j=>{const O=Ct(j,dr);switch(O){case 1:da(this,Ee(j,$s,1,dr));break;case 2:case 0:console.warn(`IllegalMessage: ${O} - Unhandled message - Please raise a bug with the MeetJS team`)}}),this.B=new dh({da:1e3,ha:()=>{var j,O,re=(O=(j=this.l).ja)==null?void 0:O.call(j);if(this.g!==null){this.g={...this.g,...re},j=new Fs,O=this.config,re=O.W;var ne=new ih;ne=Ie(ne,1,cs(this.j),"0"),O=re.call(O,ne,this.g),j=we(j,1,Ns,O),this.h.send(j)}}}).start(),this.g=null,this.j=0,A&&da(this,A)}disconnect(){this.h.shutdown(),this.B.shutdown()}notify(a,l,y){var A=y?vh(y):void 0;y=this.config;var j=y.X,O=new uh;O=Ie(O,1,cs(this.j),"0"),A=rn(O,4,A),a=j.call(y,A,a),a=this.config.V(a,l),l=this.h,y=l.send,j=new Fs,a=we(j,2,Ns,a),y.call(l,a)}}var Eh=class{constructor(s){this.g=s}broadcastStateUpdate(s){Bt(this.g,()=>({state:s,context:{}}))}disconnect(){this.g.disconnect()}};function kh(s,a){return s==null||a==null?!1:s.bytes.length===a.bytes.length&&s.bytes.every((l,y)=>l===a.bytes[y])}var Ch=class{constructor(s){this.g=s}notifySwitchedToMedia(s,a,l){Bt(this.g,()=>({state:{mediaId:a,mediaPlayoutRate:1,mediaPlayoutPosition:l,playbackState:"PLAY"},fa:{activityTitle:s},context:{u:1}}))}notifyPauseState(s,a){Bt(this.g,l=>{if(l==null)throw Error("Invalid before coWatchingState");return{state:{...l,playbackState:s?"PAUSE":"PLAY",mediaPlayoutPosition:a},context:{u:3}}})}notifySeekToTimestamp(s){Bt(this.g,a=>{if(a==null)throw Error("Invalid before coWatchingState");return{state:{...a,mediaPlayoutPosition:s},context:{u:2}}})}notifyPlayoutRate(s){Bt(this.g,a=>{if(a==null)throw Error("Invalid before coWatchingState");return{state:{...a,mediaPlayoutRate:s},context:{u:4}}})}notifyBuffering(s){Bt(this.g,a=>{if(a==null)throw Error("Invalid before coWatchingState");return{state:{...a,mediaPlayoutPosition:s,playbackState:"BUFFERING"},context:{u:3}}})}notifyReady(s){Bt(this.g,a=>{if(a==null)throw Error("Invalid before coWatchingState");return{state:{...a,mediaPlayoutPosition:s},context:{u:3}}})}disconnect(){this.g.disconnect()}};function Th(s,a){if(s==null||a==null)return!1;const l=s.playbackState==="PLAY"?3*Math.max(s.mediaPlayoutRate,1):0,y=Math.abs(s.mediaPlayoutPosition-a.mediaPlayoutPosition);return s.mediaId===a.mediaId&&s.mediaPlayoutRate===a.mediaPlayoutRate&&y<=l&&s.playbackState===a.playbackState}function Oh(s,a){const l=Rn(s.signal,y=>{a(y)});s.o.push(l)}var ha=class{constructor(s,a){this.channel=s,this.signal=a,this.o=[]}send(s){this.channel.send(bs(s))}async C(s,a){return s=await this.channel.C(bs(s)),a(s.data)}shutdown(){this.o.forEach(s=>{this.signal.detach(s)})}};function Rh(s,a){var l=Uh;const y=s.signal(),A=s.signal();return Rn(a,j=>{const O=l(j)?y:A;fr(s,O,j)},s),{ia:y,ga:A}}function Mh(s,a,l,y=A=>A){Rn(l,A=>{fr(s,a,y(A))},s)}async function jh(s,a){if(a)return s=await la({activityTitle:a.activityTitle,K:"co-watching",ja:()=>a.onCoWatchingStateQuery(),O:l=>{a.onCoWatchingStateChanged(l)}},s,{X:yh,W:mh,V:Sh,N:ph,M:Th}),new Ch(s)}async function Dh(s,a){if(a)return s=await la({activityTitle:a.activityTitle,K:"co-doing",O:l=>{a.onCoDoingStateChanged(l)}},s,{X:gh,W:_h,V:xh,N:hh,M:kh}),new Eh(s)}async function ga(s){const a=new Ps,l=a.signal();s=await s,Mh(a,l,s.signal,j=>j.content);const{ia:y,ga:A}=Rh(a,l);return{Z:new ha(s.channel,y),aa:new ha(s.channel,A)}}function Uh(s){e:switch(Ct(s,dr)){case 1:s=Ee(s,$s,1,dr);break e;default:throw Error("CA Message arrived with no known content message set")}return s.g()}async function Ph(s,a){if({Z:s}=await ga(oa(s.g)),a=await Dh(s,a),!a)throw Error("Failed to create co-doing session");return a}async function Hh(s,a){if({aa:s}=await ga(oa(s.g)),a=await jh(s,a),!a)throw Error("Failed to create co-watching session");return a}var $h=class extends ks{async notifySidePanel(s){await aa(this.context.g,1,s)}async unloadSidePanel(){await eh(this.context.g)}async loadSidePanel(){await th(this.context.g)}},Bh=class extends ks{async setAddonStartingState(s){if(s===null)throw new me(vs("addonStartingState"));if(typeof s!="object")throw new me(_t("addonStartingState",typeof s,"object | undefined"));if(s.sidePanelUrl!==void 0&&typeof s.sidePanelUrl!="string")throw new me(_t("sidePanelUrl",typeof s.sidePanelUrl,"string | undefined"));if(s.additionalData!==void 0&&typeof s.additionalData!="string")throw new me(_t("additionalData",typeof s.additionalData,"string | undefined"));if(Object.keys(s).length!==+!!s.sidePanelUrl+ +!!s.additionalData)throw new me(Ul);if(Object.keys(s).length===0)throw new me(Dl);var a=[];a.push(As(xs(Ss(1),s.sidePanelUrl),s.additionalData)),s=this.context.g;var l=new Sd,y=l.setAddonStartingState,A=new vd;a=So(A,a),await nh(s,y.call(l,a))}},Lh=class extends ks{async notifyMainStage(s){await aa(this.context.g,2,s)}},Fh=class{constructor(s){s=s.cloudProjectNumber;const a=Cs();if(a.cloudProjectNumber!==s)throw new me(Tl);const l=a.S,y=a.ba;let A;Ls=(A=Ls)!=null?A:Gd(y,l,s),this.g=new sh(a)}async createMainStageClient(){var s=this.g;if(s.h.frameType!==2)throw new me(Oo);return await Promise.resolve(new $h(s))}async createSidePanelClient(){var s=this.g;if(s.h.frameType!==1)throw new me(El);return await Promise.resolve(new Lh(s))}async createCoWatchingClient(s){return await Hh(this.g,s)}async createCoDoingClient(s){return await Ph(this.g,s)}async createRoomsStandaloneClient(){var s=this.g;if(s.h.frameType!==2)throw new me(Oo);return await Promise.resolve(new Bh(s))}};let _a=null;var pa={addon:{getFrameType:function(){e:{var s=Cs().frameType;switch(s){case 2:s="MAIN_STAGE";break e;case 1:s="SIDE_PANEL";break e;default:throw Error(`Unknown frame type: ${s}`)}}return s},createAddonSession:async function(s){if(s===null)throw new me(vs("config"));if(typeof s!="object")throw new me(_t("config",typeof s,"object"));if(typeof s.cloudProjectNumber!="string")throw new me(_t("cloudProjectNumber",typeof s.cloudProjectNumber,"string"));if(_a&&Cs().S!=="integration.test.google.com")throw new me(zl);return _a=new Fh(s)}}},jn=["meet"],it=i;jn[0]in it||typeof it.execScript>"u"||it.execScript("var "+jn[0]);for(var Lt;jn.length&&(Lt=jn.shift());)jn.length||pa===void 0?it[Lt]&&it[Lt]!==Object.prototype[Lt]?it=it[Lt]:it=it[Lt]={}:it[Lt]=pa}).apply(rl);const $m=rl.meet,Bm="CLOUD_PROJECT_NUMBER",Lm="MAIN_STAGE_URL";async function Fm(){const e=await(await $m.addon.createAddonSession({cloudProjectNumber:Bm})).createSidePanelClient();let n=await e.getActivityStartingState();const r=new l0({storage:new Hm("parking-lot"),network:[new Em,new Um("wss://sync.automerge.org")]});let i;n?i=await r.find(n):(i=r.create(),n=i.url),i.change(f=>f.list=[]),i.on("change",({doc:f})=>{console.log("on change",f),c(f)}),console.log(i.url);const[o,c]=bc(i.doc());e.startActivity({sidePanelUrl:Lm,additionalData:n});function u(f){i.change(d=>{d.list.push(f)})}return[o,u]}const Nm="_App_9g4xh_1",zm={App:Nm};var Vm=Cc("<div><ol></ol><button>Add"),Wm=Cc("<li>");const qm=async()=>{const[t,e]=await Fm(),n=()=>t().list;return console.log("render",n()),(()=>{var r=Vm(),i=r.firstChild,o=i.nextSibling;return _i(i,kc(eg,{get each(){return n()},children:c=>(()=>{var u=Wm();return _i(u,c),u})()})),o.$$click=()=>e("test"),Mr(()=>sg(r,zm.App)),r})()};rg(["click"]);const Gm=document.getElementById("root");ng(()=>kc(qm,{}),Gm);
